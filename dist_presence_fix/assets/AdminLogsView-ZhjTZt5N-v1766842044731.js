import{r as e,o as a,h as o,l as t,y as s,I as r,L as n,G as l,F as i,i as c,k as d,t as m}from"./vendor-mW7CftnD-v1766842044731.js";import{b as u}from"./index-B47n4XC8-v1766842044731.js";import"./utils-D_mSMGs1-v1766842044731.js";import"./maps-CCq-KL9W-v1766842044731.js";const p={class:"min-h-screen bg-gray-100"},g={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},v={class:"bg-white rounded-lg shadow p-6"},h={class:"mb-4 flex items-center justify-between"},x={class:"flex space-x-2"},b={class:"border border-gray-300 rounded-lg p-4 bg-gray-900 text-green-400 font-mono text-sm max-h-96 overflow-y-auto"},f={key:0,class:"text-gray-500 text-center py-12"},w={key:1},y={__name:"AdminLogsView",setup(y){const k=s(),j=e([]),T=e("all"),C=()=>localStorage.getItem("adminToken"),I=()=>k.push("/"),S=()=>k.push("/admin/dashboard"),$=async()=>{try{const e=C();if(!e)return alert("–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞."),void k.push("/admin/login");const a="all"===T.value?"app":T.value,o=await fetch(`/api/v1/admin/logs/${a}`,{headers:{Authorization:`Bearer ${e}`}});if(!o.ok){if(401===o.status)return localStorage.removeItem("adminToken"),localStorage.removeItem("admin"),void k.push("/admin/login");const e=await o.json().catch(()=>({}));throw new Error(e.error||e.message||`HTTP ${o.status}`)}const t=await o.json();if(!t.success)throw new Error(t.error||t.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤");j.value=t.logs||[]}catch(e){u.error("Load logs error:",e),alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤: "+(e.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}},E=async()=>{if(confirm("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å."))try{const e=C();if(!e)return alert("–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞."),void k.push("/admin/login");const a=await fetch("/api/v1/admin/logs/cleanup",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok){if(401===a.status)return localStorage.removeItem("adminToken"),localStorage.removeItem("admin"),void k.push("/admin/login");const e=await a.json().catch(()=>({}));throw new Error(e.error||e.message||`HTTP ${a.status}`)}const o=await a.json();if(!o.success)throw new Error(o.error||o.message||"–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏");alert("‚úÖ –õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã"),await $()}catch(e){u.error("Cleanup logs error:",e),alert("–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤: "+(e.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}};return a(()=>{$()}),(e,a)=>(d(),o("div",p,[t("nav",{class:"bg-white shadow-lg"},[t("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[t("div",{class:"flex justify-between h-16"},[t("div",{class:"flex items-center space-x-4"},[t("button",{class:"text-gray-600 hover:text-gray-800 font-medium",onClick:I}," üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é "),t("button",{class:"text-blue-600 hover:text-blue-800 font-medium",onClick:S}," ‚Üê –î–∞—à–±–æ—Ä–¥ "),a[1]||(a[1]=t("h1",{class:"text-xl font-bold text-gray-900"}," üìã –õ–æ–≥–∏ –°–∏—Å—Ç–µ–º—ã ",-1))])])])]),t("div",g,[t("div",v,[t("div",h,[a[3]||(a[3]=t("h2",{class:"text-xl font-bold"}," üìã –õ–æ–≥–∏ ",-1)),t("div",x,[r(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),class:"px-3 py-2 border border-gray-300 rounded-md"},[...a[2]||(a[2]=[l('<option value="all"> –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ </option><option value="app"> –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ </option><option value="error"> –û—à–∏–±–∫–∏ </option><option value="access"> –î–æ—Å—Ç—É–ø </option><option value="admin"> –ê–¥–º–∏–Ω </option>',5)])],512),[[n,T.value]]),t("button",{class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:$}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å "),t("button",{class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",onClick:E}," üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å ")])]),t("div",b,[0===j.value.length?(d(),o("div",f," –õ–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ")):(d(),o("div",w,[(d(!0),o(i,null,c(j.value,(e,a)=>(d(),o("div",{key:a,class:"mb-1"},m(e),1))),128))]))])])])]))}};export{y as default};
