const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-DfMcr8gw-v1766842044731.js","assets/vendor-mW7CftnD-v1766842044731.js","assets/OpenStreetMapWidget-Cyf0y0My-v1766842044731.js","assets/maps-CCq-KL9W-v1766842044731.js","assets/OpenStreetMapWidget-BVqptb0b.css","assets/useRequestHelpers-BMWunBiJ-v1766842044731.js","assets/utils-D_mSMGs1-v1766842044731.js","assets/HomeView-DmA5Ek7h.css","assets/GlobalChatView-DBko2dUT-v1766842044731.js","assets/NavigationHeader-CLVJS0Hp-v1766842044731.js","assets/NavigationHeader-G8NeIQ5O.css","assets/PremiumBadge-D73oRhRn-v1766842044731.js","assets/PremiumBadge-B3ivQDYr.css","assets/LinkPreview-CwdBsWOq-v1766842044731.js","assets/LinkPreview-C-X2nV95.css","assets/GlobalChatView-C0JZO_kZ.css","assets/TestView-DSwXPiox-v1766842044731.js","assets/SystemDiagnostics-D6ftuT94-v1766842044731.js","assets/index-BvFAUrHA-v1766842044731.js","assets/AdminLogin-Bg1pj5LS-v1766842044731.js","assets/AdminDashboard-_ncy1Euy-v1766842044731.js","assets/SuperAdminPanel-D44e9Q8O-v1766842044731.js","assets/ErrorLogView-DJEb8OV2-v1766842044731.js","assets/BackupView-D0KyQ6tC-v1766842044731.js","assets/AdminLogsView-ZhjTZt5N-v1766842044731.js","assets/AdminAnalyticsView-BMGosBOr-v1766842044731.js","assets/AdminUsersView-Bg3GObqt-v1766842044731.js","assets/LoginView-D82m9kOj-v1766842044731.js","assets/night-road-BdXYRt4G-v1766842044731.js","assets/RegisterView-Bpn64R1i-v1766842044731.js","assets/ForgotPasswordView-CMUo9X9G-v1766842044731.js","assets/ResetPasswordView-CrLKiDbQ-v1766842044731.js","assets/EmailVerifiedView-Dc8EHQBF-v1766842044731.js","assets/MapView-B60KvkrJ-v1766842044731.js","assets/MapView-D1-kBwWf.css","assets/DashboardView-Cm2YotoY-v1766842044731.js","assets/CreateRequestView-Bwx43bKa-v1766842044731.js","assets/CreateRequestView-DueoniOX.css","assets/MyRequestsView-B_CNaUJI-v1766842044731.js","assets/MyHelpersView-SIkl2ztk-v1766842044731.js","assets/MyResponsesView-CeS9zNgc-v1766842044731.js","assets/MyChatsView-O8EYKPgt-v1766842044731.js","assets/MyChatsView-Ujv9YMGm.css","assets/ResponsesView-DOnno6Lr-v1766842044731.js","assets/UnifiedChatView-CShTf4a9-v1766842044731.js","assets/UnifiedChatView-BKD39i2_.css","assets/ProfileView-xBtuHVGz-v1766842044731.js","assets/ProfileView-D6_DkjLF.css","assets/FriendsView-DcUOCFZ8-v1766842044731.js","assets/CityChatsView-DiP7p-gN-v1766842044731.js","assets/CityChatsView-DBAOgAjY.css","assets/PublicProfileView-BUUNAVfk-v1766842044731.js","assets/MessagesView-Df-rtwB7-v1766842044731.js","assets/FavoritesView-Bz_Ykq61-v1766842044731.js","assets/NotificationsView-CyVKRcWd-v1766842044731.js","assets/AdminTerminal-DoXOn3HW-v1766842044731.js","assets/AdminRequestsView-6hwKgPey-v1766842044731.js","assets/AdminSettingsView-C_NBXNFl-v1766842044731.js","assets/AdminBulkOperations-DCJWbaq7-v1766842044731.js","assets/AdminChatModeration-BMtyuOF9-v1766842044731.js","assets/AdminFinance-CvXCvnTL-v1766842044731.js","assets/AdminNotifications-CuunyNBv-v1766842044731.js","assets/AdminRoles-C7GaBMfZ-v1766842044731.js"])))=>i.map(i=>d[i]);
import{r as e,c as t,o as n,a as r,w as s,d as o,b as i,e as a,f as c,g as l,h as u,i as d,u as h,F as p,T as f,j as g,k as m,n as v,l as y,m as w,t as b,p as _,q as k,s as E,v as T,x as S,y as C,z as I,A,B as x,C as R,D as O,E as D}from"./vendor-mW7CftnD-v1766842044731.js";import{a as P}from"./utils-D_mSMGs1-v1766842044731.js";import{g as N}from"./maps-CCq-KL9W-v1766842044731.js";function L(){const o=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",i=e((()=>{const e=localStorage.getItem("themeMode");return e&&["light","dark","system"].includes(e)?e:"system"})()),a=t(()=>"system"===i.value?"dark"===o():"dark"===i.value),c=()=>{a.value?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},l=e=>{["light","dark","system"].includes(e)?(i.value=e,localStorage.setItem("themeMode",e),c()):console.warn("Invalid theme mode:",e)};let u=null,d=null;const h=()=>{window.matchMedia&&(u=window.matchMedia("(prefers-color-scheme: dark)"),d=e=>{"system"===i.value&&c()},u.addEventListener("change",d))};return n(()=>{c(),h()}),r(()=>{u&&d&&u.removeEventListener("change",d)}),s(i,()=>{c(),u&&d&&u.removeEventListener("change",d),h()}),s(a,()=>{c()},{immediate:!0}),{isDark:a,themeMode:i,toggleDarkMode:()=>{"system"===i.value?l("dark"===o()?"light":"dark"):l("dark"===i.value?"light":"dark")},setThemeMode:l,cycleTheme:()=>{const e=["light","dark","system"],t=(e.indexOf(i.value)+1)%e.length;l(e[t])},getSystemTheme:o}}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const M={},j=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in M)return;M[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,n&&s.setAttribute("nonce",n),document.head.appendChild(s),t?new Promise((t,n)=>{s.addEventListener("load",t),s.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},q=new Set(["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED","HOSTNAME_MISMATCH"]);const B=N(e=>!q.has(e&&e.code)),F="axios-retry";function V(e){return!e.response&&(!!e.code&&(!["ERR_CANCELED","ECONNABORTED"].includes(e.code)&&B(e)))}const $=["get","head","options"],U=$.concat(["put","delete"]);function W(e){return"ECONNABORTED"!==e.code&&(!e.response||429===e.response.status||e.response.status>=500&&e.response.status<=599)}function H(e){var t;return!!(null==(t=e.config)?void 0:t.method)&&(W(e)&&-1!==U.indexOf(e.config.method))}function z(e){return V(e)||H(e)}function K(e=void 0){var t;const n=null==(t=null==e?void 0:e.response)?void 0:t.headers["retry-after"];if(!n)return 0;let r=1e3*(Number(n)||0);return 0===r&&(r=(new Date(n).valueOf()||0)-Date.now()),Math.max(0,r)}const G={retries:3,retryCondition:z,retryDelay:function(e=0,t=void 0){return Math.max(0,K(t))},shouldResetTimeout:!1,onRetry:()=>{},onMaxRetryTimesExceeded:()=>{},validateResponse:null};function J(e,t,n=!1){const r=function(e,t){return{...G,...t,...e[F]}}(e,t||{});return r.retryCount=r.retryCount||0,r.lastRequestTime&&!n||(r.lastRequestTime=Date.now()),e[F]=r,r}const Y=(e,t)=>{const n=e.interceptors.request.use(e=>{var n;return J(e,t,!0),(null==(n=e[F])?void 0:n.validateResponse)&&(e.validateStatus=()=>!1),e}),r=e.interceptors.response.use(null,async n=>{var r;const{config:s}=n;if(!s)return Promise.reject(n);const o=J(s,t);return n.response&&(null==(r=o.validateResponse)?void 0:r.call(o,n.response))?n.response:await async function(e,t){const{retries:n,retryCondition:r}=e,s=(e.retryCount||0)<n&&r(t);if("object"==typeof s)try{return!1!==await s}catch(o){return!1}return s}(o,n)?async function(e,t,n,r){var s;t.retryCount+=1;const{retryDelay:o,shouldResetTimeout:i,onRetry:a}=t,c=o(t.retryCount,n);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,r),!i&&r.timeout&&t.lastRequestTime){const e=Date.now()-t.lastRequestTime,s=r.timeout-e-c;if(s<=0)return Promise.reject(n);r.timeout=s}return r.transformRequest=[e=>e],await a(t.retryCount,n,r),(null==(s=r.signal)?void 0:s.aborted)?Promise.resolve(e(r)):new Promise(t=>{var n;const s=()=>{clearTimeout(o),t(e(r))},o=setTimeout(()=>{var n;t(e(r)),(null==(n=r.signal)?void 0:n.removeEventListener)&&r.signal.removeEventListener("abort",s)},c);(null==(n=r.signal)?void 0:n.addEventListener)&&r.signal.addEventListener("abort",s,{once:!0})})}(e,o,n,s):(await async function(e,t){e.retryCount>=e.retries&&await e.onMaxRetryTimesExceeded(t,e.retryCount)}(o,n),Promise.reject(n))});return{requestInterceptorId:n,responseInterceptorId:r}};Y.isNetworkError=V,Y.isSafeRequestError=function(e){var t;return!!(null==(t=e.config)?void 0:t.method)&&(W(e)&&-1!==$.indexOf(e.config.method))},Y.isIdempotentRequestError=H,Y.isNetworkOrIdempotentRequestError=z,Y.exponentialDelay=function(e=0,t=void 0,n=100){const r=2**e*n,s=Math.max(r,K(t));return s+.2*s*Math.random()},Y.linearDelay=function(e=100){return(t=0,n=void 0)=>{const r=t*e;return Math.max(r,K(n))}},Y.isRetryableError=W;const X="https://help-car.online/api/v1";console.log("ðŸ”§ API Service initialized with BASE_URL:",X);const Q=new class{constructor(){this.client=P.create({baseURL:X,timeout:1e4,headers:{"Content-Type":"application/json"}});try{const e="undefined"!=typeof window?localStorage.getItem("token")||sessionStorage.getItem("token"):null;e&&(this.client.defaults.headers.common.Authorization=`Bearer ${e}`)}catch(e){console.warn("Could not access localStorage:",e)}Y(this.client,{retries:3,retryDelay:Y.exponentialDelay,retryCondition:e=>{var t;return Y.isNetworkOrIdempotentRequestError(e)||429===(null==(t=e.response)?void 0:t.status)},onRetry:(e,t,n)=>{console.log(`ðŸ”„ Retry attempt ${e} for ${n.url}`)}}),this.client.interceptors.response.use(e=>e.data,e=>{var t;console.error("API Error:",e);let n="ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°";if(e.response){const t=e.response.status,r=e.response.data;if(null==r?void 0:r.message)n=r.message;else if(null==r?void 0:r.error)n=r.error;else switch(t){case 400:n="ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ";break;case 401:n="ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ email/Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ";break;case 403:n="Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ð·Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½. Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð² Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ";break;case 404:n="Ð—Ð°Ð¿Ñ€Ð¾ÑˆÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÐµÑÑƒÑ€Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½";break;case 409:n="ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾, Ñ‚Ð°ÐºÐ°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚";break;case 429:n="Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð¼Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð². ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð´Ð¾Ð¶Ð´Ð¸Ñ‚Ðµ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾";break;case 500:n="Ð’Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑÑ Ð¾ÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ";break;case 502:n="Ð¡ÐµÑ€Ð²ÐµÑ€ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ";break;case 503:n="Ð¡ÐµÑ€Ð²Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½. Ð’ÐµÐ´ÑƒÑ‚ÑÑ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹";break;default:n=`ÐžÑˆÐ¸Ð±ÐºÐ° ${t}. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ`}e.userMessage=n}else e.request?(n="ÐÐµÑ‚ ÑÐ²ÑÐ·Ð¸ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚Ñƒ",e.userMessage=n):(n="ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°",e.userMessage=n);return null==(t=e.response)||t.status,Promise.reject(e)})}setToken(e){e?this.client.defaults.headers.common.Authorization=`Bearer ${e}`:delete this.client.defaults.headers.common.Authorization}async register(e){return this.client.post("/auth/register",e)}async login(e){const t=new URLSearchParams;return(null==e?void 0:e.email)&&t.append("email",e.email),(null==e?void 0:e.phone)&&t.append("phone",e.phone),(null==e?void 0:e.login)&&(e.login.includes("@")?t.append("email",e.login):t.append("phone",e.login)),(null==e?void 0:e.password)&&t.append("password",e.password),this.client.post("/auth/login",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}async getMe(){return this.client.get("/auth/me")}async updateProfile(e){return this.client.patch("/auth/profile",e)}async forgotPassword(e){return this.client.post("/auth/forgot-password",{email:e})}async resetPassword(e,t,n){return this.client.post("/auth/reset-password",{code:e,newPassword:t,email:n})}async refreshToken(e){return this.client.post("/auth/refresh",{refreshToken:e})}async adminLogin(e){return this.client.post("/admin/login",e)}async createHelpRequest(e){return this.client.post("/help-requests",e)}async getHelpRequests(e){return this.client.get("/help-requests",{params:e,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})}async getMyRequests(){return this.client.get("/help-requests/my")}async getHelpRequest(e){return this.client.get(`/help-requests/${e}`)}async acceptHelpRequest(e){return this.client.post(`/help-requests/${e}/accept`)}async completeHelpRequest(e){return this.client.post(`/help-requests/${e}/complete`)}async cancelHelpRequest(e,t){return this.client.post(`/help-requests/${e}/cancel`,{reason:t})}async getMyChats(){return this.client.get("/chats/my")}async getChatByRequest(e){return this.client.get(`/chats/help-request/${e}`)}async getChatMessages(e,t){return this.client.get(`/chats/${e}/messages`,{params:t})}async sendChatMessage(e,t){return this.client.post(`/chats/${e}/messages`,{content:t})}async getDirectChats(){return this.client.get("/chats/direct")}async uploadChatImage(e){const t=new FormData;return t.append("image",e),this.client.post("/upload/chat-image",t,{headers:{"Content-Type":"multipart/form-data"}})}async uploadVoiceMessage(e,t){const n=new FormData;return n.append("voice",e,"voice.webm"),n.append("duration",t),this.client.post("/upload/voice-message",n,{headers:{"Content-Type":"multipart/form-data"}})}async addReaction(e,t,n){return this.client.post(`/chats/${e}/messages/${t}/reaction`,{emoji:n})}async removeReaction(e,t,n){return this.client.delete(`/chats/${e}/messages/${t}/reaction`,{data:{emoji:n}})}async markChatRead(e){return this.client.post(`/chats/${e}/read`)}async searchMessages(e,t,n=50){return this.client.get(`/chats/${e}/search`,{params:{q:t,limit:n}})}async getChatMedia(e,t="all",n=50){return this.client.get(`/chats/${e}/media`,{params:{type:t,limit:n}})}async createRating(e,t){return this.client.post(`/ratings/help-request/${e}`,t)}async getUserRatings(e){return this.client.get(`/ratings/user/${e}`)}async updateLocation(e,t){return this.client.put("/notifications/location",{latitude:e,longitude:t})}async getNearbyHelpers(e,t=10){return this.client.get(`/notifications/help-request/${e}/nearby-helpers`,{params:{radius:t}})}async getNotifications(e={}){return this.client.get("/notifications",{params:e})}async markNotificationRead(e){return this.client.put(`/notifications/${e}/read`)}async markAllNotificationsRead(){return this.client.put("/notifications/read-all")}async deleteNotification(e){return this.client.delete(`/notifications/${e}`)}async createPayment(e,t,n="card"){return this.client.post(`/payments/help-request/${e}`,{amount:t,payment_method:n})}async confirmPayment(e){return this.client.post(`/payments/${e}/confirm`)}async getUserPayments(e=20,t=0){return this.client.get("/payments",{params:{limit:e,offset:t}})}async getPaymentStats(){return this.client.get("/payments/stats")}async getPaymentById(e){return this.client.get(`/payments/${e}`)}async createSBPPayment(e){return this.client.post("/payments/sbp/create",e)}async confirmPaymentAsPayer(e,t=null){return this.client.post(`/payments/${e}/confirm-payer`,{receipt_url:t})}async confirmPaymentAsReceiver(e){return this.client.post(`/payments/${e}/confirm-receiver`)}async createP2PPayment(e){return this.createSBPPayment(e)}async confirmP2PPayment(e,t){return this.confirmPaymentAsPayer(e,null==t?void 0:t.receipt_url)}async getRatingStatus(e){return this.client.get(`/ratings/help-request/${e}/status`)}async createResponse(e,t){return this.client.post(`/requests/${e}/responses`,t)}async acceptResponse(e){return this.client.post(`/responses/${e}/accept`)}async rejectResponse(e,t){return this.client.post(`/responses/${e}/reject`,{reason:t})}async getResponsesForRequest(e){return this.client.get(`/requests/${e}/responses`)}async getMyResponses(e=null){const t=e?{status:e}:{};return this.client.get("/responses/my",{params:t})}async deleteHelpRequest(e){return this.client.delete(`/help-requests/${e}`)}async uploadRequestImages(e,t){const n=new FormData;return t.forEach(e=>{n.append("images",e.file)}),this.client.post(`/upload/requests/${e}/images`,n,{headers:{"Content-Type":"multipart/form-data"}})}async uploadAvatar(e){const t=new FormData;return t.append("avatar",e),this.client.post("/upload/avatar",t,{headers:{"Content-Type":"multipart/form-data"}})}async uploadCarPhoto(e){return this.client.post("/upload/car-photo",e,{headers:{"Content-Type":"multipart/form-data"}})}async joinCityChat(e){return this.client.post("/city-chats/join",e)}async getMyCityChats(){return this.client.get("/city-chats/my-chats")}async getCityChatMessages(e,t){return this.client.get(`/city-chats/${e}/messages`,{params:t})}async sendCityChatMessage(e,t){return this.client.post(`/city-chats/${e}/messages`,{content:t})}async leaveCityChat(e){return this.client.post(`/city-chats/${e}/leave`)}async getCities(e){return this.client.get("/city-chats/cities",{params:e})}async joinGlobalChat(){return this.client.post("/global-chats/join")}async getGlobalChatMessages(e,t){return this.client.get(`/global-chats/${e}/messages`,{params:t})}async sendGlobalChatMessage(e,t){return this.client.post(`/global-chats/${e}/messages`,{content:t})}async leaveGlobalChat(e){return this.client.delete(`/global-chats/${e}/leave`)}async getFriends(){return this.client.get("/friends")}async getFriendCount(){return this.client.get("/friends/count")}async getPendingFriendRequests(){return this.client.get("/friends/requests/pending")}async getSentFriendRequests(){return this.client.get("/friends/requests/sent")}async searchUsersForFriends(e){return this.client.get("/friends/search",{params:{query:e}})}async sendFriendRequest(e,t=null){return this.client.post("/friends/request",{friend_id:e,message:t})}async acceptFriendRequest(e){return this.client.post(`/friends/${e}/accept`)}async rejectFriendRequest(e){return this.client.post(`/friends/${e}/reject`)}async removeFriend(e){return this.client.delete(`/friends/${e}`)}async getLinkPreview(e){return this.client.get("/utils/link-preview",{params:{url:e}})}async getMultipleLinkPreviews(e){return this.client.post("/utils/link-previews",{urls:e})}async extractUrls(e){return this.client.post("/utils/extract-urls",{text:e})}},Z=Object.create(null);Z.open="0",Z.close="1",Z.ping="2",Z.pong="3",Z.message="4",Z.upgrade="5",Z.noop="6";const ee=Object.create(null);Object.keys(Z).forEach(e=>{ee[Z[e]]=e});const te={type:"error",data:"parser error"},ne="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),re="function"==typeof ArrayBuffer,se=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,oe=({type:e,data:t},n,r)=>ne&&t instanceof Blob?n?r(t):ie(t,r):re&&(t instanceof ArrayBuffer||se(t))?n?r(t):ie(new Blob([t]),r):r(Z[e]+(t||"")),ie=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function ae(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ce;const le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ue="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let oi=0;oi<64;oi++)ue[le.charCodeAt(oi)]=oi;const de="function"==typeof ArrayBuffer,he=(e,t)=>{if("string"!=typeof e)return{type:"message",data:fe(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:pe(e.substring(1),t)};return ee[n]?e.length>1?{type:ee[n],data:e.substring(1)}:{type:ee[n]}:te},pe=(e,t)=>{if(de){const n=(e=>{let t,n,r,s,o,i=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);const l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=ue[e.charCodeAt(t)],r=ue[e.charCodeAt(t+1)],s=ue[e.charCodeAt(t+2)],o=ue[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|s>>2,u[c++]=(3&s)<<6|63&o;return l})(e);return fe(n,t)}return{base64:!0,data:e}},fe=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,ge=String.fromCharCode(30);function me(){return new TransformStream({transform(e,t){!function(e,t){ne&&e.data instanceof Blob?e.data.arrayBuffer().then(ae).then(t):re&&(e.data instanceof ArrayBuffer||se(e.data))?t(ae(e.data)):oe(e,!1,e=>{ce||(ce=new TextEncoder),t(ce.encode(e))})}(e,n=>{const r=n.length;let s;if(r<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,r);else if(r<65536){s=new Uint8Array(3);const e=new DataView(s.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{s=new Uint8Array(9);const e=new DataView(s.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(s[0]|=128),t.enqueue(s),t.enqueue(n)})}})}let ve;function ye(e){return e.reduce((e,t)=>e+t.length,0)}function we(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let s=0;s<t;s++)n[s]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function be(e){if(e)return function(e){for(var t in be.prototype)e[t]=be.prototype[t];return e}(e)}be.prototype.on=be.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},be.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},be.prototype.off=be.prototype.removeListener=be.prototype.removeAllListeners=be.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var s=0;s<r.length;s++)if((n=r[s])===t||n.fn===t){r.splice(s,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},be.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var s=(n=n.slice(0)).length;r<s;++r)n[r].apply(this,t)}return this},be.prototype.emitReserved=be.prototype.emit,be.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},be.prototype.hasListeners=function(e){return!!this.listeners(e).length};const _e="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ke="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function Ee(e,...t){return t.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const Te=ke.setTimeout,Se=ke.clearTimeout;function Ce(e,t){t.useNativeTimers?(e.setTimeoutFn=Te.bind(ke),e.clearTimeoutFn=Se.bind(ke)):(e.setTimeoutFn=ke.setTimeout.bind(ke),e.clearTimeoutFn=ke.clearTimeout.bind(ke))}function Ie(e){return"string"==typeof e?function(e){let t=0,n=0;for(let r=0,s=e.length;r<s;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function Ae(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class xe extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Re extends be{constructor(e){super(),this.writable=!1,Ce(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new xe(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=he(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class Oe extends Re{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(ge),r=[];for(let s=0;s<n.length;s++){const e=he(n[s],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let s=0;e.forEach((e,o)=>{oe(e,!1,e=>{r[o]=e,++s===n&&t(r.join(ge))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ae()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let De=!1;try{De="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(si){}const Pe=De;function Ne(){}class Le extends Oe{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class Me extends be{constructor(e,t,n){super(),this.createRequest=e,Ce(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=Ee(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(r){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{n.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof n.status?n.status:0)},0))},n.send(this._data)}catch(r){return void this.setTimeoutFn(()=>{this._onError(r)},0)}"undefined"!=typeof document&&(this._index=Me.requestsCount++,Me.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Ne,e)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Me.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Me.requestsCount=0,Me.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",je);else if("function"==typeof addEventListener){addEventListener("onpagehide"in ke?"pagehide":"unload",je,!1)}function je(){for(let e in Me.requests)Me.requests.hasOwnProperty(e)&&Me.requests[e].abort()}const qe=function(){const e=Be({xdomain:!1});return e&&null!==e.responseType}();function Be(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Pe))return new XMLHttpRequest}catch(n){}if(!t)try{return new(ke[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}const Fe="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Ve extends Re{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Fe?{}:Ee(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(si){return this.emitReserved("error",si)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;oe(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch(t){}r&&_e(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ae()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const $e=ke.WebSocket||ke.MozWebSocket;const Ue={websocket:class extends Ve{createSocket(e,t,n){return Fe?new $e(e,t,n):t?new $e(e,t):new $e(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends Re{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(si){return this.emitReserved("error",si)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){ve||(ve=new TextDecoder);const n=[];let r=0,s=-1,o=!1;return new TransformStream({transform(i,a){for(n.push(i);;){if(0===r){if(ye(n)<1)break;const e=we(n,1);o=!(128&~e[0]),s=127&e[0],r=s<126?3:126===s?1:2}else if(1===r){if(ye(n)<2)break;const e=we(n,2);s=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(ye(n)<8)break;const e=we(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){a.enqueue(te);break}s=o*Math.pow(2,32)+t.getUint32(4),r=3}else{if(ye(n)<s)break;const e=we(n,s);a.enqueue(he(o?e:ve.decode(e),t)),r=0}if(0===s||s>e){a.enqueue(te);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=me();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const s=()=>{n.read().then(({done:e,value:t})=>{e||(this.onPacket(t),s())}).catch(e=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&_e(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends Le{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=qe&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Me(Be,this.uri(),e)}}},We=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,He=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ze(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let s=We.exec(e||""),o={},i=14;for(;i--;)o[He[i]]=s[i]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n[t]=r)}),n}(0,o.query),o}const Ke="function"==typeof addEventListener&&"function"==typeof removeEventListener,Ge=[];Ke&&addEventListener("offline",()=>{Ge.forEach(e=>e())},!1);class Je extends be{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const n=ze(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=ze(t.host).host);Ce(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let r=0,s=n.length;r<s;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),Ke&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ge.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&Je.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",Je.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Ie(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,_e(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const s={type:e,data:t,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Je.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ke&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Ge.indexOf(this._offlineEventListener);-1!==e&&Ge.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Je.protocol=4;class Ye extends Je{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Je.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Je.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function s(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,s(),this.emitReserved("upgradeError",n)};function i(){o("transport closed")}function a(){o("socket closed")}function c(e){t&&e.name!==t.name&&s()}const l=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",i),this.off("close",a),this.off("upgrading",c)};t.once("open",r),t.once("error",o),t.once("close",i),this.once("close",a),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Xe=class extends Ye{constructor(e,t={}){const n="object"==typeof e?e:t;(!n.transports||n.transports&&"string"==typeof n.transports[0])&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(e=>Ue[e]).filter(e=>!!e)),super(e,n)}};const Qe="function"==typeof ArrayBuffer,Ze=Object.prototype.toString,et="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Ze.call(Blob),tt="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Ze.call(File);function nt(e){return Qe&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||et&&e instanceof Blob||tt&&e instanceof File}function rt(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(rt(e[t]))return!0;return!1}if(nt(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return rt(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&rt(e[n]))return!0;return!1}function st(e){const t=[],n=e.data,r=e;return r.data=ot(n,t),r.attachments=t.length,{packet:r,buffers:t}}function ot(e,t){if(!e)return e;if(nt(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=ot(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=ot(e[r],t));return n}return e}function it(e,t){return e.data=at(e.data,t),delete e.attachments,e}function at(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=at(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=at(e[n],t));return e}const ct=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var lt,ut;(ut=lt||(lt={}))[ut.CONNECT=0]="CONNECT",ut[ut.DISCONNECT=1]="DISCONNECT",ut[ut.EVENT=2]="EVENT",ut[ut.ACK=3]="ACK",ut[ut.CONNECT_ERROR=4]="CONNECT_ERROR",ut[ut.BINARY_EVENT=5]="BINARY_EVENT",ut[ut.BINARY_ACK=6]="BINARY_ACK";function dt(e){return"[object Object]"===Object.prototype.toString.call(e)}class ht extends be{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===lt.BINARY_EVENT;n||t.type===lt.BINARY_ACK?(t.type=n?lt.EVENT:lt.ACK,this.reconstructor=new pt(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!nt(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===lt[n.type])throw new Error("unknown packet type "+n.type);if(n.type===lt.BINARY_EVENT||n.type===lt.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const s=e.substring(r,t);if(s!=Number(s)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(s)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!ht.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case lt.CONNECT:return dt(t);case lt.DISCONNECT:return void 0===t;case lt.CONNECT_ERROR:return"string"==typeof t||dt(t);case lt.EVENT:case lt.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ct.indexOf(t[0]));case lt.ACK:case lt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class pt{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=it(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ft=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ht,Encoder:class{constructor(e){this.replacer=e}encode(e){return e.type!==lt.EVENT&&e.type!==lt.ACK||!rt(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===lt.EVENT?lt.BINARY_EVENT:lt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==lt.BINARY_EVENT&&e.type!==lt.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=st(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}},get PacketType(){return lt},protocol:5},Symbol.toStringTag,{value:"Module"}));function gt(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const mt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class vt extends be{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[gt(e,"open",this.onopen.bind(this)),gt(e,"packet",this.onpacket.bind(this)),gt(e,"error",this.onerror.bind(this)),gt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,s;if(mt.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:lt.EVENT,data:t,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),o.id=e}const i=null===(r=null===(n=this.io.engine)||void 0===n?void 0:n.transport)||void 0===r?void 0:r.writable,a=this.connected&&!(null===(s=this.io.engine)||void 0===s?void 0:s._hasPingExpired());return this.flags.volatile&&!i||(a?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},r),o=(...e)=>{this.io.clearTimeoutFn(s),t.apply(this,e)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{const s=(e,t)=>e?r(e):n(t);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()}),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:lt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case lt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case lt.EVENT:case lt.BINARY_EVENT:this.onevent(e);break;case lt.ACK:case lt.BINARY_ACK:this.onack(e);break;case lt.DISCONNECT:this.ondisconnect();break;case lt.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:lt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:lt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function yt(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}yt.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},yt.prototype.reset=function(){this.attempts=0},yt.prototype.setMin=function(e){this.ms=e},yt.prototype.setMax=function(e){this.max=e},yt.prototype.setJitter=function(e){this.jitter=e};class wt extends be{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Ce(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new yt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||ft;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Xe(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=gt(t,"open",function(){n.onopen(),e&&e()}),s=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=gt(t,"error",s);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{r(),s(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(gt(e,"ping",this.onping.bind(this)),gt(e,"data",this.ondata.bind(this)),gt(e,"error",this.onerror.bind(this)),gt(e,"close",this.onclose.bind(this)),gt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){_e(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new vt(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const bt={};function _t(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=ze(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+t,r.href=r.protocol+"://"+s+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,s=n.id,o=n.path,i=bt[s]&&o in bt[s].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||i?a=new wt(r,t):(bt[s]||(bt[s]=new wt(r,t)),a=bt[s]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(_t,{Manager:wt,Socket:vt,io:_t,connect:_t});const kt=new class{constructor(){this.sounds={notification:null,message:null,success:null,error:null},this.enabled=!0,this.volume=.7,this.initSounds()}initSounds(){this.sounds.notification=new Audio("/notification.mp3"),this.sounds.notification.volume=this.volume,this.sounds.message=new Audio("/notification.mp3"),this.sounds.message.volume=.6*this.volume,this.sounds.success=new Audio("/notification.mp3"),this.sounds.success.volume=.8*this.volume,this.sounds.error=new Audio("/notification.mp3"),this.sounds.error.volume=.9*this.volume}async play(e="notification"){try{const t=!1!==JSON.parse(localStorage.getItem("user")||"{}").notify_sound;if(!this.enabled||!t)return void console.log("ðŸ”‡ Sound disabled by user settings");const n=this.sounds[e]||this.sounds.notification;n.currentTime=0,await n.play(),console.log(`ðŸ”Š Playing ${e} sound`)}catch(t){console.warn("Failed to play sound:",t.message)}}playNotification(){return this.play("notification")}playMessage(){return this.play("message")}playSuccess(){return this.play("success")}playError(){return this.play("error")}setEnabled(e){this.enabled=e,localStorage.setItem("soundEnabled",e)}setVolume(e){this.volume=Math.max(0,Math.min(1,e)),Object.values(this.sounds).forEach(e=>{e&&(e.volume=this.volume)}),localStorage.setItem("soundVolume",this.volume)}isSupported(){return"undefined"!=typeof Audio}};const Et=new class{constructor(){this.socket=null,this.isConnected=e(!1),this.listeners=new Map,this.reconnectAttempts=0,this.maxReconnectAttempts=5}connect(e){var t;e?(null==(t=this.socket)?void 0:t.connected)?console.log("âœ… WebSocket ÑƒÐ¶Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½"):(this.socket&&(this.socket.disconnect(),this.socket=null),setTimeout(()=>{this._doConnect(e)},100)):console.warn("âš ï¸ WebSocket: Ñ‚Ð¾ÐºÐµÐ½ Ð½Ðµ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½, Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÑŽ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ")}_doConnect(e){let t;const n="wss://help-car.online";t="https:"===window.location.protocol&&n.startsWith("ws://")?n.replace(/^ws:\/\//,"wss://"):/^https?:\/\//i.test(n)?n.replace(/^http/i,"https:"===window.location.protocol?"wss":"ws"):/^wss?:\/\//i.test(n)?n:("https:"===window.location.protocol?"wss://":"ws://")+n,console.log("ðŸ”Œ ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº WebSocket:",{url:t,hasToken:!!e,tokenLength:null==e?void 0:e.length,protocol:window.location.protocol}),this.socket=_t(t,{auth:{token:e},transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!1,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:10,timeout:2e4,forceNew:!1,autoConnect:!0,withCredentials:!0,extraHeaders:e?{Authorization:`Bearer ${e}`}:{}}),this.socket.on("connect",()=>{console.log("âœ… WebSocket connected"),this.isConnected.value=!0,this.reconnectAttempts=0,this.listeners.forEach((e,t)=>{this.socket.on(t,e)}),this.setupSoundNotifications()}),this.socket.on("disconnect",e=>{console.log("âŒ WebSocket disconnected:",e),this.isConnected.value=!1,"io server disconnect"===e&&this.socket&&this.socket.connect()}),this.socket.on("connect_error",e=>{if(console.error("âŒ WebSocket connect error:",e),console.error("Error details:",{message:e.message,type:e.type,description:e.description,url:t}),this.isConnected.value=!1,this.reconnectAttempts++,3===this.reconnectAttempts&&this.socket.io.opts.transports.includes("websocket"))return console.log("ðŸ”„ ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÑŽÑÑŒ Ð½Ð° polling transport..."),this.socket.io.opts.transports=["polling","websocket"],this.socket.disconnect(),void setTimeout(()=>{this.socket.connect()},1e3);this.reconnectAttempts<this.maxReconnectAttempts?setTimeout(()=>{console.log(`ðŸ”„ Reconnecting... Attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts}`),this.socket&&!this.socket.connected&&this.socket.connect()},2e3*this.reconnectAttempts):console.error("âŒ Max reconnection attempts reached. WebSocket will not be available.")})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected.value=!1)}on(e,t){this.listeners.set(e,t),this.socket&&this.socket.on(e,t)}off(e){this.socket&&(this.socket.off(e),this.listeners.delete(e))}emit(e,t){var n;(null==(n=this.socket)?void 0:n.connected)?this.socket.emit(e,t):console.warn("Socket not connected")}sendMessage(e,t){this.emit("chat:sendMessage",{chatId:e,content:t})}markMessagesRead(e){this.emit("chat:markRead",{chatId:e})}sendTypingIndicator(e,t){this.emit("chat:typing",{chatId:e,recipientId:t})}updateLocation(e,t){this.emit("location:update",{latitude:e,longitude:t})}setupSoundNotifications(){this.socket&&(this.socket.on("helpRequest:new",e=>{console.log("ðŸ†• ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ°:",e),kt.playNotification()}),this.socket.on("chat:newMessage",e=>{console.log("ðŸ’¬ ÐÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ:",e),kt.playMessage()}),this.socket.on("response:new",e=>{console.log("ðŸ”” ÐÐ¾Ð²Ñ‹Ð¹ Ð¾Ñ‚ÐºÐ»Ð¸Ðº:",e),kt.playNotification()}),this.socket.on("response:accepted",e=>{console.log("âœ… Ð—Ð°ÑÐ²ÐºÐ° Ð¿Ñ€Ð¸Ð½ÑÑ‚Ð°:",e),kt.playSuccess()}),this.socket.on("helpRequest:completed",e=>{console.log("âœ… Ð—Ð°ÑÐ²ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°:",e),kt.playSuccess()}),this.socket.on("rating:new",e=>{console.log("â­ ÐÐ¾Ð²Ð°Ñ Ð¾Ñ†ÐµÐ½ÐºÐ°:",e),kt.playSuccess()}),this.socket.on("response:cancelled",e=>{console.log("âŒ ÐžÑ‚ÐºÐ»Ð¸Ðº Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½:",e),kt.playError()}))}},Tt=o("auth",()=>{const n=e(null),r=e(localStorage.getItem("token")||sessionStorage.getItem("token")||null),s=e(!1),o=e(null),i=t(()=>!!r.value),a=t(()=>!!r.value);function c(){try{return"true"===localStorage.getItem("rememberMe")?localStorage:sessionStorage}catch(e){return localStorage}}function l(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),sessionStorage.removeItem("token"),sessionStorage.removeItem("refreshToken"),sessionStorage.removeItem("user")}function u({accessToken:e,refreshToken:t,userData:s,rememberMe:o}){const i=o?localStorage:sessionStorage;l(),r.value=e,n.value=s,i.setItem("token",e),i.setItem("user",JSON.stringify(s)),t&&i.setItem("refreshToken",t),Q.setToken(e);try{Et.connect(e)}catch(a){console.warn("âš ï¸ WebSocket connection failed, continuing:",a)}}async function d(){r.value=null,n.value=null,l(),localStorage.removeItem("fcm_registered"),Et.disconnect()}return{user:n,token:r,isLoading:s,error:o,isAuthenticated:i,isLoggedIn:a,register:async function(e,t=!1,n=2){var r,i,a,c,l,d,h,p,f,g,m;s.value=!0,o.value=null;for(let s=0;s<=n;s++)try{s>0&&(console.log(`ðŸ”„ Registration retry attempt ${s}/${n}`),await new Promise(e=>setTimeout(e,1e3*s)));const o=await Q.register(e);if(console.log("ðŸ” Auth store register response:",o),!o||!o.success)throw new Error((null==o?void 0:o.error)||"ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°");const c=null==(r=null==o?void 0:o.data)?void 0:r.accessToken,l=null==(i=null==o?void 0:o.data)?void 0:i.user,d=null==(a=null==o?void 0:o.data)?void 0:a.refreshToken;if(console.log("ðŸ” Extracted accessToken:",c?"present":"missing"),console.log("ðŸ” Extracted userData:",l?"present":"missing"),console.log("ðŸ” Extracted refreshToken:",d?"present":"missing"),!c)throw new Error("Ð¢Ð¾ÐºÐµÐ½ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¿Ñ€Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸");if(!l||!l.id)throw new Error("Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹ Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°");return u({accessToken:c,refreshToken:d,userData:l,rememberMe:t}),console.log("âœ… Registration successful, token and user saved"),setTimeout(async()=>{try{if("Notification"in window&&"granted"!==Notification.permission){console.log("ðŸ”” Notification permission:",Notification.permission,"- requesting...");const e=await Notification.requestPermission();console.log("ðŸ”” Permission result:",e)}const{initializePushNotifications:e}=await j(async()=>{const{initializePushNotifications:e}=await Promise.resolve().then(()=>Ho);return{initializePushNotifications:e}},void 0),t=await e();console.log("ðŸ”” FCM registration after register:",t?"âœ… success":"âŒ failed"),t&&localStorage.setItem("fcm_registered","true")}catch(e){console.warn("âš ï¸ FCM registration error:",e)}},1e3),o}catch(si){if(console.error(`âŒ Registration error (attempt ${s+1}/${n+1}):`,si),s===n||si.response&&si.response.status<500)throw o.value=si.userMessage||(null==(l=null==(c=si.response)?void 0:c.data)?void 0:l.error)||(null==(h=null==(d=si.response)?void 0:d.data)?void 0:h.message)||"ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸",si;if(!si.response)continue;if(si.response.status>=500)continue;throw o.value=si.userMessage||(null==(f=null==(p=si.response)?void 0:p.data)?void 0:f.error)||(null==(m=null==(g=si.response)?void 0:g.data)?void 0:m.message)||"ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸",si}throw s.value=!1,new Error("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¿Ð¾ÑÐ»Ðµ Ð²ÑÐµÑ… Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº")},login:async function(e,t=!1,n=2){var r,i,a,c,l,d,h,p,f,g,m;s.value=!0,o.value=null;for(let s=0;s<=n;s++)try{s>0&&(console.log(`ðŸ”„ Login retry attempt ${s}/${n}`),await new Promise(e=>setTimeout(e,1e3*s)));const o=await Q.login(e);if(console.log("ðŸ” Auth store login response:",o),!o||!o.success)throw new Error((null==o?void 0:o.error)||"ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°");const c=null==(r=null==o?void 0:o.data)?void 0:r.accessToken,l=null==(i=null==o?void 0:o.data)?void 0:i.user,d=null==(a=null==o?void 0:o.data)?void 0:a.refreshToken;if(console.log("ðŸ” Extracted accessToken:",c?"present":"missing"),console.log("ðŸ” Extracted userData:",l?"present":"missing"),console.log("ðŸ” Extracted refreshToken:",d?"present":"missing"),!c)throw new Error("Ð¢Ð¾ÐºÐµÐ½ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°");if(!l||!l.id)throw new Error("Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹ Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°");return u({accessToken:c,refreshToken:d,userData:l,rememberMe:t}),console.log("âœ… Login successful, token saved"),setTimeout(async()=>{try{if("true"===localStorage.getItem("fcm_registered")&&"Notification"in window&&"granted"===Notification.permission)return void console.log("ðŸ”” FCM already registered, skipping");if("Notification"in window&&"granted"!==Notification.permission){console.log("ðŸ”” Notification permission:",Notification.permission,"- requesting...");const e=await Notification.requestPermission();console.log("ðŸ”” Permission result:",e)}const{initializePushNotifications:e}=await j(async()=>{const{initializePushNotifications:e}=await Promise.resolve().then(()=>Ho);return{initializePushNotifications:e}},void 0),t=await e();console.log("ðŸ”” FCM registration after login:",t?"âœ… success":"âŒ failed"),t&&localStorage.setItem("fcm_registered","true")}catch(e){console.warn("âš ï¸ FCM registration error:",e)}},1e3),o}catch(si){if(console.error(`âŒ Login error (attempt ${s+1}/${n+1}):`,si),s===n||si.response&&si.response.status<500)throw o.value=si.userMessage||(null==(l=null==(c=si.response)?void 0:c.data)?void 0:l.error)||(null==(h=null==(d=si.response)?void 0:d.data)?void 0:h.message)||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°",si;if(!si.response)continue;if(si.response.status>=500)continue;throw o.value=si.userMessage||(null==(f=null==(p=si.response)?void 0:p.data)?void 0:f.error)||(null==(m=null==(g=si.response)?void 0:g.data)?void 0:m.message)||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°",si}throw s.value=!1,new Error("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ð¾Ð¹Ñ‚Ð¸ Ð¿Ð¾ÑÐ»Ðµ Ð²ÑÐµÑ… Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº")},logout:d,checkAuth:async function(){var e,t,s,o,i,a,l,h,p;if(!r.value){const e=c().getItem("token");e&&(r.value=e)}if(!r.value){const t=c().getItem("refreshToken");if(t)try{const r=await Q.refreshToken(t);if((null==r?void 0:r.success)&&(null==(e=null==r?void 0:r.data)?void 0:e.accessToken)){const e="true"===localStorage.getItem("rememberMe");return void u({accessToken:r.data.accessToken,refreshToken:r.data.refreshToken||t,userData:r.data.user||n.value,rememberMe:e})}}catch(f){return console.warn("âš ï¸ Refresh token failed, logging out:",f),void(await d())}return}try{Q.setToken(r.value);const e=await Q.getMe();if(console.log("ðŸ” checkAuth response:",e),e&&e.success&&e.data)n.value=e.data.user||e.data,console.log("âœ… User loaded from checkAuth:",null==(t=n.value)?void 0:t.id,null==(s=n.value)?void 0:s.full_name);else{if(!e||!e.id)throw console.error("âŒ Invalid user data format:",e),new Error("Invalid user data format");n.value=e,console.log("âœ… User loaded (direct format):",null==(o=n.value)?void 0:o.id)}n.value&&(localStorage.setItem("user",JSON.stringify(n.value)),console.log("âœ… User saved to localStorage"));try{Et.connect(r.value)}catch(g){console.warn("âš ï¸ WebSocket connection failed:",g)}}catch(si){if(console.error("âŒ checkAuth error:",si),console.error("Error details:",(null==(i=si.response)?void 0:i.data)||si.message),401===(null==(a=si.response)?void 0:a.status)){const e=c().getItem("refreshToken");if(e)try{console.log("ðŸ”„ Attempting token refresh...");const t=await Q.refreshToken(e);console.log("ðŸ”„ Refresh response:",t);const s=(null==(l=null==t?void 0:t.data)?void 0:l.accessToken)||(null==t?void 0:t.accessToken),o=(null==(h=null==t?void 0:t.data)?void 0:h.refreshToken)||(null==t?void 0:t.refreshToken);if(s){const t="true"===localStorage.getItem("rememberMe");u({accessToken:s,refreshToken:o||e,userData:n.value,rememberMe:t}),console.log("âœ… Token refreshed, retrying getMe...");try{const e=await Q.getMe();if(console.log("ðŸ”„ Retry getMe response:",e),e){if(e.success&&e.data?n.value=e.data.user||e.data:e.id&&(n.value=e),n.value){const e="true"===localStorage.getItem("rememberMe");(e?localStorage:sessionStorage).setItem("user",JSON.stringify(n.value)),console.log("âœ… User loaded after token refresh")}try{Et.connect(r.value)}catch(g){console.warn("âš ï¸ WebSocket connection failed:",g)}return}}catch(m){console.error("âŒ Retry getMe after refresh failed:",m)}}else console.warn("âš ï¸ No accessToken in refresh response")}catch(f){console.warn("âš ï¸ Refresh token failed:",f),console.warn("Refresh error details:",(null==(p=f.response)?void 0:p.data)||f.message)}else console.warn("âš ï¸ No refresh token available")}console.error("âŒ checkAuth failed, logging out"),await d()}},updateProfile:async function(e){var t,r;try{const t=await Q.updateProfile(e);return n.value={...n.value,...t.data},t}catch(si){throw o.value=(null==(r=null==(t=si.response)?void 0:t.data)?void 0:r.message)||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ",si}},forgotPassword:async function(e){try{return await Q.forgotPassword(e)}catch(si){throw console.error("âŒ Forgot password error:",si),si}},resetPassword:async function(e,t,n){try{return await Q.resetPassword(e,t,n)}catch(si){throw console.error("âŒ Reset password error:",si),si}},refreshUser:async function(){if(!r.value)return null;try{Q.setToken(r.value);const e=await Q.getMe();if(e&&e.success&&e.data?n.value=e.data.user||e.data:e&&e.id&&(n.value=e),n.value){const e="true"===localStorage.getItem("rememberMe");(e?localStorage:sessionStorage).setItem("user",JSON.stringify(n.value)),console.log("âœ… User data refreshed, rating:",n.value.rating)}return n.value}catch(si){return console.error("âŒ refreshUser error:",si),null}}}}),St=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Tt},Symbol.toStringTag,{value:"Module"})),Ct=o("invitations",()=>{const n=e([]),r=()=>{try{const e=localStorage.getItem("friendInvitations");if(e){n.value=JSON.parse(e);const t=Date.now()-864e5;n.value=n.value.filter(e=>e.timestamp>t),s()}}catch(e){console.error("Failed to load invitations:",e)}},s=()=>{try{localStorage.setItem("friendInvitations",JSON.stringify(n.value))}catch(e){console.error("Failed to save invitations:",e)}},o=t(()=>n.value.filter(e=>"pending"===e.status)),i=t(()=>o.value.length);return r(),{invitations:n,pendingInvitations:o,pendingCount:i,addInvitation:e=>{if(n.value.some(t=>{var n,r;return t.helpRequestId===e.helpRequestId&&(null==(n=t.sender)?void 0:n.id)===(null==(r=e.sender)?void 0:r.id)}))return;const t={id:`inv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,helpRequestId:e.helpRequestId,problemType:e.problemType,description:e.description,sender:e.sender,message:e.message,timestamp:Date.now(),status:"pending"};n.value.unshift(t),s()},acceptInvitation:e=>{const t=n.value.find(t=>t.id===e);return t&&(t.status="accepted",s()),t},declineInvitation:e=>{const t=n.value.find(t=>t.id===e);t&&(t.status="declined",s())},removeInvitation:e=>{n.value=n.value.filter(t=>t.id!==e),s()},clearAll:()=>{n.value=[],s()},loadFromStorage:r}}),It=e([]);let At=0;function xt(){function e({type:e="info",title:n="",message:r,duration:s=5e3}){const o=++At,i={id:o,type:e,title:n,message:r,duration:s,progress:100,createdAt:Date.now()};if(It.value.push(i),s>0){const e=Date.now(),n=setInterval(()=>{const r=Date.now()-e,i=It.value.findIndex(e=>e.id===o);-1!==i&&(It.value[i].progress=Math.max(0,100-r/s*100)),r>=s&&(clearInterval(n),t(o))},50);i.intervalId=n}return o}function t(e){const t=It.value.findIndex(t=>t.id===e);if(-1!==t){const e=It.value[t];e.intervalId&&clearInterval(e.intervalId),It.value.splice(t,1)}}return{toasts:i(It),addToast:e,removeToast:t,clearAll:function(){It.value.forEach(e=>{e.intervalId&&clearInterval(e.intervalId)}),It.value=[]},success:(t,n="")=>e({type:"success",title:n,message:t}),error:(t,n="")=>e({type:"error",title:n,message:t}),warning:(t,n="")=>e({type:"warning",title:n,message:t}),info:(t,n="")=>e({type:"info",title:n,message:t})}}const Rt=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},Ot=["onClick"],Dt={class:"flex-shrink-0 text-3xl"},Pt={class:"flex-1"},Nt={key:0,class:"font-black text-lg mb-1"},Lt={class:"text-sm leading-relaxed"},Mt=["onClick"],jt=Rt({__name:"Toast",setup(e){const{toasts:t,removeToast:n}=xt();function r(e){const t={success:"bg-gradient-to-r from-green-500 to-green-600 text-white",error:"bg-gradient-to-r from-red-500 to-red-600 text-white",warning:"bg-gradient-to-r from-yellow-500 to-orange-600 text-white",info:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",default:"bg-white text-gray-900 border-2 border-gray-200"};return t[e]||t.default}function s(e){const t={success:"âœ…",error:"âŒ",warning:"âš ï¸",info:"â„¹ï¸",default:"ðŸ’¬"};return t[e]||t.default}function o(e){if(!e.createdAt||!e.duration)return 100;const t=Date.now()-e.createdAt;return Math.max(0,100-t/e.duration*100)}return(e,i)=>(m(),a(g,{to:"body"},[c(f,{name:"toast",tag:"div",class:"fixed top-6 right-6 z-[9999] space-y-3 pointer-events-none"},{default:l(()=>[(m(!0),u(p,null,d(h(t),e=>(m(),u("div",{key:e.id,class:v(["pointer-events-auto px-6 py-4 rounded-2xl shadow-2xl transform transition-all duration-300","flex items-center gap-4 min-w-[320px] max-w-md",r(e.type)]),onClick:t=>h(n)(e.id)},[y("div",Dt,b(s(e.type)),1),y("div",Pt,[e.title?(m(),u("h4",Nt,b(e.title),1)):w("",!0),y("p",Lt,b(e.message),1)]),y("button",{class:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-lg hover:bg-black/10 transition",onClick:_(t=>h(n)(e.id),["stop"])},[...i[0]||(i[0]=[y("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[y("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Mt),e.duration?(m(),u("div",{key:0,class:"absolute bottom-0 left-0 h-1 bg-current opacity-30 rounded-b-2xl transition-all ease-linear",style:k({width:`${o(e)}%`,transitionDuration:`${e.duration}ms`})},null,4)):w("",!0)],10,Ot))),128))]),_:1})]))}},[["__scopeId","data-v-fe8baf51"]]),qt={class:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl max-w-md w-full p-6 transform animate-slide-up"},Bt={class:"grid grid-cols-2 gap-3 mb-6"},Ft=["disabled"],Vt=["disabled"],$t=["disabled"],Ut=["disabled"],Wt=["disabled"],Ht=["disabled"],zt={key:0,class:"text-center py-4"},Kt={class:"flex gap-3"},Gt=Rt({__name:"SOSButton",setup(n){const r=C(),s=E(),o=Tt(),i=e(!1),a=e(!1),d=["/chat/","/direct-chat/","/city-chats","/global-chat","/map","/login","/register","/forgot-password","/reset-password","/user/"],p=t(()=>{const e=s.path;return!d.some(t=>e.startsWith(t))}),f=async e=>{try{a.value=!0;let s=55.7558,o=37.6173,c="ÐœÐ¾ÑÐºÐ²Ð°";if("geolocation"in navigator)try{const e=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});s=e.coords.latitude,o=e.coords.longitude;try{const e=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${s}&lon=${o}&format=json&accept-language=ru`),t=await e.json();t.display_name&&(c=t.display_name.split(",").slice(0,3).join(","))}catch(t){console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð°Ð´Ñ€ÐµÑ")}}catch(n){return console.warn("Ð“ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°:",n),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ Ð¼ÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð·Ð°ÑÐ²ÐºÑƒ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ."),void r.push("/create-request")}const l={battery:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! Ð¡ÐµÐ» Ð°ÐºÐºÑƒÐ¼ÑƒÐ»ÑÑ‚Ð¾Ñ€",fuel:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! Ð—Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¾ÑÑŒ Ñ‚Ð¾Ð¿Ð»Ð¸Ð²Ð¾",tire:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! ÐŸÑ€Ð¾Ð±Ð¸Ñ‚Ð¾ ÐºÐ¾Ð»ÐµÑÐ¾",towing:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! ÐÑƒÐ¶Ð½Ð° Ð±ÑƒÐºÑÐ¸Ñ€Ð¾Ð²ÐºÐ°",road_conflict:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð½Ð° Ð´Ð¾Ñ€Ð¾Ð³Ðµ",other:"Ð¡Ñ€Ð¾Ñ‡Ð½Ð¾! ÐÑƒÐ¶Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ"},u=await Q.createHelpRequest({problem_type:e,description:l[e]+" (ÑÐ¾Ð·Ð´Ð°Ð½Ð¾ Ñ‡ÐµÑ€ÐµÐ· SOS)",address:c,location:{type:"Point",coordinates:[o,s]},is_urgent:!0});if(!u.success)throw new Error(u.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸");i.value=!1,alert("âœ… Ð—Ð°ÑÐ²ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð°! ÐžÐ¶Ð¸Ð´Ð°Ð¹Ñ‚Ðµ Ð¾Ñ‚ÐºÐ»Ð¸ÐºÐ¾Ð²."),r.push("/my-requests")}catch(s){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ SOS-Ð·Ð°ÑÐ²ÐºÐ¸:",s),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ: "+(s.message||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°"))}finally{a.value=!1}};return(e,t)=>{const n=S("router-link");return m(),u("div",null,[h(o).isLoggedIn&&p.value?(m(),u("button",{key:0,class:"hidden md:flex fixed bottom-8 right-8 z-[1100] w-20 h-20 bg-gradient-to-br from-red-500 to-red-700 rounded-full shadow-2xl items-center justify-center text-white hover:from-red-600 hover:to-red-800 transition-all transform hover:scale-110 animate-pulse-slow",title:"Ð­ÐºÑÑ‚Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ñ‰Ð¸",onClick:t[0]||(t[0]=e=>i.value=!0)},[...t[10]||(t[10]=[y("div",{class:"text-center"},[y("div",{class:"text-3xl font-black"}," SOS ")],-1),y("span",{class:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-30"},null,-1)])])):w("",!0),i.value?(m(),u("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",onClick:t[9]||(t[9]=_(e=>i.value=!1,["self"]))},[y("div",qt,[t[19]||(t[19]=y("div",{class:"text-center mb-6"},[y("div",{class:"text-6xl mb-3"}," ðŸ†˜ "),y("h2",{class:"text-3xl font-black text-gray-900 dark:text-white"}," Ð­ÐºÑÑ‚Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ "),y("p",{class:"text-gray-500 text-sm mt-2"}," Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ð¸Ð¿ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð° ")],-1)),y("div",Bt,[y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 hover:from-yellow-100 hover:to-yellow-200 rounded-2xl transition transform hover:scale-105",onClick:t[1]||(t[1]=e=>f("battery"))},[...t[11]||(t[11]=[y("div",{class:"text-3xl mb-1"}," ðŸ”‹ ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," Ð¡ÐµÐ» Ð°ÐºÐºÑƒÐ¼ÑƒÐ»ÑÑ‚Ð¾Ñ€ ",-1)])],8,Ft),y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-orange-50 to-orange-100 hover:from-orange-100 hover:to-orange-200 rounded-2xl transition transform hover:scale-105",onClick:t[2]||(t[2]=e=>f("fuel"))},[...t[12]||(t[12]=[y("div",{class:"text-3xl mb-1"}," â›½ ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," Ð—Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»ÑÑ Ð±ÐµÐ½Ð·Ð¸Ð½ ",-1)])],8,Vt),y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-gray-50 to-gray-100 hover:from-gray-100 hover:to-gray-200 rounded-2xl transition transform hover:scale-105",onClick:t[3]||(t[3]=e=>f("tire"))},[...t[13]||(t[13]=[y("div",{class:"text-3xl mb-1"}," ðŸ›ž ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," ÐŸÑ€Ð¾Ð±Ð¸Ñ‚Ð¾ ÐºÐ¾Ð»ÐµÑÐ¾ ",-1)])],8,$t),y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 rounded-2xl transition transform hover:scale-105",onClick:t[4]||(t[4]=e=>f("towing"))},[...t[14]||(t[14]=[y("div",{class:"text-3xl mb-1"}," ðŸš— ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," ÐÑƒÐ¶Ð½Ð° Ð±ÑƒÐºÑÐ¸Ñ€Ð¾Ð²ÐºÐ° ",-1)])],8,Ut),y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-red-50 to-red-100 hover:from-red-100 hover:to-red-200 rounded-2xl transition transform hover:scale-105",onClick:t[5]||(t[5]=e=>f("road_conflict"))},[...t[15]||(t[15]=[y("div",{class:"text-3xl mb-1"}," ðŸš¨ ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð½Ð° Ð´Ð¾Ñ€Ð¾Ð³Ðµ ",-1)])],8,Wt),y("button",{disabled:a.value,class:"p-4 bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 rounded-2xl transition transform hover:scale-105",onClick:t[6]||(t[6]=e=>f("other"))},[...t[16]||(t[16]=[y("div",{class:"text-3xl mb-1"}," ðŸ”§ ",-1),y("div",{class:"font-bold text-gray-800 text-sm"}," Ð”Ñ€ÑƒÐ³Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° ",-1)])],8,Ht)]),a.value?(m(),u("div",zt,[...t[17]||(t[17]=[y("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-red-600 mx-auto"},null,-1),y("p",{class:"mt-2 text-gray-600"}," ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð¼ÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ... ",-1)])])):w("",!0),y("div",Kt,[y("button",{class:"flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold rounded-xl transition",onClick:t[7]||(t[7]=e=>i.value=!1)}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),c(n,{to:"/create-request",class:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl transition text-center",onClick:t[8]||(t[8]=e=>i.value=!1)},{default:l(()=>[...t[18]||(t[18]=[T(" ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ° ",-1)])]),_:1})])])])):w("",!0)])}}},[["__scopeId","data-v-3824ffff"]]),Jt={key:0,class:"fixed inset-0 z-[10000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4"},Yt={class:"bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl animate-pulse-slow"},Xt={class:"relative w-32 h-32 mx-auto mb-6"},Qt=["src"],Zt={key:1,class:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center relative z-10 border-4 border-green-500"},en={class:"text-4xl text-white font-bold"},tn={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},nn={class:"text-gray-500 dark:text-gray-400 mb-8 flex items-center justify-center gap-2"},rn={class:"text-2xl"},sn={key:0,class:"fixed inset-0 z-[10000] bg-gradient-to-br from-gray-900 to-black flex flex-col"},on={class:"p-4 text-center"},an={class:"text-green-400 text-sm font-medium mb-1"},cn={class:"text-2xl font-bold text-white"},ln={class:"text-gray-400 text-sm mt-1"},un={class:"flex-1 relative"},dn={key:1,class:"absolute inset-0 flex items-center justify-center"},hn={class:"w-40 h-40 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center border-4 border-white/20"},pn=["src"],fn={key:1,class:"text-5xl text-white font-bold"},gn={class:"p-6 bg-gradient-to-t from-black/80 to-transparent"},mn={class:"flex justify-center gap-4"},vn=Rt({__name:"CallOverlay",setup(t,{expose:o}){var i,d;const h=Tt(),p=e(null),f=e(null),_=e("idle"),k=e(0),E=e(null),S=e(null),C=e(null),A=e(null),x=e(!1===(null==(i=h.user)?void 0:i.default_mic_enabled)),R=e(!1===(null==(d=h.user)?void 0:d.default_camera_enabled)),O=e(!0);let D=null,P=null,N=null,L=[],M=null,j=null,q=null,B=null;const F=async()=>{var e,t;try{if(null==(e=Et.isConnected)?void 0:e.value)return!0;const n=h.token||localStorage.getItem("token")||sessionStorage.getItem("token");return!!n&&(Et.connect(n),await new Promise(e=>setTimeout(e,300)),!!(null==(t=Et.isConnected)?void 0:t.value))}catch(n){return console.warn("WebSocket reconnect failed:",n),!1}},V=()=>{M&&(M.pause(),M.currentTime=0)},$=()=>{q&&(clearInterval(q),q=null),j&&(j.close().catch(()=>{}),j=null,B=null)};s(p,e=>{e?(()=>{try{M||(M=new Audio("/notification.mp3"),M.loop=!0,M.volume=.7),M.currentTime=0,M.play().catch(()=>{})}catch(e){console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ Ð·Ð²ÑƒÐº:",e)}})():V()}),s(_,(e,t)=>{var n;"ringing"===e&&(null==(n=f.value)?void 0:n.isOutgoing)?(()=>{var e;try{B||(B=new(window.AudioContext||window.webkitAudioContext));const t=B;null==(e=t.resume)||e.call(t).catch(()=>{});const n=()=>{const e=t.createOscillator(),n=t.createGain();e.connect(n),n.connect(t.destination),e.frequency.value=440,e.type="sine",n.gain.setValueAtTime(.3,t.currentTime),n.gain.exponentialRampToValueAtTime(.01,t.currentTime+1),e.start(t.currentTime),e.stop(t.currentTime+1)};n(),q=setInterval(n,3e3),j=t}catch(t){console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ Ð³ÑƒÐ´ÐºÐ¸:",t)}})():"ringing"!==t&&"connected"!==e&&"idle"!==e||$()});const U=e=>e?e.charAt(0).toUpperCase():"?",W=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},H=()=>[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:["turn:158.160.210.202:3478?transport=udp","turn:158.160.210.202:3478?transport=tcp"],username:"helpcar",credential:"helpcar2024secure"}],z=async()=>{if(p.value)try{if(!(await F()))return void alert("ÐÐµÑ‚ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð² (WebSocket). ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ.");_.value="connecting";const e={audio:!0,video:"video"===p.value.callType};P=await navigator.mediaDevices.getUserMedia(e);const t=await Q.client.post(`/calls/${p.value.callId}/accept`);t.success&&(f.value={callId:p.value.callId,callType:p.value.callType,isOutgoing:!1},E.value=t.caller,L=t.iceServers||L,p.value=null,await J())}catch(e){console.error("Failed to accept call:",e),ne(),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ñ€Ð¸Ð½ÑÑ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº")}},K=async()=>{if(p.value){try{await Q.client.post(`/calls/${p.value.callId}/end`,{reason:"rejected"})}catch(e){console.error("Failed to reject call:",e)}p.value=null}},G=async()=>{if(f.value){try{await Q.client.post(`/calls/${f.value.callId}/end`,{reason:"ended"})}catch(e){console.error("Failed to end call:",e)}ne()}},J=async()=>{var e;D=new RTCPeerConnection({iceServers:L,iceTransportPolicy:"relay"}),P.getTracks().forEach(e=>{D.addTrack(e,P)}),S.value&&"video"===(null==(e=f.value)?void 0:e.callType)&&(S.value.srcObject=P),D.ontrack=e=>{var t,n,r,s,o;const i=e.streams[0];A.value&&(A.value.srcObject=i,A.value.muted=!O.value,null==(n=(t=A.value).play)||n.call(t).catch(()=>{})),"video"===(null==(r=f.value)?void 0:r.callType)&&C.value&&(C.value.srcObject=i,C.value.muted=!0,null==(o=(s=C.value).play)||o.call(s).catch(()=>{})),_.value="connected",X()},D.onicecandidate=async e=>{e.candidate&&f.value&&await Q.client.post(`/calls/${f.value.callId}/ice-candidate`,{candidate:e.candidate})},D.oniceconnectionstatechange=()=>{console.log("ðŸ§Š ICE state:",D.iceConnectionState),"disconnected"!==D.iceConnectionState&&"failed"!==D.iceConnectionState||ne()},D.onicecandidateerror=e=>{console.warn("ðŸ§Š ICE candidate error:",e)},D.onconnectionstatechange=()=>{console.log("ðŸ”— PC connection state:",D.connectionState)}},Y=async()=>{const e=await D.createOffer();await D.setLocalDescription(e),await Q.client.post(`/calls/${f.value.callId}/sdp`,{sdp:e,type:"offer"})},X=()=>{k.value=0,N=setInterval(()=>{k.value++},1e3)},Z=()=>{x.value=!x.value,P&&P.getAudioTracks().forEach(e=>{e.enabled=!x.value})},ee=()=>{R.value=!R.value,P&&P.getVideoTracks().forEach(e=>{e.enabled=!R.value})},te=()=>{O.value=!O.value,C.value&&(C.value.muted=!O.value),A.value&&(A.value.muted=!O.value)},ne=()=>{V(),$(),N&&(clearInterval(N),N=null),P&&(P.getTracks().forEach(e=>e.stop()),P=null),D&&(D.close(),D=null),f.value=null,_.value="idle",k.value=0,x.value=!1,R.value=!1},re=e=>{p.value=e},se=async e=>{var t;(null==(t=f.value)?void 0:t.callId)===e.callId&&(_.value="connecting")},oe=e=>{var t,n;(null==(t=f.value)?void 0:t.callId)!==e.callId&&(null==(n=p.value)?void 0:n.callId)!==e.callId||(ne(),p.value=null)},ie=e=>{var t,n;(null==(t=f.value)?void 0:t.callId)!==e.callId&&(null==(n=p.value)?void 0:n.callId)!==e.callId||(ne(),p.value=null)},ae=async e=>{D&&e.candidate&&await D.addIceCandidate(new RTCIceCandidate(e.candidate))},ce=async e=>{var t;(null==(t=f.value)?void 0:t.callId)===e.callId&&D&&await(async e=>{await D.setRemoteDescription(new RTCSessionDescription(e));const t=await D.createAnswer();await D.setLocalDescription(t),await Q.client.post(`/calls/${f.value.callId}/sdp`,{sdp:t,type:"answer"})})(e.sdp)},le=async e=>{var t;(null==(t=f.value)?void 0:t.callId)===e.callId&&D&&await D.setRemoteDescription(new RTCSessionDescription(e.sdp))};function ue(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))return e;return"https://help-car.online/api/v1".replace("/api/v1","")+e}function de(e){e.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect fill="%236366f1" width="100" height="100"/><text x="50" y="60" text-anchor="middle" fill="white" font-size="40">?</text></svg>'}return n(async()=>{h.isAuthenticated&&await(async()=>{var e;try{const t=await Q.client.get("/calls/ice-servers"),n=(null==t?void 0:t.data)||t;L=(null==n?void 0:n.iceServers)||(null==(e=null==n?void 0:n.data)?void 0:e.iceServers)||H()}catch(t){console.warn("Failed to load ICE servers, using defaults:",null==t?void 0:t.message),L=H()}})(),await F(),Et.on("call:incoming",re),Et.on("call:accepted",se),Et.on("call:ended",oe),Et.on("call:timeout",ie),Et.on("call:ice-candidate",ae),Et.on("call:offer",ce),Et.on("call:answer",le)}),r(()=>{ne(),V(),$(),Et.off("call:incoming",re),Et.off("call:accepted",se),Et.off("call:ended",oe),Et.off("call:timeout",ie),Et.off("call:ice-candidate",ae),Et.off("call:offer",ce),Et.off("call:answer",le)}),o({initiateCall:async(e,t="audio")=>{try{if(!(await F()))return void alert("ÐÐµÑ‚ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð² (WebSocket). ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ.");_.value="ringing";const n={audio:!0,video:"video"===t};P=await navigator.mediaDevices.getUserMedia(n);const r=await Q.client.post("/calls/initiate",{targetUserId:e,callType:t});r.success&&(f.value={callId:r.callId,callType:t,isOutgoing:!0},E.value=r.callee,L=r.iceServers||L,await J(),await Y())}catch(n){console.error("Failed to initiate call:",n),ne(),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº")}}}),(e,t)=>(m(),a(g,{to:"body"},[c(I,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:l(()=>{var e,n,r;return[p.value?(m(),u("div",Jt,[y("div",Yt,[y("div",Xt,[t[0]||(t[0]=y("div",{class:"absolute inset-0 bg-green-500 rounded-full animate-ping opacity-30"},null,-1)),(null==(e=p.value.caller)?void 0:e.avatar_url)?(m(),u("img",{key:0,src:ue(p.value.caller.avatar_url),class:"w-32 h-32 rounded-full object-cover relative z-10 border-4 border-green-500",onError:de},null,40,Qt)):(m(),u("div",Zt,[y("span",en,b(U(null==(n=p.value.caller)?void 0:n.full_name)),1)]))]),y("h2",tn,b((null==(r=p.value.caller)?void 0:r.full_name)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹"),1),y("p",nn,[y("span",rn,b("video"===p.value.callType?"ðŸ“¹":"ðŸ“ž"),1),T(" "+b("video"===p.value.callType?"Ð’Ð¸Ð´ÐµÐ¾Ð·Ð²Ð¾Ð½Ð¾Ðº":"Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð·Ð²Ð¾Ð½Ð¾Ðº"),1)]),y("div",{class:"flex justify-center gap-6"},[y("button",{onClick:K,class:"w-16 h-16 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center text-white text-2xl shadow-lg transition-all hover:scale-110"}," ðŸ“µ "),y("button",{onClick:z,class:"w-16 h-16 bg-green-500 hover:bg-green-600 rounded-full flex items-center justify-center text-white text-2xl shadow-lg transition-all hover:scale-110 animate-bounce"}," ðŸ“ž ")])])])):w("",!0)]}),_:1}),c(I,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:l(()=>{var e,t,n;return[f.value?(m(),u("div",sn,[y("div",on,[y("p",an,b("connecting"===_.value?"Ð¡Ð¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ...":"Ð—Ð²Ð¾Ð½Ð¾Ðº"),1),y("h2",cn,b(null==(e=E.value)?void 0:e.full_name),1),y("p",ln,b(W(k.value)),1)]),y("div",un,["video"===f.value.callType?(m(),u("video",{key:0,ref_key:"remoteVideoRef",ref:C,autoplay:"",playsinline:"",class:"absolute inset-0 w-full h-full object-cover"},null,512)):w("",!0),y("audio",{ref_key:"remoteAudioRef",ref:A,autoplay:"",playsinline:"",class:"hidden"},null,512),"video"!==f.value.callType?(m(),u("div",dn,[y("div",hn,[(null==(t=E.value)?void 0:t.avatar_url)?(m(),u("img",{key:0,src:ue(E.value.avatar_url),class:"w-full h-full rounded-full object-cover",onError:de},null,40,pn)):(m(),u("span",fn,b(U(null==(n=E.value)?void 0:n.full_name)),1))])])):w("",!0),"video"===f.value.callType?(m(),u("video",{key:2,ref_key:"localVideoRef",ref:S,autoplay:"",playsinline:"",muted:"",class:"absolute bottom-4 right-4 w-32 h-44 rounded-xl object-cover border-2 border-white shadow-xl"},null,512)):w("",!0)]),y("div",gn,[y("div",mn,[y("button",{onClick:Z,class:v(["w-14 h-14 rounded-full flex items-center justify-center text-2xl transition-all",x.value?"bg-red-500 text-white":"bg-white/20 text-white hover:bg-white/30"])},b(x.value?"ðŸ”‡":"ðŸŽ¤"),3),"video"===f.value.callType?(m(),u("button",{key:0,onClick:ee,class:v(["w-14 h-14 rounded-full flex items-center justify-center text-2xl transition-all",R.value?"bg-red-500 text-white":"bg-white/20 text-white hover:bg-white/30"])},b(R.value?"ðŸ“·":"ðŸ“¹"),3)):w("",!0),y("button",{onClick:te,class:v(["w-14 h-14 rounded-full flex items-center justify-center text-2xl transition-all",O.value?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"])},b(O.value?"ðŸ”Š":"ðŸ”ˆ"),3),y("button",{onClick:G,class:"w-14 h-14 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center text-2xl text-white shadow-lg transition-all"}," ðŸ“µ ")])])])):w("",!0)]}),_:1})]))}},[["__scopeId","data-v-d9cb952b"]]),yn={class:"md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-bottom z-[1500] transition-colors duration-200",role:"navigation","aria-label":"ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ð°Ñ Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ"},wn={class:"grid grid-cols-5 h-16"},bn={class:"relative"},_n={key:0,class:"absolute -top-1 -right-1 min-w-[16px] h-4 px-1 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center"},kn=Rt({__name:"BottomNav",setup(e){const n=E(),r=Ct(),s=e=>n.path.startsWith(e),o=t(()=>r.pendingCount||0);return(e,t)=>{const n=S("router-link");return m(),u("nav",yn,[y("div",wn,[c(n,{to:"/dashboard",class:v(["flex flex-col items-center justify-center gap-0.5 text-xs font-semibold transition-colors",s("/dashboard")?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),"active-class":"text-blue-600 dark:text-blue-400"},{default:l(()=>[...t[0]||(t[0]=[y("span",{class:"text-xl"},"ðŸ ",-1),y("span",{class:"text-[10px] sm:text-xs"},"Ð“Ð»Ð°Ð²Ð½Ð°Ñ",-1)])]),_:1},8,["class"]),c(n,{to:"/map",class:v(["flex flex-col items-center justify-center gap-0.5 text-xs font-semibold transition-colors",s("/map")?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),"active-class":"text-blue-600 dark:text-blue-400"},{default:l(()=>[...t[1]||(t[1]=[y("span",{class:"text-xl"},"ðŸ—º",-1),y("span",{class:"text-[10px] sm:text-xs"},"ÐšÐ°Ñ€Ñ‚Ð°",-1)])]),_:1},8,["class"]),c(n,{to:"/create-request",class:"flex flex-col items-center justify-center -mt-6"},{default:l(()=>[...t[2]||(t[2]=[y("div",{class:"w-14 h-14 bg-gradient-to-br from-red-500 to-orange-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform"},[y("span",{class:"text-2xl"},"ðŸ†˜")],-1),y("span",{class:"text-[10px] sm:text-xs font-semibold text-gray-600 dark:text-gray-400 mt-1"},"SOS",-1)])]),_:1}),c(n,{to:"/my-chats",class:v(["flex flex-col items-center justify-center gap-0.5 text-xs font-semibold transition-colors relative",s("/my-chats")||s("/messages")||s("/global-chat")||s("/city-chats")?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"])},{default:l(()=>[y("div",bn,[t[3]||(t[3]=y("span",{class:"text-xl"},"ðŸ’¬",-1)),o.value>0?(m(),u("span",_n,b(o.value>9?"9+":o.value),1)):w("",!0)]),t[4]||(t[4]=y("span",{class:"text-[10px] sm:text-xs"},"Ð§Ð°Ñ‚Ñ‹",-1))]),_:1},8,["class"]),c(n,{to:"/profile",class:v(["flex flex-col items-center justify-center gap-0.5 text-xs font-semibold transition-colors",s("/profile")?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),"active-class":"text-blue-600 dark:text-blue-400"},{default:l(()=>[...t[5]||(t[5]=[y("span",{class:"text-xl"},"ðŸ‘¤",-1),y("span",{class:"text-[10px] sm:text-xs"},"ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ",-1)])]),_:1},8,["class"])])])}}},[["__scopeId","data-v-0f7eb447"]]);var En={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},Sn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],o=s+1<e.length,i=o?e[s+1]:0,a=s+2<e.length,c=a?e[s+2]:0,l=t>>2,u=(3&t)<<4|i>>4;let d=(15&i)<<2|c>>6,h=63&c;a||(h=64,o||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Tn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&o)}else if(s>239&&s<365){const o=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],o=s<e.length?n[e.charAt(s)]:0;++s;const i=s<e.length?n[e.charAt(s)]:64;++s;const a=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==o||null==i||null==a)throw new Cn;const c=t<<2|o>>4;if(r.push(c),64!==i){const e=o<<4&240|i>>2;if(r.push(e),64!==a){const e=i<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Cn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const In=function(e){return function(e){const t=Tn(e);return Sn.encodeByteArray(t,!0)}(e).replace(/\./g,"")};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const An=()=>
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,xn=()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&function(e){try{return Sn.decodeString(e,!0)}catch(n){console.error("base64Decode failed: ",n)}return null}(e[1]);return t&&JSON.parse(t)},Rn=()=>{try{return An()||(()=>{if("undefined"==typeof process)return;const e=En.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||xn()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},On=()=>{var e;return null==(e=Rn())?void 0:e.config};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Dn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Pn(){try{return"object"==typeof indexedDB}catch(e){return!1}}function Nn(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null==(e=s.error)?void 0:e.message)||"")}}catch(n){t(n)}})}class Ln extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mn.prototype.create)}}class Mn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?function(e,t){return e.replace(jn,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(s,n):"Error",i=`${this.serviceName}: ${o} (${r}).`;return new Ln(r,i,n)}}const jn=/\{\$([^}]+)}/g;function qn(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],o=t[s];if(Bn(n)&&Bn(o)){if(!qn(n,o))return!1}else if(n!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bn(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(e){return e&&e._delegate?e._delegate:e}class Vn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Dn;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),n=(null==e?void 0:e.optional)??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:$n})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(e=$n){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=$n){return this.instances.has(e)}getOptions(e=$n){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===$n?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=$n){return this.component?this.component.multipleInstances?e:$n:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Wn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Un(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hn,zn;(zn=Hn||(Hn={}))[zn.DEBUG=0]="DEBUG",zn[zn.VERBOSE=1]="VERBOSE",zn[zn.INFO=2]="INFO",zn[zn.WARN=3]="WARN",zn[zn.ERROR=4]="ERROR",zn[zn.SILENT=5]="SILENT";const Kn={debug:Hn.DEBUG,verbose:Hn.VERBOSE,info:Hn.INFO,warn:Hn.WARN,error:Hn.ERROR,silent:Hn.SILENT},Gn=Hn.INFO,Jn={[Hn.DEBUG]:"log",[Hn.VERBOSE]:"log",[Hn.INFO]:"info",[Hn.WARN]:"warn",[Hn.ERROR]:"error"},Yn=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),s=Jn[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${e.name}:`,...n)};let Xn,Qn;const Zn=new WeakMap,er=new WeakMap,tr=new WeakMap,nr=new WeakMap,rr=new WeakMap;let sr={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return er.get(e);if("objectStoreNames"===t)return e.objectStoreNames||tr.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ar(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function or(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Qn||(Qn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(cr(this),t),ar(Zn.get(this))}:function(...t){return ar(e.apply(cr(this),t))}:function(t,...n){const r=e.call(cr(this),t,...n);return tr.set(r,t.sort?t.sort():[t]),ar(r)}}function ir(e){return"function"==typeof e?or(e):(e instanceof IDBTransaction&&function(e){if(er.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});er.set(e,t)}(e),t=e,(Xn||(Xn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,sr):e);var t}function ar(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{t(ar(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&Zn.set(t,e)}).catch(()=>{}),rr.set(t,e),t}(e);if(nr.has(e))return nr.get(e);const t=ir(e);return t!==e&&(nr.set(e,t),rr.set(t,e)),t}const cr=e=>rr.get(e);function lr(e,t,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(e,t),a=ar(i);return r&&i.addEventListener("upgradeneeded",e=>{r(ar(i.result),e.oldVersion,e.newVersion,ar(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}function ur(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),ar(n).then(()=>{})}const dr=["get","getKey","getAll","getAllKeys","count"],hr=["put","add","delete","clear"],pr=new Map;function fr(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(pr.get(t))return pr.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=hr.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!dr.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,s?"readwrite":"readonly");let i=o.store;return r&&(i=i.index(t.shift())),(await Promise.all([i[n](...t),s&&o.done]))[0]};return pr.set(t,o),o}sr=(e=>({...e,get:(t,n,r)=>fr(t,n)||e.get(t,n,r),has:(t,n)=>!!fr(t,n)||e.has(t,n)}))(sr);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class gr{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const mr="@firebase/app",vr="0.14.6",yr=new class{constructor(e){this.name=e,this._logLevel=Gn,this._logHandler=Yn,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Kn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Hn.DEBUG,...e),this._logHandler(this,Hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Hn.VERBOSE,...e),this._logHandler(this,Hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Hn.INFO,...e),this._logHandler(this,Hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Hn.WARN,...e),this._logHandler(this,Hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Hn.ERROR,...e),this._logHandler(this,Hn.ERROR,...e)}}("@firebase/app"),wr="@firebase/app-compat",br="@firebase/analytics-compat",_r="@firebase/analytics",kr="@firebase/app-check-compat",Er="@firebase/app-check",Tr="@firebase/auth",Sr="@firebase/auth-compat",Cr="@firebase/database",Ir="@firebase/data-connect",Ar="@firebase/database-compat",xr="@firebase/functions",Rr="@firebase/functions-compat",Or="@firebase/installations",Dr="@firebase/installations-compat",Pr="@firebase/messaging",Nr="@firebase/messaging-compat",Lr="@firebase/performance",Mr="@firebase/performance-compat",jr="@firebase/remote-config",qr="@firebase/remote-config-compat",Br="@firebase/storage",Fr="@firebase/storage-compat",Vr="@firebase/firestore",$r="@firebase/ai",Ur="@firebase/firestore-compat",Wr="firebase",Hr="[DEFAULT]",zr={[mr]:"fire-core",[wr]:"fire-core-compat",[_r]:"fire-analytics",[br]:"fire-analytics-compat",[Er]:"fire-app-check",[kr]:"fire-app-check-compat",[Tr]:"fire-auth",[Sr]:"fire-auth-compat",[Cr]:"fire-rtdb",[Ir]:"fire-data-connect",[Ar]:"fire-rtdb-compat",[xr]:"fire-fn",[Rr]:"fire-fn-compat",[Or]:"fire-iid",[Dr]:"fire-iid-compat",[Pr]:"fire-fcm",[Nr]:"fire-fcm-compat",[Lr]:"fire-perf",[Mr]:"fire-perf-compat",[jr]:"fire-rc",[qr]:"fire-rc-compat",[Br]:"fire-gcs",[Fr]:"fire-gcs-compat",[Vr]:"fire-fst",[Ur]:"fire-fst-compat",[$r]:"fire-vertex","fire-js":"fire-js",[Wr]:"fire-js-all"},Kr=new Map,Gr=new Map,Jr=new Map;function Yr(e,t){try{e.container.addComponent(t)}catch(n){yr.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Xr(e){const t=e.name;if(Jr.has(t))return yr.debug(`There were multiple attempts to register component ${t}.`),!1;Jr.set(t,e);for(const n of Kr.values())Yr(n,e);for(const n of Gr.values())Yr(n,e);return!0}function Qr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new Mn("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class es{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Vn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zr.create("app-deleted",{appName:this._name})}}function ts(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r={name:Hr,automaticDataCollectionEnabled:!0,...t},s=r.name;if("string"!=typeof s||!s)throw Zr.create("bad-app-name",{appName:String(s)});if(n||(n=On()),!n)throw Zr.create("no-options");const o=Kr.get(s);if(o){if(qn(n,o.options)&&qn(r,o.config))return o;throw Zr.create("duplicate-app",{appName:s})}const i=new Wn(s);for(const c of Jr.values())i.addComponent(c);const a=new es(n,r,i);return Kr.set(s,a),a}function ns(e,t,n){let r=zr[e]??e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void yr.warn(e.join(" "))}Xr(new Vn(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="firebase-heartbeat-store";let ss=null;function os(){return ss||(ss=lr("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(rs)}catch(n){console.warn(n)}}}).catch(e=>{throw Zr.create("idb-open",{originalErrorMessage:e.message})})),ss}async function is(e,t){try{const n=(await os()).transaction(rs,"readwrite"),r=n.objectStore(rs);await r.put(t,as(e)),await n.done}catch(n){if(n instanceof Ln)yr.warn(n.message);else{const e=Zr.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});yr.warn(e.message)}}}function as(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new us(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ls();if(null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){yr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ls(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),ds(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ds(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=In(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return yr.warn(t),""}}}function ls(){return(new Date).toISOString().substring(0,10)}class us{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Pn()&&Nn().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await os()).transaction(rs),n=await t.objectStore(rs).get(as(e));return await t.done,n}catch(t){if(t instanceof Ln)yr.warn(t.message);else{const e=Zr.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});yr.warn(e.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return is(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return is(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function ds(e){return In(JSON.stringify({version:2,heartbeats:e})).length}var hs;hs="",Xr(new Vn("platform-logger",e=>new gr(e),"PRIVATE")),Xr(new Vn("heartbeat",e=>new cs(e),"PRIVATE")),ns(mr,vr,hs),ns(mr,vr,"esm2020"),ns("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
ns("firebase","12.7.0","app");const ps="@firebase/installations",fs="0.6.19",gs=1e4,ms=`w:${fs}`,vs="FIS_v2",ys=36e5,ws=new Mn("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function bs(e){return e instanceof Ln&&e.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function ks(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Es(e,t){const n=(await t.json()).error;return ws.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Ts({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Ss(e,{refreshToken:t}){const n=Ts(e);return n.append("Authorization",function(e){return`${vs} ${e}`}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)),n}async function Cs(e){const t=await e();return t.status>=500&&t.status<600?e():t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Is(e){return new Promise(t=>{setTimeout(t,e)})}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const As=/^[cdef][\w-]{21}$/;function xs(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e);return As.test(t)?t:""}catch{return""}}function Rs(e){return`${e.appName}!${e.appId}`}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=new Map;function Ds(e,t){const n=Rs(e);Ps(n,t),function(e,t){const n=function(){!Ns&&"BroadcastChannel"in self&&(Ns=new BroadcastChannel("[Firebase] FID Change"),Ns.onmessage=e=>{Ps(e.data.key,e.data.fid)});return Ns}();n&&n.postMessage({key:e,fid:t});0===Os.size&&Ns&&(Ns.close(),Ns=null)}(n,t)}function Ps(e,t){const n=Os.get(e);if(n)for(const r of n)r(t)}let Ns=null;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ls="firebase-installations-store";let Ms=null;function js(){return Ms||(Ms=lr("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ls)}})),Ms}async function qs(e,t){const n=Rs(e),r=(await js()).transaction(Ls,"readwrite"),s=r.objectStore(Ls),o=await s.get(n);return await s.put(t,n),await r.done,o&&o.fid===t.fid||Ds(e,t.fid),t}async function Bs(e){const t=Rs(e),n=(await js()).transaction(Ls,"readwrite");await n.objectStore(Ls).delete(t),await n.done}async function Fs(e,t){const n=Rs(e),r=(await js()).transaction(Ls,"readwrite"),s=r.objectStore(Ls),o=await s.get(n),i=t(o);return void 0===i?await s.delete(n):await s.put(i,n),await r.done,!i||o&&o.fid===i.fid||Ds(e,i.fid),i}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(e){let t;const n=await Fs(e.appConfig,n=>{const r=function(e){const t=e||{fid:xs(),registrationStatus:0};return Ws(t)}(n),s=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(ws.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=_s(e),s=Ts(e),o=t.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const i={fid:n,authVersion:vs,appId:e.appId,sdkVersion:ms},a={method:"POST",headers:s,body:JSON.stringify(i)},c=await Cs(()=>fetch(r,a));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:ks(e.authToken)}}throw await Es("Create Installation",c)}(e,t);return qs(e.appConfig,n)}catch(n){throw bs(n)&&409===n.customData.serverCode?await Bs(e.appConfig):await qs(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:$s(e)}:{installationEntry:t}}(e,r);return t=s.registrationPromise,s.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function $s(e){let t=await Us(e.appConfig);for(;1===t.registrationStatus;)await Is(100),t=await Us(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Vs(e);return n||t}return t}function Us(e){return Fs(e,e=>{if(!e)throw ws.create("installation-not-found");return Ws(e)})}function Ws(e){return 1===(t=e).registrationStatus&&t.registrationTime+gs<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}async function Hs({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${_s(e)}/${t}/authTokens:generate`}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,n),s=Ss(e,n),o=t.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const i={installation:{sdkVersion:ms,appId:e.appId}},a={method:"POST",headers:s,body:JSON.stringify(i)},c=await Cs(()=>fetch(r,a));if(c.ok){return ks(await c.json())}throw await Es("Generate Auth Token",c)}async function zs(e,t=!1){let n;const r=await Fs(e.appConfig,r=>{if(!Gs(r))throw ws.create("not-registered");const s=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ys}(e)}(s))return r;if(1===s.requestStatus)return n=async function(e,t){let n=await Ks(e.appConfig);for(;1===n.authToken.requestStatus;)await Is(100),n=await Ks(e.appConfig);const r=n.authToken;return 0===r.requestStatus?zs(e,t):r}(e,t),r;{if(!navigator.onLine)throw ws.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}(r);return n=async function(e,t){try{const n=await Hs(e,t),r={...t,authToken:n};return await qs(e.appConfig,r),n}catch(n){if(!bs(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n={...t,authToken:{requestStatus:0}};await qs(e.appConfig,n)}else await Bs(e.appConfig);throw n}}(e,t),t}});return n?await n:r.authToken}function Ks(e){return Fs(e,e=>{if(!Gs(e))throw ws.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+gs<Date.now()?{...e,authToken:{requestStatus:0}}:e;var n;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */})}function Gs(e){return void 0!==e&&2===e.registrationStatus}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Js(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await Vs(e);t&&await t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(n);return(await zs(n,t)).token}function Ys(e){return ws.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="installations",Qs=e=>{const t=Qr(e.getProvider("app").getImmediate(),Xs).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Vs(t);return r?r.catch(console.error):zs(t).catch(console.error),n.fid}(t),getToken:e=>Js(t,e)}};Xr(new Vn(Xs,e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Ys("App Configuration");if(!e.name)throw Ys("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Ys(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Qr(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),Xr(new Vn("installations-internal",Qs,"PRIVATE")),ns(ps,fs),ns(ps,fs,"esm2020");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Zs="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",eo="google.c.a.c_id",to=1e4;var no,ro,so;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function oo(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function io(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let s=0;s<n.length;++s)r[s]=n.charCodeAt(s);return r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(ro=no||(no={}))[ro.DATA_MESSAGE=1]="DATA_MESSAGE",ro[ro.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(so||(so={}));const ao="fcm_token_details_db",co="fcm_token_object_Store";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const lo="firebase-messaging-store";let uo=null;function ho(){return uo||(uo=lr("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(lo)}})),uo}async function po(e){const t=go(e),n=await ho(),r=await n.transaction(lo).objectStore(lo).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map(e=>e.name).includes(ao))return null;let t=null;return(await lr(ao,5,{upgrade:async(n,r,s,o)=>{if(r<2)return;if(!n.objectStoreNames.contains(co))return;const i=o.objectStore(co),a=await i.index("fcmSenderId").get(e);if(await i.clear(),a)if(2===r){const e=a;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:e.createTime??Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:oo(e.vapidKey)}}}else if(3===r){const e=a;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:oo(e.auth),p256dh:oo(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:oo(e.vapidKey)}}}else if(4===r){const e=a;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:oo(e.auth),p256dh:oo(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:oo(e.vapidKey)}}}}})).close(),await ur(ao),await ur("fcm_vapid_details_db"),await ur("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await fo(e,t),t}}async function fo(e,t){const n=go(e),r=(await ho()).transaction(lo,"readwrite");return await r.objectStore(lo).put(t,n),await r.done,t}function go({appConfig:e}){return e.appId}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=new Mn("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function vo({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function yo({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function wo({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:t,p256dh:e}};return r!==Zs&&(s.web.applicationPubKey=r),s}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bo(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:io(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:oo(t.getKey("auth")),p256dh:oo(t.getKey("p256dh"))},r=await po(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,s=t.auth===e.auth,o=t.p256dh===e.p256dh;return n&&r&&s&&o}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await yo(e),r=wo(t.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{const n=await fetch(`${vo(e.appConfig)}/${t.token}`,s);o=await n.json()}catch(si){throw mo.create("token-update-failed",{errorInfo:null==si?void 0:si.toString()})}if(o.error){const e=o.error.message;throw mo.create("token-update-failed",{errorInfo:e})}if(!o.token)throw mo.create("token-update-no-token");return o.token}(e.firebaseDependencies,t),r={...t,token:n,createTime:Date.now()};return await fo(e.firebaseDependencies,r),n}catch(n){throw n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await async function(e,t){const n={method:"DELETE",headers:await yo(e)};try{const r=await fetch(`${vo(e.appConfig)}/${t}`,n),s=await r.json();if(s.error){const e=s.error.message;throw mo.create("token-unsubscribe-failed",{errorInfo:e})}}catch(si){throw mo.create("token-unsubscribe-failed",{errorInfo:null==si?void 0:si.toString()})}}(e.firebaseDependencies,r.token)}catch(s){console.warn(s)}return _o(e.firebaseDependencies,n)}return _o(e.firebaseDependencies,n)}async function _o(e,t){const n=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await async function(e,t){const n=await yo(e),r=wo(t),s={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{const t=await fetch(vo(e.appConfig),s);o=await t.json()}catch(si){throw mo.create("token-subscribe-failed",{errorInfo:null==si?void 0:si.toString()})}if(o.error){const e=o.error.message;throw mo.create("token-subscribe-failed",{errorInfo:e})}if(!o.token)throw mo.create("token-subscribe-no-token");return o.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await fo(e,r),r.token}function ko(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const s=t.notification.image;s&&(e.notification.image=s);const o=t.notification.icon;o&&(e.notification.icon=o)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,s,o;if(!t.fcmOptions&&!(null==(n=t.notification)?void 0:n.click_action))return;e.fcmOptions={};const i=(null==(r=t.fcmOptions)?void 0:r.link)??(null==(s=t.notification)?void 0:s.click_action);i&&(e.fcmOptions.link=i);const a=null==(o=t.fcmOptions)?void 0:o.analytics_label;a&&(e.fcmOptions.analyticsLabel=a)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e),t}function Eo(e){return mo.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){if(!e||!e.options)throw Eo("App Configuration Object");if(!e.name)throw Eo("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw Eo(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function So(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch(()=>{}),await async function(e){return new Promise((t,n)=>{const r=setTimeout(()=>n(new Error("Service worker not registered after 10000 ms")),to),s=e.installing||e.waiting;e.active?(clearTimeout(r),t()):s?s.onstatechange=e=>{var n;"activated"===(null==(n=e.target)?void 0:n.state)&&(s.onstatechange=null,clearTimeout(r),t())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.swRegistration)}catch(t){throw mo.create("failed-service-worker-registration",{browserErrorMessage:null==t?void 0:t.message})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Co(e,t){if(!navigator)throw mo.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw mo.create("permission-blocked");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Zs)}(e,null==t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await So(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw mo.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),bo(e)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(e,t,n){const r=function(e){switch(e){case so.NOTIFICATION_CLICKED:return"notification_open";case so.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[eo],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function Ao(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===so.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(ko(n)):e.onMessageHandler.next(ko(n)));const r=n.data;var s;"object"==typeof(s=r)&&s&&eo in s&&"1"===r["google.c.a.e"]&&await Io(e,n.messageType,r)}const xo="@firebase/messaging",Ro="0.12.23",Oo=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>Co(t,e)}};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Do(){try{await Nn()}catch(e){return!1}return"undefined"!=typeof window&&Pn()&&!("undefined"==typeof navigator||!navigator.cookieEnabled)&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Po(e=function(e=Hr){const t=Kr.get(e);if(!t&&e===Hr&&On())return ts();if(!t)throw Zr.create("no-app",{appName:e});return t}()){return Do().then(e=>{if(!e)throw mo.create("unsupported-browser")},e=>{throw mo.create("indexed-db-unsupported")}),Qr(Fn(e),"messaging").getImmediate()}function No(e,t){return function(e,t){if(!navigator)throw mo.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=Fn(e),t)}Xr(new Vn("messaging",e=>{const t=new To(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>Ao(t,e)),t},"PUBLIC")),Xr(new Vn("messaging-internal",Oo,"PRIVATE")),ns(xo,Ro),ns(xo,Ro,"esm2020");const Lo={apiKey:"AIzaSyDGONxwdm9u9lcWDdLg_6xR52Z5TtVh0K0",authDomain:"roadhelp-14383.firebaseapp.com",projectId:"roadhelp-14383",storageBucket:"roadhelp-14383.firebasestorage.app",messagingSenderId:"986564669652",appId:"1:986564669652:web:de12ea4073d02c47c4cb41",measurementId:"G-VCSR2BJPTK"},Mo="BKau2kB8mOdYnoKUQrX3JIzqYENURVe7GVgBIjnWJkDXrFzD16H8wiN2Gsu4Evwoxf8iG69lFy-rTqpOr4zA7jU";let jo=null,qo=null,Bo=!1;function Fo(){if(Bo)return qo;try{jo||(jo=ts(Lo),console.log("âœ… Firebase App initialized")),"serviceWorker"in navigator&&!qo&&(qo=Po(jo),console.log("âœ… Firebase Messaging initialized")),Bo=!0}catch(e){console.warn("âš ï¸ Firebase init error:",e.message)}return qo}async function Vo(){var e,t,n;console.log("ðŸ”¥ getFCMToken() called");const r=Fo();if(!r)return console.warn("âš ï¸ Firebase Messaging not available (msg is null)"),null;console.log("âœ… Firebase Messaging object ready");try{console.log("ðŸ”” Current permission:",Notification.permission);const o=await Notification.requestPermission();if(console.log("ðŸ”” Permission after request:",o),"granted"!==o)return console.log("âŒ Notification permission denied"),null;console.log("âœ… Notification permission granted"),console.log("â³ Registering Firebase Service Worker...");let i=null;try{const n=await navigator.serviceWorker.getRegistrations();for(const r of n)if(null==(t=null==(e=r.active)?void 0:e.scriptURL)?void 0:t.includes("firebase-messaging-sw")){console.log("âœ… Found existing Firebase SW:",r.active.scriptURL),i=r;break}i||(console.log("ðŸ“¡ Registering new Firebase SW..."),i=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),console.log("âœ… Firebase SW registered with scope:",i.scope),await new Promise(e=>setTimeout(e,1e3)))}catch(s){console.error("âŒ Firebase SW registration error:",s),i=await navigator.serviceWorker.ready}console.log("ðŸ“ Final SW for FCM:",(null==(n=null==i?void 0:i.active)?void 0:n.scriptURL)||(null==i?void 0:i.scope)),console.log("ðŸ”‘ Requesting FCM token with VAPID:",Mo.substring(0,20)+"...");const a=await async function(e,t){return Co(e=Fn(e),t)}(r,{vapidKey:Mo,serviceWorkerRegistration:i});return a?(console.log("âœ… FCM Token received:",a.substring(0,30)+"..."),console.log("ðŸ“Š Token length:",a.length),a):(console.log("âš ï¸ No FCM token returned (token is null/empty)"),null)}catch(o){return console.error("âŒ Error getting FCM token:",o),console.error("âŒ Error name:",o.name),console.error("âŒ Error message:",o.message),console.error("âŒ Error stack:",o.stack),null}}function $o(e){const t=Fo();t&&No(t,t=>{if(console.log("ðŸ“© Foreground message received:",t),t.notification){const{title:r,body:s}=t.notification;try{const e=new Audio("/notification.mp3");e.volume=.5,e.play().catch(e=>{0})}catch(n){}"granted"===Notification.permission&&new Notification(r||"RoadHelp",{body:s||"ÐÐ¾Ð²Ð¾Ðµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ",icon:"/icons/icon-192x192.png",badge:"/icons/icon-144x144.png",vibrate:[200,100,200],data:t.data}),e&&e(t)}})}async function Uo(e){console.log("ðŸ“¤ registerTokenWithBackend() called"),console.log("ðŸ”‘ Token to register:",(null==e?void 0:e.substring(0,30))+"...");try{const t=localStorage.getItem("token");if(!t)return console.log("âš ï¸ No auth token in localStorage, skipping FCM registration"),!1;console.log("âœ… Auth token found, length:",t.length),console.log("ðŸš€ Sending POST to /api/v1/users/fcm-token...");const n=await fetch("/api/v1/users/fcm-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({fcm_token:e})});if(console.log("ðŸ“¥ Response status:",n.status),n.ok){const e=await n.json();return console.log("âœ… FCM token registered with backend:",e),!0}{const e=await n.text();return console.warn("âŒ Failed to register FCM token:",n.status,e),!1}}catch(t){return console.error("âŒ Error registering FCM token:",t),console.error("âŒ Error details:",t.message),!1}}async function Wo(){try{const e=await Vo();return!!e&&(await Uo(e),$o(e=>{console.log("Notification payload:",e)}),!0)}catch(e){return console.error("Push notification init error:",e),!1}}const Ho=Object.freeze(Object.defineProperty({__proto__:null,VAPID_KEY:Mo,get app(){return jo},getFCMToken:Vo,initializePushNotifications:Wo,get messaging(){return qo},onForegroundMessage:$o,registerTokenWithBackend:Uo},Symbol.toStringTag,{value:"Module"}));let zo=null;async function Ko(){if(!("Notification"in window))return console.log("Browser does not support notifications"),!1;try{const e=await Notification.requestPermission();if(console.log("ðŸ”” Notification permission result:",e),"granted"===e){console.log("âœ… Notification permission granted");const e=await async function(){var e,t;if(!("serviceWorker"in navigator))return console.warn("Service Workers not supported"),null;try{const n=await navigator.serviceWorker.getRegistrations();for(const s of n)if(null==(t=null==(e=s.active)?void 0:e.scriptURL)?void 0:t.includes("firebase-messaging-sw"))return console.log("âœ… Firebase SW already registered:",s.scope),s;const r=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/"});return console.log("âœ… Firebase SW registered:",r.scope),await navigator.serviceWorker.ready,console.log("âœ… Firebase SW is ready"),r}catch(n){return console.error("Firebase SW registration failed:",n),null}}();console.log("ðŸ“¡ Firebase SW registration:",e?"success":"failed");let t=null;for(let n=1;n<=3;n++)try{if(console.log(`ðŸ”‘ Getting FCM token (attempt ${n}/3)...`),t=await Vo(),t){console.log("âœ… FCM token received:",t.substring(0,40)+"...");break}}catch(si){console.warn(`âš ï¸ FCM token attempt ${n} failed:`,si.message),n<3&&await new Promise(e=>setTimeout(e,1e3))}if(t){zo=t;const e=await Uo(t);console.log("ðŸ“¤ Token registration:",e?"success":"failed"),$o(e=>{console.log("ðŸ“© Message received:",e),Go()}),console.log("âœ… FCM initialized successfully")}else console.warn("âš ï¸ Could not get FCM token after 3 attempts");return!0}return console.log("âš ï¸ Notification permission denied"),!1}catch(e){return console.error("Permission request error:",e),!1}}function Go(){try{const e=new Audio("/notification.mp3");e.volume=.5,e.play().catch(e=>{0})}catch(e){console.warn("Could not play notification sound")}}function Jo(e,t={}){if("Notification"in window)if("granted"===Notification.permission)try{Go(),"serviceWorker"in navigator&&navigator.serviceWorker.controller?navigator.serviceWorker.ready.then(n=>{n.showNotification(e,{body:t.body||"",icon:"/icons/icon-192x192.png",badge:"/icons/icon-144x144.png",vibrate:[200,100,200],tag:t.tag||"notification-"+Date.now(),requireInteraction:t.requireInteraction||!1,data:{url:t.url||"/"},...t})}).catch(()=>{Yo(e,t)}):Yo(e,t)}catch(n){console.warn("Notification error:",n),Yo(e,t)}else"default"===Notification.permission&&Ko().then(n=>{n&&Jo(e,t)});else console.log("Notifications not supported")}function Yo(e,t={}){try{const n=new Notification(e,{body:t.body||"",icon:"/icons/icon-192x192.png",badge:"/icons/icon-144x144.png",vibrate:[200,100,200],...t});n.onclick=e=>{e.preventDefault(),window.focus(),t.url&&(window.location.href=t.url),n.close()},setTimeout(()=>n.close(),5e3)}catch(n){console.warn("Simple notification error:",n)}}const Xo={id:"app",class:"min-h-screen bg-gray-50 dark:bg-slate-800 transition-colors duration-200"},Qo={class:"pb-0 md:pb-0"},Zo=Rt({__name:"App",setup(s){const o=C(),i=Tt(),d=Ct(),h=e(null),p=t(()=>{var e;if(!i.isAuthenticated)return!1;const t=(null==(e=o.currentRoute.value)?void 0:e.path)||"";return!t.startsWith("/chat")&&(!t.startsWith("/direct-chat")&&(!t.startsWith("/global-chat")&&!t.startsWith("/city-chats")))});window.__initiateCall=(e,t="audio")=>{var n;console.log("ðŸ“ž Initiating call via global handler:",e,t),(null==(n=h.value)?void 0:n.initiateCall)?h.value.initiateCall(e,t):(console.error("CallOverlay not available"),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº"))},L(),window.__shareRequestHandlers=[],console.log("âœ… App.vue: __shareRequestHandlers initialized"),window.__handleShareRequest=e=>{if(console.log("ðŸ“¨ Global share handler called:",e),console.log("ðŸ“‹ Handlers count:",window.__shareRequestHandlers.length),"function"==typeof window.__mapViewShareHandler)return console.log("âœ… Using direct MapView handler"),void window.__mapViewShareHandler(e);window.__shareRequestHandlers.length>0?window.__shareRequestHandlers.forEach(t=>{try{t(e)}catch(si){console.error("Handler error:",si)}}):console.warn("âš ï¸ No handlers registered! MapView may not be mounted.")};const f=e=>{var t;const n=null==(t=i.user)?void 0:t.is_available_to_help;console.log("ðŸ”” New request notification:",e,"| is_available_to_help:",n),n?(kt.playNotification(),Jo("ðŸ†˜ ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ° Ñ€ÑÐ´Ð¾Ð¼!",{body:e.description||"ÐšÑ‚Ð¾-Ñ‚Ð¾ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ",url:"/map"})):console.log('â¸ï¸ Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾ - Ñ€ÐµÐ¶Ð¸Ð¼ "Ð“Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÑŒ" Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½')},g=e=>{console.log("ðŸ’¬ New message:",e),kt.playMessage()},v=e=>{console.log("ðŸ‘‹ New response:",e),kt.playNotification(),Jo("ðŸ‘‹ ÐÐ¾Ð²Ñ‹Ð¹ Ð¾Ñ‚ÐºÐ»Ð¸Ðº!",{body:e.helperName||"ÐšÑ‚Ð¾-Ñ‚Ð¾ Ð³Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ",url:"/my-requests"})},b=e=>{console.log("âœ… Response accepted:",e),kt.playSuccess(),Jo("âœ… Ð’Ð°Ñˆ Ð¾Ñ‚ÐºÐ»Ð¸Ðº Ð¿Ñ€Ð¸Ð½ÑÑ‚!",{body:"Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ñ‡Ð°Ñ‚",url:"/my-responses"})},_=e=>{console.log("ðŸ‘¥ Friend online:",e),kt.play("message")},k=e=>{var t;const n=null==(t=i.user)?void 0:t.is_available_to_help;console.log("ðŸ”” Friend request nearby:",e,"| is_available_to_help:",n),n?(kt.playNotification(),Jo("ðŸ‘¥ Ð’Ð°Ñˆ Ð´Ñ€ÑƒÐ³ ÑÐ¾Ð·Ð´Ð°Ð» Ð·Ð°ÑÐ²ÐºÑƒ!",{body:e.message||"Ð”Ñ€ÑƒÐ³ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ñ€ÑÐ´Ð¾Ð¼",url:"/map"})):console.log('â¸ï¸ Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾ - Ñ€ÐµÐ¶Ð¸Ð¼ "Ð“Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÑŒ" Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½')},E=e=>{var t;console.log("ðŸ“¨ Request shared:",e),d.addInvitation(e),kt.playNotification(),Jo(`ðŸ‘¥ ${(null==(t=e.sender)?void 0:t.name)||"Ð”Ñ€ÑƒÐ³"} Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐ°ÐµÑ‚ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ!`,{body:e.message||`Ð—Ð°ÑÐ²ÐºÐ°: ${e.description||"ÐÑƒÐ¶Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ"}`,url:"/messages"})},T=e=>{var t;console.log("ðŸ‘¥ Friend request received:",e),kt.playNotification(),Jo("ðŸ‘¥ Ð—Ð°ÑÐ²ÐºÐ° Ð² Ð´Ñ€ÑƒÐ·ÑŒÑ",{body:`${(null==(t=e.sender)?void 0:t.full_name)||"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ"} Ñ…Ð¾Ñ‡ÐµÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ð°Ñ Ð² Ð´Ñ€ÑƒÐ·ÑŒÑ`,url:"/profile"})};return n(()=>{const e=localStorage.getItem("token")||sessionStorage.getItem("token"),t=localStorage.getItem("rememberMe");try{i.checkAuth()}catch(n){}if(e&&(console.log("âœ… ÐÐ°Ð¹Ð´ÐµÐ½ ÑÐ¾Ñ…Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ"),Wo().then(e=>{console.log("ðŸ”” Push notifications:",e?"enabled":"not available")}).catch(e=>{console.warn("Push init error:",e)}),"true"===t)){const e=window.location.pathname;"/login"!==e&&"/register"!==e&&"/"!==e||o.push("/map")}Et.on("helpRequest:new",f),Et.on("helpRequest:created",f),Et.on("chat:message",g),Et.on("message:new",g),Et.on("response:new",v),Et.on("response:created",v),Et.on("response_accepted",b),Et.on("friend_online",_),Et.on("friend_request_nearby",k),Et.on("friend_request_received",T),Et.on("request:shared",E),console.log("ðŸ”Š Sound notifications enabled")}),r(()=>{Et.off("helpRequest:new",f),Et.off("helpRequest:created",f),Et.off("chat:message",g),Et.off("message:new",g),Et.off("response:new",v),Et.off("response:created",v),Et.off("response_accepted",b),Et.off("friend_online",_),Et.off("friend_request_nearby",k),Et.off("friend_request_received",T),Et.off("request:shared",E)}),(e,t)=>{const n=S("router-view");return m(),u("div",Xo,[y("div",Qo,[c(n,null,{default:l(({Component:e})=>[c(I,{name:"fade",mode:"out-in"},{default:l(()=>[(m(),a(A(e)))]),_:2},1024)]),_:1})]),c(jt),c(Gt),c(vn,{ref_key:"callOverlayRef",ref:h},null,512),p.value?(m(),a(kn,{key:0})):w("",!0)])}}},[["__scopeId","data-v-a07b413a"]]),ei=x({history:R("/"),routes:[{path:"/",name:"home",component:()=>j(()=>import("./HomeView-DfMcr8gw-v1766842044731.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))},{path:"/global-chat",name:"global-chat",component:()=>j(()=>import("./GlobalChatView-DBko2dUT-v1766842044731.js"),__vite__mapDeps([8,1,9,10,11,12,13,14,6,3,15])),meta:{requiresAuth:!1}},{path:"/test",name:"test",component:()=>j(()=>import("./TestView-DSwXPiox-v1766842044731.js"),__vite__mapDeps([16,1]))},{path:"/diagnostics",name:"diagnostics",component:()=>j(()=>import("./SystemDiagnostics-D6ftuT94-v1766842044731.js"),__vite__mapDeps([17,1,18])),meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:()=>j(()=>import("./AdminLogin-Bg1pj5LS-v1766842044731.js"),__vite__mapDeps([19,1,18,6,3]))},{path:"/admin/dashboard",name:"admin-dashboard",component:()=>j(()=>import("./AdminDashboard-_ncy1Euy-v1766842044731.js"),__vite__mapDeps([20,1,6,3])),meta:{requiresAdmin:!0}},{path:"/admin/super",name:"super-admin",component:()=>j(()=>import("./SuperAdminPanel-D44e9Q8O-v1766842044731.js"),__vite__mapDeps([21,1,6,3])),meta:{requiresAdmin:!0}},{path:"/admin/errors",name:"admin-errors",component:()=>j(()=>import("./ErrorLogView-DJEb8OV2-v1766842044731.js"),__vite__mapDeps([22,1])),meta:{requiresAdmin:!0}},{path:"/admin/backups",name:"admin-backups",component:()=>j(()=>import("./BackupView-D0KyQ6tC-v1766842044731.js"),__vite__mapDeps([23,1,6,3])),meta:{requiresAdmin:!0}},{path:"/admin/logs",name:"admin-logs",component:()=>j(()=>import("./AdminLogsView-ZhjTZt5N-v1766842044731.js"),__vite__mapDeps([24,1,6,3])),meta:{requiresAdmin:!0}},{path:"/admin/analytics",name:"admin-analytics",component:()=>j(()=>import("./AdminAnalyticsView-BMGosBOr-v1766842044731.js"),__vite__mapDeps([25,1])),meta:{requiresAdmin:!0}},{path:"/admin/users",name:"admin-users",component:()=>j(()=>import("./AdminUsersView-Bg3GObqt-v1766842044731.js"),__vite__mapDeps([26,1,6,3])),meta:{requiresAdmin:!0}},{path:"/login",name:"login",component:()=>j(()=>import("./LoginView-D82m9kOj-v1766842044731.js"),__vite__mapDeps([27,1,28,6,3]))},{path:"/register",name:"register",component:()=>j(()=>import("./RegisterView-Bpn64R1i-v1766842044731.js"),__vite__mapDeps([29,1,6,3]))},{path:"/forgot-password",name:"forgot-password",component:()=>j(()=>import("./ForgotPasswordView-CMUo9X9G-v1766842044731.js"),__vite__mapDeps([30,1,28,6,3]))},{path:"/reset-password",name:"reset-password",component:()=>j(()=>import("./ResetPasswordView-CrLKiDbQ-v1766842044731.js"),__vite__mapDeps([31,1,28,6,3]))},{path:"/email-verified",name:"email-verified",component:()=>j(()=>import("./EmailVerifiedView-Dc8EHQBF-v1766842044731.js"),__vite__mapDeps([32,1]))},{path:"/map",name:"map",component:()=>j(()=>import("./MapView-B60KvkrJ-v1766842044731.js"),__vite__mapDeps([33,1,9,10,5,6,3,2,4,34]))},{path:"/dashboard",name:"dashboard",component:()=>j(()=>import("./DashboardView-Cm2YotoY-v1766842044731.js"),__vite__mapDeps([35,1,9,10,6,3])),meta:{requiresAuth:!0}},{path:"/create-request",name:"create-request",component:()=>j(()=>import("./CreateRequestView-Bwx43bKa-v1766842044731.js"),__vite__mapDeps([36,1,9,10,6,3,37])),meta:{requiresAuth:!0}},{path:"/my-requests",name:"my-requests",component:()=>j(()=>import("./MyRequestsView-B_CNaUJI-v1766842044731.js"),__vite__mapDeps([38,1,9,10,5,6,3])),meta:{requiresAuth:!0}},{path:"/my-helps",name:"my-helps",component:()=>j(()=>import("./MyHelpersView-SIkl2ztk-v1766842044731.js"),__vite__mapDeps([39,1,9,10,5,6,3])),meta:{requiresAuth:!0}},{path:"/my-responses",name:"my-responses",component:()=>j(()=>import("./MyResponsesView-CeS9zNgc-v1766842044731.js"),__vite__mapDeps([40,1,9,10,5,6,3])),meta:{requiresAuth:!0}},{path:"/chats",redirect:"/my-chats"},{path:"/my-chats",name:"my-chats",component:()=>j(()=>import("./MyChatsView-O8EYKPgt-v1766842044731.js"),__vite__mapDeps([41,1,9,10,11,12,6,3,42])),meta:{requiresAuth:!0}},{path:"/responses/:requestId",name:"responses",component:()=>j(()=>import("./ResponsesView-DOnno6Lr-v1766842044731.js"),__vite__mapDeps([43,1,9,10,5,6,3])),meta:{requiresAuth:!0}},{path:"/chat/:requestId",name:"chat",component:()=>j(()=>import("./UnifiedChatView-CShTf4a9-v1766842044731.js"),__vite__mapDeps([44,1,11,12,13,14,6,3,45])),props:{chatType:"request"},meta:{requiresAuth:!0}},{path:"/profile",name:"profile",component:()=>j(()=>import("./ProfileView-xBtuHVGz-v1766842044731.js"),__vite__mapDeps([46,1,9,10,6,3,47])),meta:{requiresAuth:!0}},{path:"/friends",name:"friends",component:()=>j(()=>import("./FriendsView-DcUOCFZ8-v1766842044731.js"),__vite__mapDeps([48,1,6,3])),meta:{requiresAuth:!0}},{path:"/city-chats",name:"city-chats",component:()=>j(()=>import("./CityChatsView-DiP7p-gN-v1766842044731.js"),__vite__mapDeps([49,1,9,10,11,12,6,3,50])),meta:{requiresAuth:!0}},{path:"/user/:id",name:"public-profile",component:()=>j(()=>import("./PublicProfileView-BUUNAVfk-v1766842044731.js"),__vite__mapDeps([51,1,9,10,6,3]))},{path:"/direct-chat/:chatId",name:"direct-chat",component:()=>j(()=>import("./UnifiedChatView-CShTf4a9-v1766842044731.js"),__vite__mapDeps([44,1,11,12,13,14,6,3,45])),props:{chatType:"direct"},meta:{requiresAuth:!0}},{path:"/messages",name:"messages",component:()=>j(()=>import("./MessagesView-Df-rtwB7-v1766842044731.js"),__vite__mapDeps([52,1,9,10,11,12,6,3])),meta:{requiresAuth:!0}},{path:"/favorites",name:"favorites",component:()=>j(()=>import("./FavoritesView-Bz_Ykq61-v1766842044731.js"),__vite__mapDeps([53,1,9,10,6,3])),meta:{requiresAuth:!0}},{path:"/notifications",name:"notifications",component:()=>j(()=>import("./NotificationsView-CyVKRcWd-v1766842044731.js"),__vite__mapDeps([54,1,9,10,6,3])),meta:{requiresAuth:!0}},{path:"/admin/terminal",name:"admin-terminal",component:()=>j(()=>import("./AdminTerminal-DoXOn3HW-v1766842044731.js"),__vite__mapDeps([55,1])),meta:{requiresAdmin:!0}},{path:"/admin/requests",name:"admin-requests",component:()=>j(()=>import("./AdminRequestsView-6hwKgPey-v1766842044731.js"),__vite__mapDeps([56,1])),meta:{requiresAdmin:!0}},{path:"/admin/settings",name:"admin-settings",component:()=>j(()=>import("./AdminSettingsView-C_NBXNFl-v1766842044731.js"),__vite__mapDeps([57,1])),meta:{requiresAdmin:!0}},{path:"/admin/bulk",name:"admin-bulk",component:()=>j(()=>import("./AdminBulkOperations-DCJWbaq7-v1766842044731.js"),__vite__mapDeps([58,1])),meta:{requiresAdmin:!0}},{path:"/admin/chats-moderation",name:"admin-chats-moderation",component:()=>j(()=>import("./AdminChatModeration-BMtyuOF9-v1766842044731.js"),__vite__mapDeps([59,1])),meta:{requiresAdmin:!0}},{path:"/admin/finance",name:"admin-finance",component:()=>j(()=>import("./AdminFinance-CvXCvnTL-v1766842044731.js"),__vite__mapDeps([60,1])),meta:{requiresAdmin:!0}},{path:"/admin/notifications",name:"admin-notifications",component:()=>j(()=>import("./AdminNotifications-CuunyNBv-v1766842044731.js"),__vite__mapDeps([61,1])),meta:{requiresAdmin:!0}},{path:"/admin/roles",name:"admin-roles",component:()=>j(()=>import("./AdminRoles-C7GaBMfZ-v1766842044731.js"),__vite__mapDeps([62,1])),meta:{requiresAdmin:!0}}]});ei.beforeEach((e,t,n)=>{const r=Tt(),s=localStorage.getItem("token"),o=localStorage.getItem("adminToken"),i=r.isAuthenticated||!!s,a=!!o;e.meta.requiresAuth&&!i?e.path.startsWith("/responses/")?n({path:"/login",query:{redirect:e.fullPath}}):n("/login"):e.meta.requiresAdmin&&!a?n("/admin/login"):"/"===e.path&&i||"/login"===e.path&&i?n("/dashboard"):"/admin/login"===e.path&&a?n("/admin/dashboard"):n()});const ti=new class{constructor(){this.apiBase="/api/v1"}async logError(e,t={}){try{const r={level:"error",message:e.message||String(e),stack:e.stack||null,source:t.source||"frontend",category:t.category||"unknown",url:"undefined"!=typeof window?window.location.href:null,user_agent:"undefined"!=typeof navigator?navigator.userAgent:null,extra_data:{...t,timestamp:(new Date).toISOString()}};try{const e=JSON.parse(localStorage.getItem("user")||"{}");e.id&&(r.user_id=e.id)}catch(n){}fetch(`${this.apiBase}/admin/errors/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).catch(()=>{}),console.error("Error logged:",e,t)}catch(n){console.error("Failed to log error:",e,n)}}async logMessage(e,t="info",n={}){try{const r={level:t,message:String(e),source:n.source||"frontend",category:n.category||"info",url:"undefined"!=typeof window?window.location.href:null,user_agent:"undefined"!=typeof navigator?navigator.userAgent:null,extra_data:{...n,timestamp:(new Date).toISOString()}};fetch(`${this.apiBase}/admin/errors/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).catch(()=>{}),"error"===t?console.error(e,n):"warning"===t?console.warn(e,n):console.log(e,n)}catch(r){console.error("Failed to log message:",e,r)}}};const ni=new class{log(...e){console.log(...e)}info(...e){console.info(...e)}warn(...e){console.warn(...e)}error(...e){console.error(...e)}debug(...e){console.debug(...e)}table(...e){}group(e){}groupEnd(){}};"undefined"!=typeof window&&(window.addEventListener("error",e=>{ni.error("Global error:",e.error),e.error?ti.logError(e.error,{source:"frontend",category:"GlobalError",filename:e.filename,lineno:e.lineno,colno:e.colno}):e.message&&ti.logError(new Error(e.message),{source:"frontend",category:"GlobalError",filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{ni.error("Unhandled promise rejection:",e.reason),e.reason instanceof Error?ti.logError(e.reason,{source:"frontend",category:"UnhandledRejection"}):ti.logError(new Error(String(e.reason)),{source:"frontend",category:"UnhandledRejection",reason:e.reason})}));const ri=O(Zo);if(ri.use(D()),ri.use(ei),ri.config.errorHandler=(e,t,n)=>{var r;const s=(null==e?void 0:e.message)||(null==e?void 0:e.toString())||"Unknown Vue error",o=(null==e?void 0:e.stack)||"";ni.error("Vue error:",{message:s,stack:o,error:e,info:n}),ti.logError(e instanceof Error?e:new Error(s),{source:"frontend",category:"VueError",component:(null==(r=null==t?void 0:t.$options)?void 0:r.name)||"Unknown",info:n}),console.error("Vue Runtime Error:",s,n)},ri.config.warnHandler=(e,t,n)=>{ni.warn("Vue warning:",e,"Trace:",n)},"serviceWorker"in navigator){window.addEventListener("load",()=>{fetch("/service-worker.js",{method:"HEAD",cache:"no-store"}).then(e=>{if(!e.ok)throw new Error(`Service Worker Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½: ${e.status} ${e.statusText}`);return navigator.serviceWorker.register("/service-worker.js",{updateViaCache:"none",scope:"/"})}).then(e=>{console.log("âœ… Service Worker registered:",e.scope);const t=setInterval(()=>{e.update().catch(e=>{console.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Service Worker:",e)})},6e4);e.addEventListener("updatefound",()=>{const n=e.installing;n&&(n.addEventListener("error",e=>{console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Service Worker:",e)}),n.addEventListener("statechange",()=>{console.log(`ðŸ”„ Service Worker state changed: ${n.state}`),"installed"===n.state&&navigator.serviceWorker.controller?(console.log("ðŸ”„ ÐÐ¾Ð²Ñ‹Ð¹ Service Worker ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..."),clearInterval(t),window.location.reload()):"activated"===n.state?console.log("âœ… ÐÐ¾Ð²Ñ‹Ð¹ Service Worker Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½"):"redundant"===n.state&&console.warn("âš ï¸ Service Worker ÑÑ‚Ð°Ð» Ð¸Ð·Ð±Ñ‹Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¼ (redundant)")}))}),navigator.serviceWorker.addEventListener("message",e=>{e.data&&"SW_UPDATED"===e.data.type&&(console.log("ðŸ”„ Service Worker Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½ Ð´Ð¾ Ð²ÐµÑ€ÑÐ¸Ð¸:",e.data.version),window.location.reload()),!e.data||"MODULE_404"!==e.data.type&&"MODULE_ERROR"!==e.data.type||(console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¼Ð¾Ð´ÑƒÐ»Ñ:",e.data.url),ni.warn("âš ï¸ ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½, Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÐºÐµÑˆ Ð¸ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼..."),"caches"in window?caches.keys().then(e=>Promise.all(e.map(e=>(console.log("ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÐºÐµÑˆ:",e),caches.delete(e))))).then(()=>{navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_CACHE"}),setTimeout(()=>{window.location.reload(!0)},500)}).catch(e=>{console.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐµ ÐºÐµÑˆÐ°:",e),setTimeout(()=>{window.location.reload(!0)},500)}):window.location.reload(!0)),e.data&&"CACHE_CLEARED"===e.data.type&&console.log("âœ… ÐšÐµÑˆ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½")})}).catch(e=>{console.error("âŒ Service Worker registration failed:",e),e.message&&e.message.includes("Failed to update")&&(console.log("ðŸ”„ ÐŸÑ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð¾Ñ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Service Worker..."),navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(e=>(console.log("ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€ÑƒÑŽ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ:",e.scope),e.unregister())))).then(()=>{console.log("âœ… Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ..."),setTimeout(()=>{window.location.reload()},1e3)}).catch(e=>{console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¹:",e)}))})});let e=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,console.log("ðŸ”„ Service Worker ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»ÑÑ, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..."),window.location.reload())})}"undefined"!=typeof window&&(window.addEventListener("error",e=>{e.message&&e.message.includes("Failed to fetch dynamically imported module")&&(ni.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¼Ð¾Ð´ÑƒÐ»Ñ, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ..."),"caches"in window?caches.keys().then(e=>Promise.all(e.map(e=>(console.log("ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÐºÐµÑˆ:",e),caches.delete(e))))).then(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_CACHE"}),setTimeout(()=>{window.location.reload(!0)},500)}).catch(e=>{console.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐµ ÐºÐµÑˆÐ° (error handler):",e),setTimeout(()=>{window.location.reload(!0)},500)}):("serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_CACHE"}),setTimeout(()=>{window.location.reload(!0)},1e3)))}),window.addEventListener("unhandledrejection",e=>{if(e.reason&&e.reason.message&&e.reason.message.includes("Failed to fetch dynamically imported module"))return ni.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¼Ð¾Ð´ÑƒÐ»Ñ (promise rejection), Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ..."),e.preventDefault(),void("caches"in window?caches.keys().then(e=>Promise.all(e.map(e=>(console.log("ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÐºÐµÑˆ:",e),caches.delete(e))))).then(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_CACHE"}),setTimeout(()=>{window.location.reload(!0)},500)}).catch(e=>{console.warn("âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐµ ÐºÐµÑˆÐ° (unhandledrejection):",e),setTimeout(()=>{window.location.reload(!0)},500)}):("serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_CACHE"}),setTimeout(()=>{window.location.reload(!0)},1e3)));const t=e.reason instanceof Error?e.reason:new Error(String(e.reason||"Unhandled promise rejection"));ni.error("Unhandled promise rejection:",t),e.preventDefault()})),ri.mount("#app");export{Rt as _,Q as a,ni as b,j as c,xt as d,L as e,Ct as f,St as g,_t as l,Ko as r,kt as s,Tt as u,Et as w};
