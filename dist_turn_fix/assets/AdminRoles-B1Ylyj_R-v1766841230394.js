import{r as e,o as a,h as t,l,m as s,F as n,i as o,t as i,I as r,J as d,L as m,p as u,y as p,k as c,n as x}from"./vendor-mW7CftnD-v1766841230394.js";const v={class:"min-h-screen bg-gray-100"},g={class:"bg-white shadow-lg"},y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},f={class:"flex justify-between h-16"},b={class:"flex items-center"},h={class:"max-w-7xl mx-auto py-6 px-4"},w={class:"bg-white rounded-lg shadow overflow-hidden mb-6"},_={class:"min-w-full"},k={class:"divide-y"},C={class:"px-6 py-4"},E={class:"px-6 py-4"},S={class:"px-6 py-4"},T={class:"px-6 py-4 text-sm"},U={class:"px-6 py-4"},$=["onClick"],j=["onClick"],D={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},A={class:"font-bold mb-2"},L={class:"text-sm text-gray-800 font-medium mb-4"},z={class:"space-y-2"},F={class:"mt-6 bg-white rounded-lg shadow p-6"},I={class:"space-y-2 max-h-96 overflow-y-auto"},V={class:"text-gray-700"},B={class:"flex-1 mx-4"},R={class:"font-bold mb-4"},q={class:"space-y-4"},J={class:"mt-6 flex gap-2"},O={__name:"AdminRoles",setup(O){p();const P=e([]),N=e(!1),G=e(null),H=e({full_name:"",email:"",password:"",role:"admin"}),K=e([]),M=[{value:"super_admin",name:"üëë –°—É–ø–µ—Ä-–ê–¥–º–∏–Ω",description:"–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º",permissions:["all"]},{value:"admin",name:"üîß –ê–¥–º–∏–Ω",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∑–∞—è–≤–∫–∞–º–∏",permissions:["user_management","request_management","view_stats"]},{value:"moderator",name:"üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä",description:"–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞",permissions:["chat_moderation","view_reports"]}],Q=e=>({super_admin:"–°—É–ø–µ—Ä-–ê–¥–º–∏–Ω",admin:"–ê–¥–º–∏–Ω",moderator:"–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä"}[e]||e),W=e=>({all:"–í—Å–µ –ø—Ä–∞–≤–∞",user_management:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",request_management:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏",view_stats:"–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏",chat_moderation:"–ú–æ–¥–µ—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤",view_reports:"–ü—Ä–æ—Å–º–æ—Ç—Ä –∂–∞–ª–æ–±"}[e]||e),X=async()=>{try{const e=localStorage.getItem("adminToken"),a=await fetch("/api/v1/admin/admins",{headers:{Authorization:`Bearer ${e}`}});if(!a.ok){if(404===a.status)return void(P.value=[{id:1,full_name:"Super Administrator",email:"admin@help-car.online",role:"super_admin",last_login:new Date}]);throw new Error("Failed")}const t=await a.json();P.value=t.admins||[]}catch(e){console.error("Load admins error:",e)}},Y=()=>{G.value=null,H.value={full_name:"",email:"",password:"",role:"admin"},N.value=!0},Z=async()=>{try{const e=localStorage.getItem("adminToken"),a=G.value?"PUT":"POST",t=G.value?`/api/v1/admin/admins/${G.value.id}`:"/api/v1/admin/admins",l=await fetch(t,{method:a,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(H.value)});if(!l.ok&&404!==l.status)throw new Error("Failed");alert("‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!"),N.value=!1,await X()}catch(e){alert("–û—à–∏–±–∫–∞: "+e.message)}};return a(()=>{X(),K.value=[{id:1,timestamp:new Date,admin:"admin",action:"–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",details:"user@example.com",level:"info"},{id:2,timestamp:new Date,admin:"moderator",action:"—É–¥–∞–ª–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ",details:"—Å–ø–∞–º",level:"warning"}]}),(e,a)=>(c(),t("div",v,[l("nav",g,[l("div",y,[l("div",f,[l("div",b,[l("button",{class:"text-blue-600 hover:text-blue-800 font-medium mr-4",onClick:a[0]||(a[0]=a=>e.$router.push("/admin/dashboard"))}," ‚Üê –î–∞—à–±–æ—Ä–¥ "),a[8]||(a[8]=l("h1",{class:"text-xl font-bold"}," üëë –†–æ–ª–∏ –∏ –ü—Ä–∞–≤–∞ ",-1))]),l("button",{class:"bg-blue-600 text-white px-4 py-2 rounded",onClick:Y}," ‚ûï –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∞ ")])])]),l("div",h,[l("div",w,[a[10]||(a[10]=l("div",{class:"p-4 border-b"},[l("h3",{class:"font-bold"}," üë• –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã ")],-1)),l("table",_,[a[9]||(a[9]=l("thead",{class:"bg-gray-50"},[l("tr",null,[l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –ò–º—è "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," Email "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –†–æ–ª—å "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –î–µ–π—Å—Ç–≤–∏—è ")])],-1)),l("tbody",k,[(c(!0),t(n,null,o(P.value,e=>{return c(),t("tr",{key:e.id},[l("td",C,i(e.full_name),1),l("td",E,i(e.email),1),l("td",S,[l("span",{class:x([(a=e.role,{super_admin:"bg-red-100 text-red-800",admin:"bg-blue-100 text-blue-800",moderator:"bg-green-100 text-green-800"}[a]||"bg-gray-100 text-gray-800"),"px-2 py-1 rounded text-xs"])},i(Q(e.role)),3)]),l("td",T,i(e.last_login?new Date(e.last_login).toLocaleString("ru-RU"):"–ù–∏–∫–æ–≥–¥–∞"),1),l("td",U,[l("button",{class:"text-blue-600 hover:text-blue-800 mr-2",onClick:a=>(e=>{G.value=e,H.value={...e},N.value=!0})(e)}," ‚úèÔ∏è ",8,$),"super_admin"!==e.role?(c(),t("button",{key:0,class:"text-red-600 hover:text-red-800",onClick:a=>(async e=>{if(confirm(`–£–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∞ ${e.full_name}?`))try{const a=localStorage.getItem("adminToken"),t=await fetch(`/api/v1/admin/admins/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!t.ok&&404!==t.status)throw new Error("Failed");alert("‚úÖ –£–¥–∞–ª–µ–Ω–æ!"),await X()}catch(a){alert("–û—à–∏–±–∫–∞: "+a.message)}})(e)}," üóëÔ∏è ",8,j)):s("",!0)])]);var a}),128))])])]),l("div",D,[(c(),t(n,null,o(M,e=>l("div",{key:e.value,class:"bg-white rounded-lg shadow p-6"},[l("h3",A,i(e.name),1),l("p",L,i(e.description),1),l("div",z,[(c(!0),t(n,null,o(e.permissions,e=>(c(),t("div",{key:e,class:"text-sm flex items-center gap-2"},[a[11]||(a[11]=l("span",{class:"text-green-600"},"‚úì",-1)),l("span",null,i(W(e)),1)]))),128))])])),64))]),l("div",F,[a[12]||(a[12]=l("h3",{class:"font-bold mb-4"}," üìú –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–æ–≤ ",-1)),l("div",I,[(c(!0),t(n,null,o(K.value,e=>(c(),t("div",{key:e.id,class:"flex items-center justify-between border-b pb-2 text-sm"},[l("span",V,i(new Date(e.timestamp).toLocaleString("ru-RU")),1),l("span",B,i(e.admin)+" "+i(e.action),1),l("span",{class:x("warning"===e.level?"text-yellow-600":"text-gray-800 font-medium")},i(e.details),3)]))),128))])])]),N.value?(c(),t("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:a[7]||(a[7]=e=>N.value=!1)},[l("div",{class:"bg-white rounded-lg p-6 max-w-md w-full mx-4",onClick:a[6]||(a[6]=u(()=>{},["stop"]))},[l("h3",R,i(G.value?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å":"–°–æ–∑–¥–∞—Ç—å")+" –∞–¥–º–∏–Ω–∞ ",1),l("div",q,[r(l("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>H.value.full_name=e),placeholder:"–ü–æ–ª–Ω–æ–µ –∏–º—è",class:"w-full px-3 py-2 border rounded"},null,512),[[d,H.value.full_name]]),r(l("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>H.value.email=e),type:"email",placeholder:"Email",class:"w-full px-3 py-2 border rounded"},null,512),[[d,H.value.email]]),G.value?s("",!0):r((c(),t("input",{key:0,"onUpdate:modelValue":a[3]||(a[3]=e=>H.value.password=e),type:"password",placeholder:"–ü–∞—Ä–æ–ª—å",class:"w-full px-3 py-2 border rounded"},null,512)),[[d,H.value.password]]),r(l("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>H.value.role=e),class:"w-full px-3 py-2 border rounded"},[...a[13]||(a[13]=[l("option",{value:"admin"}," –ê–¥–º–∏–Ω ",-1),l("option",{value:"moderator"}," –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä ",-1),l("option",{value:"super_admin"}," –°—É–ø–µ—Ä-–ê–¥–º–∏–Ω ",-1)])],512),[[m,H.value.role]])]),l("div",J,[l("button",{class:"flex-1 bg-blue-600 text-white px-4 py-2 rounded",onClick:Z}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å "),l("button",{class:"flex-1 bg-gray-600 text-white px-4 py-2 rounded",onClick:a[5]||(a[5]=e=>N.value=!1)}," –û—Ç–º–µ–Ω–∞ ")])])])):s("",!0)]))}};export{O as default};
