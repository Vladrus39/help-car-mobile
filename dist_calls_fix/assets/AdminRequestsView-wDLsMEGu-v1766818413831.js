import{r as e,c as t,o as s,h as l,l as a,m as o,y as n,t as r,I as i,J as u,L as d,G as p,F as c,i as x,v,n as g,p as m,k as y}from"./vendor-mW7CftnD-v1766818413831.js";const b={class:"min-h-screen bg-gray-100"},h={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},f={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},w={class:"bg-blue-50 p-4 rounded-lg"},k={class:"text-2xl font-bold text-blue-900"},C={class:"bg-green-50 p-4 rounded-lg"},_={class:"text-2xl font-bold text-green-900"},L={class:"bg-yellow-50 p-4 rounded-lg"},U={class:"text-2xl font-bold text-yellow-900"},j={class:"bg-purple-50 p-4 rounded-lg"},q={class:"text-2xl font-bold text-purple-900"},D={class:"bg-red-50 p-4 rounded-lg"},$={class:"text-2xl font-bold text-red-900"},E={class:"bg-white rounded-lg shadow p-4 mb-6"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},T={class:"bg-white rounded-lg shadow overflow-hidden"},V={class:"min-w-full divide-y divide-gray-200"},z={class:"bg-white divide-y divide-gray-200"},A={class:"px-6 py-4 whitespace-nowrap text-sm"},R={class:"px-6 py-4 whitespace-nowrap text-sm"},S={class:"px-6 py-4 text-sm max-w-xs truncate"},B={class:"px-6 py-4 text-sm max-w-xs truncate"},F={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},G={class:"px-6 py-4 whitespace-nowrap text-sm"},H={class:"px-6 py-4 whitespace-nowrap text-sm"},J={class:"px-6 py-4 whitespace-nowrap text-sm"},P={class:"flex space-x-2"},K=["onClick"],M=["onClick"],N=["onClick"],O={key:0,class:"text-center py-12 text-gray-700"},Q={class:"space-y-3"},W={key:0},X={class:"mt-6 flex justify-end space-x-2"},Y={__name:"AdminRequestsView",setup(Y){const Z=n(),ee=e([]),te=e(""),se=e(""),le=e(""),ae=e(null),oe=e(!1),ne=()=>Z.push("/admin/dashboard"),re=()=>localStorage.getItem("adminToken"),ie=t(()=>{let e=[...ee.value];if(te.value){const t=te.value.toLowerCase();e=e.filter(e=>e.description.toLowerCase().includes(t)||e.address.toLowerCase().includes(t))}return se.value&&(e=e.filter(e=>e.status===se.value)),le.value&&(e=e.filter(e=>e.problem_type===le.value)),e}),ue=t(()=>ee.value.filter(e=>"active"===e.status).length),de=t(()=>ee.value.filter(e=>"in_progress"===e.status).length),pe=t(()=>ee.value.filter(e=>"completed"===e.status).length),ce=t(()=>ee.value.filter(e=>"cancelled"===e.status).length),xe=e=>({battery:"üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä",fuel:"‚õΩ –ë–µ–Ω–∑–∏–Ω",tire:"üîß –ö–æ–ª–µ—Å–æ",towing:"üöõ –≠–≤–∞–∫—É–∞—Ü–∏—è",other:"‚ùì –î—Ä—É–≥–æ–µ"}[e]||e),ve=e=>({active:"–ê–∫—Ç–∏–≤–Ω–∞",in_progress:"–í –ø—Ä–æ—Ü–µ—Å—Å–µ",completed:"–ó–∞–≤–µ—Ä—à–µ–Ω–∞",cancelled:"–û—Ç–º–µ–Ω–µ–Ω–∞"}[e]||e),ge=e=>({active:"bg-green-100 text-green-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"),me=async()=>{try{const e=re();if(!e)return void Z.push("/admin/login");const t=await fetch("/api/v1/admin/requests",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok){if(401===t.status)return void Z.push("/admin/login");throw new Error(`HTTP ${t.status}`)}const s=await t.json();s.success&&(ee.value=s.requests||[])}catch(e){console.error("Load requests error:",e),alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫")}},ye=()=>{te.value="",se.value="",le.value=""};return s(()=>{me()}),(e,t)=>(y(),l("div",b,[a("nav",{class:"bg-white shadow-lg"},[a("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[a("div",{class:"flex justify-between h-16"},[a("div",{class:"flex items-center space-x-4"},[a("button",{class:"text-blue-600 hover:text-blue-800 font-medium",onClick:ne}," ‚Üê –î–∞—à–±–æ—Ä–¥ "),t[6]||(t[6]=a("h1",{class:"text-xl font-bold text-gray-900"}," üöó –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ó–∞—è–≤–∫–∞–º–∏ ",-1))]),a("div",{class:"flex items-center space-x-4"},[a("button",{class:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700",onClick:me}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å ")])])])]),a("div",h,[a("div",f,[a("div",w,[t[7]||(t[7]=a("h3",{class:"text-sm font-medium text-blue-800"}," –í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫ ",-1)),a("p",k,r(ee.value.length),1)]),a("div",C,[t[8]||(t[8]=a("h3",{class:"text-sm font-medium text-green-800"}," –ê–∫—Ç–∏–≤–Ω—ã—Ö ",-1)),a("p",_,r(ue.value),1)]),a("div",L,[t[9]||(t[9]=a("h3",{class:"text-sm font-medium text-yellow-800"}," –í –ø—Ä–æ—Ü–µ—Å—Å–µ ",-1)),a("p",U,r(de.value),1)]),a("div",j,[t[10]||(t[10]=a("h3",{class:"text-sm font-medium text-purple-800"}," –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö ",-1)),a("p",q,r(pe.value),1)]),a("div",D,[t[11]||(t[11]=a("h3",{class:"text-sm font-medium text-red-800"}," –û—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö ",-1)),a("p",$,r(ce.value),1)])]),a("div",E,[a("div",I,[i(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>te.value=e),type:"text",placeholder:"–ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é, –∞–¥—Ä–µ—Å—É...",class:"px-3 py-2 border border-gray-300 rounded-md"},null,512),[[u,te.value]]),i(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>se.value=e),class:"px-3 py-2 border border-gray-300 rounded-md"},[...t[12]||(t[12]=[p('<option value=""> –í—Å–µ —Å—Ç–∞—Ç—É—Å—ã </option><option value="active"> –ê–∫—Ç–∏–≤–Ω—ã–µ </option><option value="in_progress"> –í –ø—Ä–æ—Ü–µ—Å—Å–µ </option><option value="completed"> –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ </option><option value="cancelled"> –û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ </option>',5)])],512),[[d,se.value]]),i(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>le.value=e),class:"px-3 py-2 border border-gray-300 rounded-md"},[...t[13]||(t[13]=[p('<option value=""> –í—Å–µ —Ç–∏–ø—ã </option><option value="battery"> –†–∞–∑—Ä—è–¥–∏–ª—Å—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä </option><option value="fuel"> –ó–∞–∫–æ–Ω—á–∏–ª—Å—è –±–µ–Ω–∑–∏–Ω </option><option value="tire"> –ü—Ä–æ–∫–æ–ª –∫–æ–ª–µ—Å–∞ </option><option value="towing"> –≠–≤–∞–∫—É–∞—Ü–∏—è </option><option value="other"> –î—Ä—É–≥–æ–µ </option>',6)])],512),[[d,le.value]]),a("button",{class:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",onClick:ye}," üîÑ –°–±—Ä–æ—Å–∏—Ç—å ")])]),a("div",T,[a("table",V,[t[14]||(t[14]=a("thead",{class:"bg-gray-50"},[a("tr",null,[a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," ID "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –¢–∏–ø "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –û–ø–∏—Å–∞–Ω–∏–µ "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –ê–¥—Ä–µ—Å "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –°—É–º–º–∞ "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –°—Ç–∞—Ç—É—Å "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –î–∞—Ç–∞ "),a("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase"}," –î–µ–π—Å—Ç–≤–∏—è ")])],-1)),a("tbody",z,[(y(!0),l(c,null,x(ie.value,e=>(y(),l("tr",{key:e.id},[a("td",A,r(e.id.substring(0,8))+"... ",1),a("td",R,r(xe(e.problem_type)),1),a("td",S,r(e.description),1),a("td",B,r(e.address),1),a("td",F,r(e.amount)+" ‚ÇΩ ",1),a("td",G,[a("span",{class:g([ge(e.status),"px-2 py-1 rounded text-xs font-medium"])},r(ve(e.status)),3)]),a("td",H,r(new Date(e.created_at).toLocaleDateString("ru-RU")),1),a("td",J,[a("div",P,[a("button",{class:"text-blue-600 hover:text-blue-800",title:"–ü—Ä–æ—Å–º–æ—Ç—Ä",onClick:t=>(e=>{ae.value=e,oe.value=!0})(e)}," üëÅÔ∏è ",8,K),a("button",{class:"text-green-600 hover:text-green-800",title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å",onClick:t=>(e=>{Z.push(`/admin/requests/${e.id}/edit`)})(e)}," ‚úèÔ∏è ",8,M),a("button",{class:"text-red-600 hover:text-red-800",title:"–£–¥–∞–ª–∏—Ç—å",onClick:t=>(async e=>{if(confirm(`–£–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É "${e.description.substring(0,50)}..."?`))try{const t=re(),s=await fetch(`/api/v1/admin/requests/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è");(await s.json()).success&&(alert("‚úÖ –ó–∞—è–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞"),await me())}catch(t){alert("–û—à–∏–±–∫–∞: "+t.message)}})(e)}," üóëÔ∏è ",8,N)])])]))),128))])]),0===ie.value.length?(y(),l("div",O," –ó–∞—è–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ")):o("",!0)])]),oe.value&&ae.value?(y(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[5]||(t[5]=e=>oe.value=!1)},[a("div",{class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto",onClick:t[4]||(t[4]=m(()=>{},["stop"]))},[t[25]||(t[25]=a("h2",{class:"text-xl font-bold mb-4"}," üìã –î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏ ",-1)),a("div",Q,[a("div",null,[t[15]||(t[15]=a("strong",null,"ID:",-1)),v(" "+r(ae.value.id),1)]),a("div",null,[t[16]||(t[16]=a("strong",null,"–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã:",-1)),v(" "+r(xe(ae.value.problem_type)),1)]),a("div",null,[t[17]||(t[17]=a("strong",null,"–û–ø–∏—Å–∞–Ω–∏–µ:",-1)),v(" "+r(ae.value.description),1)]),a("div",null,[t[18]||(t[18]=a("strong",null,"–ê–¥—Ä–µ—Å:",-1)),v(" "+r(ae.value.address),1)]),a("div",null,[t[19]||(t[19]=a("strong",null,"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:",-1)),v(" "+r(ae.value.latitude)+", "+r(ae.value.longitude),1)]),a("div",null,[t[20]||(t[20]=a("strong",null,"–°—É–º–º–∞:",-1)),v(" "+r(ae.value.amount)+" ‚ÇΩ",1)]),a("div",null,[t[21]||(t[21]=a("strong",null,"–°—Ç–∞—Ç—É—Å:",-1)),t[22]||(t[22]=v()),a("span",{class:g([ge(ae.value.status),"px-2 py-1 rounded text-xs"])},r(ve(ae.value.status)),3)]),a("div",null,[t[23]||(t[23]=a("strong",null,"–°–æ–∑–¥–∞–Ω–∞:",-1)),v(" "+r(new Date(ae.value.created_at).toLocaleString("ru-RU")),1)]),ae.value.User?(y(),l("div",W,[t[24]||(t[24]=a("strong",null,"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:",-1)),v(" "+r(ae.value.User.full_name)+" ("+r(ae.value.User.email)+") ",1)])):o("",!0)]),a("div",X,[a("button",{class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",onClick:t[3]||(t[3]=e=>oe.value=!1)}," –ó–∞–∫—Ä—ã—Ç—å ")])])])):o("",!0)]))}};export{Y as default};
