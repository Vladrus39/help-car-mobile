import{r as e,o as a,a as t,w as l,H as r,h as s,l as n,m as o,f as i,g as u,x as d,t as c,v,e as g,F as b,i as m,G as f,T as h,p as y,I as p,J as x,K as w,n as k,k as _}from"./vendor-mW7CftnD-v1766818413831.js";import{_ as j,u as C,a as I,l as M}from"./index-05yRke8F-v1766818413831.js";import{_ as S}from"./NavigationHeader-iqVP4xtF-v1766818413831.js";import{P as T}from"./PremiumBadge-2YlFf32N-v1766818413831.js";import{L as $}from"./LinkPreview-CS7BzT29-v1766818413831.js";import"./utils-3YOAKp3O-v1766818413831.js";import"./maps-CCq-KL9W-v1766818413831.js";const z={class:"h-screen flex flex-col overflow-hidden chat-view-container bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800"},L={class:"flex-shrink-0"},B={class:"flex-1 flex flex-col max-w-5xl mx-auto w-full px-4 py-4 sm:py-6 overflow-hidden"},E={class:"mb-4 sm:mb-6 flex-shrink-0"},H={class:"flex items-center gap-2 text-xs sm:text-sm mb-2"},R={class:"flex items-center justify-between gap-4"},U={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},D={class:"flex items-center gap-2"},V={key:0,class:"flex items-center gap-1 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-bold rounded-full"},F={class:"flex-1 bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden flex flex-col min-h-0"},G={key:0,class:"space-y-4"},N={key:1,class:"flex items-center justify-center h-full py-12"},O={key:0,class:"w-10 h-10 rounded-full overflow-hidden ring-2 ring-transparent group-hover/avatar:ring-blue-400 transition"},P=["src"],A={key:1,class:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm ring-2 ring-transparent group-hover/avatar:ring-blue-400 transition"},W={key:0,class:"flex items-center gap-2 mb-1 ml-1"},J={key:0,class:"text-xs text-yellow-500"},K={key:0,class:"mb-2"},q=["src","alt","onClick"],Q={key:1,class:"mb-2"},X=["onClick"],Y={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},Z={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},ee={class:"flex-1"},ae={class:"flex items-center gap-2"},te=["id"],le=["src","onEnded","onTimeupdate"],re={key:2,class:"text-sm sm:text-base whitespace-pre-wrap leading-relaxed"},se={class:"text-gray-400"},ne={key:3,class:"flex gap-3"},oe={key:1,class:"p-4 sm:p-6 border-t-2 border-gray-100 dark:border-gray-700 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20"},ie={class:"text-center"},ue={class:"flex justify-center gap-3"},de={key:2,class:"p-4 sm:p-6 border-t-2 border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-800"},ce={key:0,class:"mb-3 flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"},ve={class:"text-red-600 dark:text-red-400 font-medium"},ge={key:1,class:"mb-3 relative inline-block"},be=["src"],me={key:0,class:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center"},fe=["disabled"],he={class:"flex-1 relative"},ye=["onKeydown"],pe={class:"relative"},xe={key:0,class:"absolute bottom-12 right-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 p-3 z-50 w-72"},we={class:"grid grid-cols-8 gap-1 max-h-48 overflow-y-auto"},ke=["onClick"],_e=["disabled"],je={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ce={key:1,class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},Ie=["src"],Me=j({__name:"GlobalChatView",setup(j){const Me=C(),Se=e(null),Te=e(null),$e=e([]),ze=e(""),Le=e(!0),Be=e(!1),Ee=e(!1),He=e(!1),Re=e(0),Ue=e(null),De=e(null),Ve=e(null),Fe=e(null),Ge=e(null),Ne=e(!1),Oe=e(null),Pe=e(!1),Ae=e(!1),We=e(0),Je=e(null),Ke=e([]),qe=e(null),Qe={};let Xe=null;const Ye=["ğŸ˜€","ğŸ˜ƒ","ğŸ˜„","ğŸ˜","ğŸ˜†","ğŸ˜…","ğŸ¤£","ğŸ˜‚","ğŸ™‚","ğŸ˜‰","ğŸ˜Š","ğŸ˜‡","ğŸ¥°","ğŸ˜","ğŸ¤©","ğŸ˜˜","ğŸ˜—","ğŸ˜š","ğŸ˜™","ğŸ¥²","ğŸ¤—","ğŸ¤”","ğŸ¤­","ğŸ¤«","ğŸ¤¬","ğŸ˜¢","ğŸ˜­","ğŸ˜¤","ğŸ˜ ","ğŸ˜¡","ğŸ¤¯","ğŸ˜³","ğŸ¥µ","ğŸ¥¶","ğŸ˜±","ğŸ˜¨","ğŸ‘","ğŸ‘","ğŸ‘Œ","âœŒï¸","ğŸ¤","ğŸ¤™","ğŸ‘Š","â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ–¤","ğŸ”¥","â­","ğŸ‰","ğŸš—","ğŸš•","ğŸš™","ğŸšŒ","ğŸ› ï¸","ğŸ”§","â›½","ğŸ“±","ğŸ’»","ğŸ ","ğŸ“","âœ…","âŒ"];let Ze=null,ea=null;function aa(e){var a,t;const l=String((null==(a=Se.value)?void 0:a.id)||""),r=String((null==(t=e.sender)?void 0:t.id)||e.sender_id||"");return l&&r&&l===r}function ta(e){if(!e)return[];const a=e.match(/https?:\/\/[^\s<>"{}|\\^`[\]]+/gi)||[];return[...new Set(a.map(e=>e.replace(/[.,;:!?)]+$/,"")))].slice(0,2)}function la(){var e;null==(e=Ve.value)||e.click()}function ra(e){var a;const t=null==(a=e.target.files)?void 0:a[0];if(!t)return;["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(t.type)?t.size>10485760?alert("ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ: 10 ĞœĞ‘"):(Fe.value=t,Ge.value=URL.createObjectURL(t)):alert("ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ: JPEG, PNG, WebP, GIF")}function sa(){Ge.value&&URL.revokeObjectURL(Ge.value),Fe.value=null,Ge.value=null,Ve.value&&(Ve.value.value="")}async function na(){var e;if(!ze.value.trim()&&!Fe.value||!(null==(e=Te.value)?void 0:e.id)||Be.value)return;const a=ze.value.trim(),t=Fe.value;ze.value="",sa();const l="temp-"+Date.now(),s={id:l,content:a,sender:Se.value,created_at:(new Date).toISOString(),is_sending:!0,image_url:t?Ge.value:null};$e.value.push(s),await r(),ua();try{Be.value=!0;let e=null,r=null;if(t){Ne.value=!0;try{const a=await I.uploadChatImage(t);a.success&&(e=a.image_url,r=a.thumbnail_url)}finally{Ne.value=!1}}const s=await I.client.post(`/global-chats/${Te.value.id}/messages`,{content:a||"",image_url:e,thumbnail_url:r}),n=$e.value.findIndex(e=>e.id===l);if(-1!==n){const e=(null==s?void 0:s.data)||s;$e.value[n]={...e,sender:Se.value}}}catch(n){console.error("Failed to send message:",n);const e=$e.value.findIndex(e=>e.id===l);-1!==e&&($e.value[e].is_failed=!0,$e.value[e].is_sending=!1)}finally{Be.value=!1}}function oa(){var e;Ze&&(null==(e=Te.value)?void 0:e.id)&&Ze.emit("global_chat:typing",{globalChatId:Te.value.id})}function ia(){if(!Ue.value)return;const{scrollTop:e,scrollHeight:a,clientHeight:t}=Ue.value;He.value=a-e-t>200}function ua(e=!1){Ue.value&&setTimeout(()=>{Ue.value&&(Ue.value.scrollTop=Ue.value.scrollHeight,He.value=!1)},e?100:50)}function da(e,a){var t,l;return!a||(null==(t=a.sender)?void 0:t.id)!==(null==(l=e.sender)?void 0:l.id)}function ca(e){if(!e)return"";const a=new Date(e);if(isNaN(a.getTime()))return"";const t=new Date,l=t-a,r=Math.floor(l/6e4);return r<1?"ÑĞµĞ¹Ñ‡Ğ°Ñ":r<60?`${r} Ğ¼Ğ¸Ğ½ Ğ½Ğ°Ğ·Ğ°Ğ´`:a.toDateString()===t.toDateString()?a.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}function va(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))return e;return"https://help-car.online/api/v1".replace("/api/v1","")+e}function ga(e){console.warn("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:",e.target.src),e.target.style.display="none"}async function ba(){try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});Je.value=new MediaRecorder(e,{mimeType:"audio/webm"}),Ke.value=[],Je.value.ondataavailable=e=>{Ke.value.push(e.data)},Je.value.onstop=async()=>{const a=new Blob(Ke.value,{type:"audio/webm"});await async function(e){var a;if(!(null==(a=Te.value)?void 0:a.id)||0===Ke.value.length)return;try{Be.value=!0;const a=await I.uploadVoiceMessage(e,We.value);if(a.success){const e=await I.client.post(`/chats/${Te.value.id}/messages`,{content:"",voice_url:a.voice_url,voice_duration:a.duration});(null==e?void 0:e.success)&&(null==e?void 0:e.data)&&($e.value.push({...e.data,sender:Se.value,created_at:e.data.createdAt||e.data.created_at}),await r(),ua())}}catch(t){console.error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ³Ğ¾:",t)}finally{Be.value=!1,We.value=0}}(a),e.getTracks().forEach(e=>e.stop())},Je.value.start(),Ae.value=!0,We.value=0,Xe=setInterval(()=>{We.value++},1e3)}catch(e){console.error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ñƒ:",e),alert("ĞĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ñƒ")}}function ma(){Je.value&&Ae.value&&(Je.value.stop(),Ae.value=!1,clearInterval(Xe))}function fa(){Je.value&&Ae.value&&(Je.value.stop(),Ae.value=!1,clearInterval(Xe),Ke.value=[])}function ha(e){console.warn("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ°ÑƒĞ´Ğ¸Ğ¾:",e.target.src);const a=e.target.parentElement;a&&(a.innerHTML='<span class="text-xs text-red-500">âœ– ĞÑƒĞ´Ğ¸Ğ¾ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾</span>')}return a(async()=>{var e;Me.user||await Me.checkAuth(),Se.value=Me.user||JSON.parse(localStorage.getItem("user")||"null"),await async function(){var e;try{Le.value=!0;const a=await I.joinGlobalChat();(null==a?void 0:a.success)&&(null==a?void 0:a.data)?Te.value=a.data:a&&(Te.value=a),(null==(e=Te.value)?void 0:e.id)&&await async function(){var e,a;if(!(null==(e=Te.value)?void 0:e.id))return;try{const e=await I.getGlobalChatMessages(Te.value.id,{limit:100,offset:0});let t=[];(null==e?void 0:e.success)&&(null==(a=null==e?void 0:e.data)?void 0:a.messages)?t=e.data.messages:(null==e?void 0:e.messages)?t=e.messages:Array.isArray(e)&&(t=e),$e.value=t.map(e=>({...e,created_at:e.created_at||e.createdAt})),await r(),ua(!0)}catch(t){console.error("Failed to load messages:",t)}}()}catch(a){console.error("Failed to join global chat:",a),Te.value={id:"demo",name:"ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ‡Ğ°Ñ‚",participants_count:0,messages_count:0}}finally{Le.value=!1}}(),function(){const e=localStorage.getItem("token");if(!e)return;const a="https:"===window.location.protocol?`wss://${window.location.host}`:`ws://${window.location.host}`;Ze=M(a.replace(/^ws/,"http"),{auth:{token:e}}),Ze.on("connect",()=>{var e;(null==(e=Te.value)?void 0:e.id)&&Ze.emit("global_chat:join",{globalChatId:Te.value.id})}),Ze.on("global_chat:newMessage",e=>{if(null==e?void 0:e.message){if(aa(e.message)){const a=$e.value.findIndex(a=>{var t,l;return(null==(l=null==(t=a.id)?void 0:t.startsWith)?void 0:l.call(t,"temp-"))&&a.content===e.message.content});return void(-1!==a&&($e.value[a]={...e.message,is_sending:!1}))}$e.value.some(a=>a.id===e.message.id)||($e.value.push(e.message),r(()=>ua()))}}),Ze.on("global_chat:typing",e=>{var a;e.userId!==(null==(a=Se.value)?void 0:a.id)&&(Ee.value=!0,ea&&clearTimeout(ea),ea=setTimeout(()=>{Ee.value=!1},2e3))}),Ze.on("global_chat:onlineCount",e=>{Re.value=e})}(),null==(e=De.value)||e.focus()}),t(()=>{Ze&&Ze.disconnect(),ea&&clearTimeout(ea)}),l(ze,()=>{r(()=>{De.value&&(De.value.style.height="auto",De.value.style.height=Math.min(De.value.scrollHeight,128)+"px")})}),(e,a)=>{const t=d("router-link");return _(),s("div",z,[n("div",L,[i(S)]),n("div",B,[n("div",E,[n("div",H,[i(t,{to:"/",class:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-semibold"},{default:u(()=>[...a[5]||(a[5]=[v(" ğŸ  Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ",-1)])]),_:1}),a[6]||(a[6]=n("span",{class:"text-gray-400"},"/",-1)),a[7]||(a[7]=n("span",{class:"text-gray-600 dark:text-gray-300 font-semibold"},"ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ‡Ğ°Ñ‚",-1))]),n("div",R,[n("div",null,[a[8]||(a[8]=n("h1",{class:"text-2xl sm:text-3xl font-black text-gray-900 dark:text-white"}," ğŸŒ ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ‡Ğ°Ñ‚ ",-1)),Te.value?(_(),s("p",U," ğŸ‘¥ "+c(Te.value.participants_count||0)+" ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ² â€¢ ğŸ’¬ "+c(Te.value.messages_count||0)+" ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ ",1)):o("",!0)]),n("div",D,[Re.value>0?(_(),s("span",V,[a[9]||(a[9]=n("span",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},null,-1)),v(" "+c(Re.value)+" Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½ ",1)])):o("",!0),i(t,{to:"/city-chats",class:"px-3 py-1.5 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm font-semibold rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition"},{default:u(()=>[...a[10]||(a[10]=[v(" ğŸ™ï¸ Ğ“Ğ¾Ñ€Ğ¾Ğ´ÑĞºĞ¸Ğµ ",-1)])]),_:1})])])]),n("div",F,[n("div",{ref_key:"messagesContainer",ref:Ue,class:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-4 bg-gradient-to-b from-gray-50 to-white dark:from-gray-900 dark:to-gray-800",onScroll:ia},[Le.value?(_(),s("div",G,[(_(),s(b,null,m(8,e=>n("div",{key:"s"+e,class:"flex gap-3 animate-pulse"},[...a[11]||(a[11]=[n("div",{class:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex-shrink-0"},null,-1),n("div",{class:"flex-1 space-y-2"},[n("div",{class:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),n("div",{class:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})],-1)])])),64))])):0===$e.value.length?(_(),s("div",N,[...a[12]||(a[12]=[f('<div class="text-center" data-v-9d9c7b84><div class="w-24 h-24 mx-auto mb-4 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-full flex items-center justify-center" data-v-9d9c7b84><span class="text-5xl animate-bounce" data-v-9d9c7b84>ğŸ’¬</span></div><h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2" data-v-9d9c7b84> ĞŸĞ¾ĞºĞ° Ğ¿ÑƒÑÑ‚Ğ¾ </h3><p class="text-gray-500 dark:text-gray-400" data-v-9d9c7b84> Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼, ĞºÑ‚Ğ¾ Ğ½Ğ°Ğ¿Ğ¸ÑˆĞµÑ‚! </p></div>',1)])])):(_(),g(h,{key:2,name:"message"},{default:u(()=>[(_(!0),s(b,null,m($e.value,(e,l)=>{var r,d,f,h,y;return _(),s("div",{key:e.id,class:k(["flex gap-3 group",aa(e)?"flex-row-reverse":""])},[aa(e)?o("",!0):(_(),g(t,{key:0,to:`/user/${null==(r=e.sender)?void 0:r.id}`,class:"flex-shrink-0 group/avatar"},{default:u(()=>{var a,t,l,r;return[(null==(a=e.sender)?void 0:a.avatar_url)?(_(),s("div",O,[n("img",{src:(r=e.sender.avatar_url,va(r)),class:"w-full h-full object-cover"},null,8,P)])):(_(),s("div",A,c((l=null==(t=e.sender)?void 0:t.full_name,l?l.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?")),1))]}),_:2},1032,["to"])),n("div",{class:k(["max-w-[75%] sm:max-w-[65%]",aa(e)?"items-end":"items-start"])},[!aa(e)&&da(e,$e.value[l-1])?(_(),s("div",W,[i(t,{to:`/user/${null==(d=e.sender)?void 0:d.id}`,class:"text-sm font-bold text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition"},{default:u(()=>{var a;return[v(c((null==(a=e.sender)?void 0:a.full_name)||"ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ"),1)]}),_:2},1032,["to"]),i(T,{status:null==(f=e.sender)?void 0:f.premium_status,size:"xs"},null,8,["status"]),(null==(h=e.sender)?void 0:h.rating)?(_(),s("span",J," â­ "+c(parseFloat(e.sender.rating||5).toFixed(1)),1)):o("",!0)])):o("",!0),n("div",{class:k(["px-4 py-3 rounded-2xl break-words transition-all shadow-sm",aa(e)?"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-br-md":"bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-100 dark:border-gray-600 rounded-bl-md"])},[e.image_url?(_(),s("div",K,[n("img",{src:va(e.thumbnail_url||e.image_url),alt:e.content||"Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ",class:"max-w-full rounded-xl cursor-pointer hover:opacity-90 transition",style:{"max-height":"300px","object-fit":"contain"},onClick:a=>{return t=e.image_url,void(Oe.value=t);var t},onError:ga},null,40,q)])):o("",!0),e.voice_url?(_(),s("div",Q,[n("div",{class:k(["flex items-center gap-3 p-2 rounded-xl",aa(e)?"bg-white/20":"bg-gray-100 dark:bg-gray-600"])},[n("button",{type:"button",onClick:a=>function(e){const a=Qe[e];a&&(Object.entries(Qe).forEach(([a,t])=>{a===e||t.paused||(t.pause(),t.currentTime=0)}),qe.value===e?(a.pause(),qe.value=null):(a.play().catch(e=>{console.error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾:",e)}),qe.value=e))}(e.id),class:k(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition",aa(e)?"bg-white/30 hover:bg-white/40 text-white":"bg-blue-500 hover:bg-blue-600 text-white"])},[qe.value!==e.id?(_(),s("svg",Y,[...a[13]||(a[13]=[n("path",{d:"M8 5v14l11-7z"},null,-1)])])):(_(),s("svg",Z,[...a[14]||(a[14]=[n("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)])]))],10,X),n("div",ee,[n("div",ae,[n("div",{class:k(["flex-1 h-1 rounded-full",aa(e)?"bg-white/30":"bg-gray-300 dark:bg-gray-500"])},[n("div",{class:"h-full rounded-full bg-current w-0",id:`voice-progress-${e.id}`},null,8,te)],2),n("span",{class:k(["text-xs",aa(e)?"text-white/70":"text-gray-500 dark:text-gray-400"])},c((y=e.voice_duration,y?`${Math.floor(y/60)}:${Math.floor(y%60).toString().padStart(2,"0")}`:"0:00")),3)])]),n("audio",{ref_for:!0,ref:a=>{a&&(Qe[e.id]=a)},src:va(e.voice_url),onEnded:a=>function(e){qe.value=null;const a=document.getElementById(`voice-progress-${e}`);a&&(a.style.width="0%")}(e.id),onTimeupdate:a=>function(e,a){const t=a.target,l=t.currentTime/t.duration*100,r=document.getElementById(`voice-progress-${e}`);r&&(r.style.width=`${l}%`)}(e.id,a),onError:ha,class:"hidden"},null,40,le)],2)])):o("",!0),e.content?(_(),s("p",re,c(e.content),1)):o("",!0),(_(!0),s(b,null,m(ta(e.content),e=>(_(),g($,{key:e,url:e},null,8,["url"]))),128))],2),n("div",{class:k(["flex items-center gap-1.5 mt-1 text-xs",aa(e)?"justify-end mr-1":"ml-1"])},[n("span",se,c(ca(e.created_at)),1),aa(e)?(_(),s("span",{key:0,class:k(e.is_read?"text-blue-500":"text-gray-400")},c(e.is_read?"âœ“âœ“":"âœ“"),3)):o("",!0)],2)],2)],2)}),128))]),_:1})),Ee.value?(_(),s("div",ne,[...a[15]||(a[15]=[f('<div class="w-10 h-10 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 flex items-center justify-center" data-v-9d9c7b84><span class="text-lg" data-v-9d9c7b84>ğŸ‘¤</span></div><div class="bg-gray-200 dark:bg-gray-700 rounded-2xl rounded-bl-md px-4 py-3" data-v-9d9c7b84><div class="flex gap-1" data-v-9d9c7b84><span class="w-2 h-2 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:0ms;" data-v-9d9c7b84></span><span class="w-2 h-2 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:150ms;" data-v-9d9c7b84></span><span class="w-2 h-2 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:300ms;" data-v-9d9c7b84></span></div></div>',2)])])):o("",!0)],544),He.value?(_(),s("button",{key:0,class:"absolute bottom-24 right-8 w-12 h-12 bg-white dark:bg-gray-700 shadow-xl rounded-full flex items-center justify-center text-blue-600 dark:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-600 transition-all hover:scale-110 border border-gray-200 dark:border-gray-600",onClick:ua},[...a[16]||(a[16]=[n("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])])):o("",!0),Se.value?o("",!0):(_(),s("div",oe,[n("div",ie,[a[19]||(a[19]=n("h3",{class:"text-lg font-bold text-yellow-800 dark:text-yellow-200 mb-2"}," ğŸ”’ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ",-1)),a[20]||(a[20]=n("p",{class:"text-sm text-yellow-700 dark:text-yellow-300 mb-4"}," Ğ”Ğ»Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ ",-1)),n("div",ue,[i(t,{to:"/login",class:"px-6 py-2.5 bg-blue-600 text-white rounded-xl font-bold text-sm hover:bg-blue-700 transition shadow-lg shadow-blue-600/30"},{default:u(()=>[...a[17]||(a[17]=[v(" Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ ",-1)])]),_:1}),i(t,{to:"/register",class:"px-6 py-2.5 bg-green-600 text-white rounded-xl font-bold text-sm hover:bg-green-700 transition shadow-lg shadow-green-600/30"},{default:u(()=>[...a[18]||(a[18]=[v(" Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ",-1)])]),_:1})])])])),Se.value?(_(),s("div",de,[Ae.value?(_(),s("div",ce,[a[21]||(a[21]=n("div",{class:"w-3 h-3 bg-red-500 rounded-full animate-pulse"},null,-1)),n("span",ve,"Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ "+c((l=We.value,`${Math.floor(l/60)}:${(l%60).toString().padStart(2,"0")}`)),1),a[22]||(a[22]=n("div",{class:"flex-1"},null,-1)),n("button",{type:"button",onClick:fa,class:"p-2 text-gray-500 hover:text-gray-700"},"âœ•"),n("button",{type:"button",onClick:ma,class:"px-4 py-1.5 bg-red-600 text-white rounded-full text-sm font-medium hover:bg-red-700"},"ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ")])):o("",!0),Fe.value?(_(),s("div",ge,[n("img",{src:Ge.value,class:"h-20 rounded-lg object-cover"},null,8,be),n("button",{type:"button",class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm hover:bg-red-600 transition",onClick:sa}," âœ• "),Ne.value?(_(),s("div",me,[...a[23]||(a[23]=[n("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)])])):o("",!0)])):o("",!0),n("form",{class:"flex gap-3 items-end",onSubmit:y(na,["prevent"])},[n("button",{type:"button",class:"hidden sm:flex w-11 h-11 flex-shrink-0 items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",disabled:Ne.value,onClick:la},[...a[24]||(a[24]=[n("svg",{class:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])],8,fe),n("input",{ref_key:"imageInputRef",ref:Ve,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",class:"hidden",onChange:ra},null,544),n("div",he,[p(n("textarea",{ref_key:"inputRef",ref:De,"onUpdate:modelValue":a[0]||(a[0]=e=>ze.value=e),placeholder:"ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ...",rows:"1",class:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-700 border-0 rounded-2xl text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 resize-none max-h-32 text-sm sm:text-base",style:{"overflow-y":"auto"},onKeydown:w(y(na,["exact","prevent"]),["enter"]),onInput:oa},null,40,ye),[[x,ze.value]])]),n("div",pe,[n("button",{type:"button",class:"w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 transition text-xl",onClick:a[1]||(a[1]=e=>Pe.value=!Pe.value)}," ğŸ˜Š "),Pe.value?(_(),s("div",xe,[n("div",we,[(_(),s(b,null,m(Ye,e=>n("button",{key:e,type:"button",class:"w-8 h-8 flex items-center justify-center text-xl hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition",onClick:a=>function(e){var a;ze.value+=e,Pe.value=!1,null==(a=De.value)||a.focus()}(e)},c(e),9,ke)),64))])])):o("",!0)]),ze.value.trim()||Fe.value||Ae.value?(_(),s("button",{key:1,type:"submit",disabled:!ze.value.trim()&&!Fe.value||Be.value||Ne.value,class:k(["w-11 h-11 rounded-xl flex items-center justify-center transition-all flex-shrink-0",ze.value.trim()||Fe.value?"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 shadow-lg shadow-blue-600/30 hover:scale-105":"bg-gray-200 dark:bg-gray-700 text-gray-400"])},[Be.value?(_(),s("div",Ce)):(_(),s("svg",je,[...a[26]||(a[26]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1)])]))],10,_e)):(_(),s("button",{key:0,type:"button",class:"w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 bg-gray-100 dark:bg-gray-700 text-gray-500 hover:bg-red-100 hover:text-red-500 transition",onClick:ba},[...a[25]||(a[25]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1)])]))],32)])):o("",!0)])]),Oe.value?(_(),s("div",{key:0,class:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a[4]||(a[4]=e=>Oe.value=null)},[n("button",{class:"absolute top-4 right-4 w-10 h-10 bg-white/10 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition",onClick:a[2]||(a[2]=e=>Oe.value=null)}," âœ• "),n("img",{src:va(Oe.value),class:"max-w-full max-h-full object-contain",onClick:a[3]||(a[3]=y(()=>{},["stop"]))},null,8,Ie)])):o("",!0)]);var l}}},[["__scopeId","data-v-9d9c7b84"]]);export{Me as default};
