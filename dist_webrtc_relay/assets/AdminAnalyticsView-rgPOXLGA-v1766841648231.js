import{r as e,c as t,o as s,h as a,l,I as n,L as i,t as o,n as d,F as r,i as u,m as c,k as v,q as x}from"./vendor-mW7CftnD-v1766841648231.js";const g={class:"min-h-screen bg-gray-100"},y={class:"bg-white shadow-lg"},p={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},h={class:"flex justify-between h-16"},m={class:"flex items-center space-x-4"},b={class:"flex items-center space-x-4"},f={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},w={key:0,class:"flex justify-center py-12"},D={key:1,class:"space-y-8"},k={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},B={class:"bg-white rounded-xl shadow p-6"},q={class:"text-3xl font-black text-blue-600"},U={class:"bg-white rounded-xl shadow p-6"},j={class:"text-3xl font-black text-green-600"},R={class:"text-xs mt-1 text-gray-400"},C={class:"bg-white rounded-xl shadow p-6"},M={class:"text-3xl font-black text-purple-600"},_={class:"text-xs mt-1 text-gray-400"},A={class:"bg-white rounded-xl shadow p-6"},H={class:"text-3xl font-black text-orange-600"},$={class:"bg-white rounded-xl shadow p-6"},F={class:"relative h-64"},I={class:"absolute inset-0 flex items-end justify-between gap-1"},V={class:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap"},z={class:"flex justify-between mt-2 text-xs text-gray-700"},L={class:"grid md:grid-cols-2 gap-6"},S={class:"bg-white rounded-xl shadow p-6"},T={class:"space-y-3"},E={class:"w-24 text-sm text-gray-800 font-medium"},G={class:"flex-1 bg-gray-200 rounded-full h-4 overflow-hidden"},J={class:"w-12 text-right text-sm font-bold"},K={class:"bg-white rounded-xl shadow p-6"},N={class:"space-y-3"},O={class:"flex-1 truncate text-sm"},P={class:"text-sm font-bold text-green-600"},Q={key:0,class:"text-gray-400 text-center py-4"},W={class:"bg-white rounded-xl shadow p-6"},X={class:"relative h-48"},Y={class:"absolute inset-0 flex items-end justify-between gap-1"},Z={class:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap"},ee={class:"flex justify-between mt-2 text-xs text-gray-700"},te={__name:"AdminAnalyticsView",setup(te){const se=e(!0),ae=e(30),le=e({totalUsers:0,totalRequests:0,completedRequests:0,activeUsers:0,newUsersChange:0,avgResponseMinutes:0,requestsByDay:[],registrationsByDay:[],statusDistribution:[],topHelpers:[]}),ne=t(()=>{var e;return(null==(e=le.value.requestsByDay)?void 0:e.length)?Math.max(...le.value.requestsByDay.map(e=>e.count),1):1}),ie=t(()=>{var e;return(null==(e=le.value.registrationsByDay)?void 0:e.length)?Math.max(...le.value.registrationsByDay.map(e=>e.count),1):1}),oe=(e,t)=>t&&e?Math.max(e/t*100,5):5,de=e=>({pending:"ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚",in_progress:"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",completed:"Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½",cancelled:"ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½"}[e]||e),re=e=>({pending:"bg-yellow-500",in_progress:"bg-blue-500",completed:"bg-green-500",cancelled:"bg-red-500"}[e]||"bg-gray-500"),ue=async()=>{se.value=!0;try{const e=localStorage.getItem("adminToken");if(!e)return;const t=await fetch(`/api/v1/admin/analytics?days=${ae.value}`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();e.success&&(le.value=e.analytics)}}catch(e){console.error("Failed to fetch analytics:",e)}finally{se.value=!1}};return s(()=>{ue()}),(e,t)=>{var s,te,ce,ve,xe,ge,ye,pe,he,me,be;return v(),a("div",g,[l("nav",y,[l("div",p,[l("div",h,[l("div",m,[l("button",{class:"text-blue-600 hover:text-blue-800 font-medium",onClick:t[0]||(t[0]=t=>e.$router.push("/admin/dashboard"))}," â† ÐÐ°Ð·Ð°Ð´ "),t[2]||(t[2]=l("h1",{class:"text-xl font-bold text-gray-900"}," ðŸ“Š ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° ",-1))]),l("div",b,[n(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>ae.value=e),class:"border rounded px-3 py-1",onChange:ue},[...t[3]||(t[3]=[l("option",{value:"7"}," 7 Ð´Ð½ÐµÐ¹ ",-1),l("option",{value:"30"}," 30 Ð´Ð½ÐµÐ¹ ",-1),l("option",{value:"90"}," 90 Ð´Ð½ÐµÐ¹ ",-1)])],544),[[i,ae.value]])])])])]),l("div",f,[se.value?(v(),a("div",w,[...t[4]||(t[4]=[l("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1)])])):(v(),a("div",D,[l("div",k,[l("div",B,[l("div",q,o(le.value.totalUsers||0),1),t[5]||(t[5]=l("div",{class:"text-sm text-gray-700 font-medium"}," Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ ",-1)),l("div",{class:d(["text-xs mt-1",le.value.newUsersChange>=0?"text-green-500":"text-red-500"])},o(le.value.newUsersChange>=0?"+":"")+o(le.value.newUsersChange||0)+" Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ ",3)]),l("div",U,[l("div",j,o(le.value.totalRequests||0),1),t[6]||(t[6]=l("div",{class:"text-sm text-gray-700 font-medium"}," Ð’ÑÐµÐ³Ð¾ Ð·Ð°ÑÐ²Ð¾Ðº ",-1)),l("div",R,o(le.value.completedRequests||0)+" Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ ",1)]),l("div",C,[l("div",M,o(le.value.activeUsers||0),1),t[7]||(t[7]=l("div",{class:"text-sm text-gray-700 font-medium"}," ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ ",-1)),l("div",_,o(Math.round(le.value.activeUsers/le.value.totalUsers*100)||0)+"% Ð¾Ñ‚ Ð²ÑÐµÑ… ",1)]),l("div",A,[l("div",H,o(le.value.avgResponseMinutes||0),1),t[8]||(t[8]=l("div",{class:"text-sm text-gray-700 font-medium"}," Ð¡Ñ€. Ð²Ñ€ÐµÐ¼Ñ Ð¾Ñ‚ÐºÐ»Ð¸ÐºÐ° (Ð¼Ð¸Ð½) ",-1))])]),l("div",$,[t[9]||(t[9]=l("h3",{class:"font-bold text-lg mb-4"}," ðŸ“ˆ Ð—Ð°ÑÐ²ÐºÐ¸ Ð¿Ð¾ Ð´Ð½ÑÐ¼ ",-1)),l("div",F,[l("div",I,[(v(!0),a(r,null,u(le.value.requestsByDay,(e,t)=>(v(),a("div",{key:t,class:"flex-1 bg-blue-500 rounded-t hover:bg-blue-600 transition relative group",style:x({height:oe(e.count,ne.value)+"%"})},[l("div",V,o(e.date)+": "+o(e.count),1)],4))),128))])]),l("div",z,[l("span",null,o(null==(te=null==(s=le.value.requestsByDay)?void 0:s[0])?void 0:te.date),1),l("span",null,o(null==(xe=null==(ve=le.value.requestsByDay)?void 0:ve[(null==(ce=le.value.requestsByDay)?void 0:ce.length)-1])?void 0:xe.date),1)])]),l("div",L,[l("div",S,[t[10]||(t[10]=l("h3",{class:"font-bold text-lg mb-4"}," ðŸ“Š Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹ Ð·Ð°ÑÐ²Ð¾Ðº ",-1)),l("div",T,[(v(!0),a(r,null,u(le.value.statusDistribution,e=>(v(),a("div",{key:e.status,class:"flex items-center gap-3"},[l("div",E,o(de(e.status)),1),l("div",G,[l("div",{class:d([re(e.status),"h-full rounded-full transition-all duration-500"]),style:x({width:e.count/le.value.totalRequests*100+"%"})},null,6)]),l("div",J,o(e.count),1)]))),128))])]),l("div",K,[t[11]||(t[11]=l("h3",{class:"font-bold text-lg mb-4"}," ðŸ† Ð¢Ð¾Ð¿ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸ÐºÐ¾Ð² ",-1)),l("div",N,[(v(!0),a(r,null,u(le.value.topHelpers,(e,t)=>(v(),a("div",{key:e.id,class:"flex items-center gap-3"},[l("div",{class:d(["w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold",0===t?"bg-yellow-400 text-yellow-900":1===t?"bg-gray-300 text-gray-700":2===t?"bg-orange-300 text-orange-900":"bg-gray-100 text-gray-700"])},o(t+1),3),l("div",O,o(e.full_name),1),l("div",P,o(e.helps_count)+" Ð¿Ð¾Ð¼Ð¾Ñ‰ÐµÐ¹ ",1)]))),128)),(null==(ge=le.value.topHelpers)?void 0:ge.length)?c("",!0):(v(),a("div",Q," ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… "))])])]),l("div",W,[t[12]||(t[12]=l("h3",{class:"font-bold text-lg mb-4"}," ðŸ‘¥ Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð´Ð½ÑÐ¼ ",-1)),l("div",X,[l("div",Y,[(v(!0),a(r,null,u(le.value.registrationsByDay,(e,t)=>(v(),a("div",{key:t,class:"flex-1 bg-green-500 rounded-t hover:bg-green-600 transition relative group",style:x({height:oe(e.count,ie.value)+"%"})},[l("div",Z,o(e.date)+": "+o(e.count),1)],4))),128))])]),l("div",ee,[l("span",null,o(null==(pe=null==(ye=le.value.registrationsByDay)?void 0:ye[0])?void 0:pe.date),1),l("span",null,o(null==(be=null==(me=le.value.registrationsByDay)?void 0:me[(null==(he=le.value.registrationsByDay)?void 0:he.length)-1])?void 0:be.date),1)])])]))])])}}};export{te as default};
