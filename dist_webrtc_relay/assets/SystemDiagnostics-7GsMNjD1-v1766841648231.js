import{r as e,c as s,o as a,h as t,l,m as i,n as r,t as c,F as d,i as n,I as o,L as u,G as v,k as p}from"./vendor-mW7CftnD-v1766841648231.js";import{l as g}from"./index-C1_WBuRU-v1766841648231.js";const y={class:"min-h-screen bg-gray-100 py-8 px-4"},m={class:"max-w-7xl mx-auto"},x={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},b={class:"bg-white rounded-lg shadow p-6"},h={key:0,class:"space-y-3"},f={class:"flex items-center"},w={class:"text-sm text-gray-600"},k={key:0,class:"text-sm"},j={class:"list-disc list-inside text-red-600"},S={key:1,class:"text-gray-500"},I={class:"bg-white rounded-lg shadow p-6"},N={class:"space-y-2"},O=["disabled"],P=["disabled"],C=["disabled"],A={class:"bg-white rounded-lg shadow p-6"},D={class:"space-y-2 text-sm"},J={class:"flex justify-between"},T={class:"font-medium"},U={class:"flex justify-between"},F={class:"font-medium"},K={key:0,class:"bg-white rounded-lg shadow mb-8"},L={class:"p-6 border-b"},W={class:"text-sm text-gray-600 mt-1"},$={class:"p-6"},_={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},q={class:"flex items-center justify-between mb-2"},G={class:"font-medium text-gray-900"},M={class:"text-sm text-gray-600"},R={class:"whitespace-pre-wrap"},V={class:"bg-white rounded-lg shadow"},z={class:"p-6 border-b"},B={class:"flex items-center justify-between"},E={class:"flex items-center space-x-4"},H=["disabled"],Q={class:"p-6"},X={key:0,class:"space-y-2 max-h-96 overflow-y-auto"},Y={class:"flex items-start justify-between"},Z={class:"flex-1"},ee={class:"text-gray-600 text-xs mb-1"},se={class:"text-gray-900"},ae={key:0,class:"text-gray-500 mt-1"},te={class:"whitespace-pre-wrap"},le={key:1,class:"text-gray-500 text-center py-8"},ie={__name:"SystemDiagnostics",setup(ie){const re=e(!1),ce=e(null),de=e(null),ne=e([]),oe=e("system"),ue=s(()=>{if(!de.value)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const e=new Date(de.value.timestamp),s=new Date-e;return`${Math.floor(s/6e4)} –º–∏–Ω –Ω–∞–∑–∞–¥`}),ve=s(()=>de.value?ye(de.value.timestamp):"–ù–∏–∫–æ–≥–¥–∞"),pe=e=>{switch(e){case"healthy":case"passed":return"bg-green-100 text-green-800";case"warning":return"bg-yellow-100 text-yellow-800";case"unhealthy":case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ge=e=>{switch(e){case"healthy":case"passed":return"‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç";case"warning":return"‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ";case"unhealthy":case"failed":return"‚ùå –û—à–∏–±–∫–∞";default:return"‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}},ye=e=>new Date(e).toLocaleString("ru-RU"),me=async()=>{re.value=!0;try{const e=await fetch("/api/v1/diagnostics/status"),s=await e.json();s.success?(ce.value=s.data,g.success("–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω")):g.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞")}catch(e){g.error("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API")}finally{re.value=!1}},xe=async()=>{re.value=!0;try{const e=await fetch("/api/v1/diagnostics/full"),s=await e.json();s.success?(de.value=s.data,ce.value={status:s.data.overall,message:"healthy"===s.data.overall?"–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç":"–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã",issues:s.data.checks.filter(e=>"failed"===e.status).map(e=>e.name)},g.success("–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")):g.error("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏")}catch(e){g.error("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API")}finally{re.value=!1}},be=async()=>{re.value=!0;try{const e=await fetch(`/api/v1/diagnostics/logs/${oe.value}?lines=100`),s=await e.json();s.success?ne.value=s.data.logs.map(e=>{try{return JSON.parse(e)}catch{return{message:e,timestamp:(new Date).toISOString(),level:"INFO",category:"UNKNOWN"}}}):g.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤")}catch(e){g.error("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API")}finally{re.value=!1}},he=async()=>{if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏?")){re.value=!0;try{const e=await fetch("/api/v1/diagnostics/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({daysToKeep:0})});(await e.json()).success?(g.success("–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã"),be()):g.error("–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤")}catch(e){g.error("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API")}finally{re.value=!1}}};return a(()=>{me(),xe(),be()}),(e,s)=>(p(),t("div",y,[l("div",m,[s[12]||(s[12]=l("div",{class:"mb-8"},[l("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," üîß –°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ "),l("p",{class:"text-gray-600"}," –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ ")],-1)),l("div",x,[l("div",b,[s[3]||(s[3]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã ",-1)),ce.value?(p(),t("div",h,[l("div",f,[s[1]||(s[1]=l("span",{class:"text-sm text-gray-600"},"–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),l("span",{class:r([pe(ce.value.status),"ml-2 px-2 py-1 rounded text-sm font-medium"])},c(ge(ce.value.status)),3)]),l("p",w,c(ce.value.message),1),ce.value.issues?(p(),t("div",k,[s[2]||(s[2]=l("p",{class:"text-red-600 font-medium"}," –ü—Ä–æ–±–ª–µ–º—ã: ",-1)),l("ul",j,[(p(!0),t(d,null,n(ce.value.issues,e=>(p(),t("li",{key:e},c(e),1))),128))])])):i("",!0)])):(p(),t("div",S," –ó–∞–≥—Ä—É–∑–∫–∞... "))]),l("div",I,[s[4]||(s[4]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è ",-1)),l("div",N,[l("button",{disabled:re.value,class:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",onClick:me}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å ",8,O),l("button",{disabled:re.value,class:"w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50",onClick:xe}," üîç –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ",8,P),l("button",{disabled:re.value,class:"w-full bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 disabled:opacity-50",onClick:he}," üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ ",8,C)])]),l("div",A,[s[8]||(s[8]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," ‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ",-1)),l("div",D,[l("div",J,[s[5]||(s[5]=l("span",{class:"text-gray-600"},"–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:",-1)),l("span",T,c(ue.value),1)]),s[7]||(s[7]=l("div",{class:"flex justify-between"},[l("span",{class:"text-gray-600"},"–í–µ—Ä—Å–∏—è API:"),l("span",{class:"font-medium"},"v1")],-1)),l("div",U,[s[6]||(s[6]=l("span",{class:"text-gray-600"},"–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:",-1)),l("span",F,c(ve.value),1)])])])]),de.value?(p(),t("div",K,[l("div",L,[s[9]||(s[9]=l("h3",{class:"text-lg font-semibold text-gray-900"}," üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ",-1)),l("p",W," –ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: "+c(ye(de.value.timestamp)),1)]),l("div",$,[l("div",_,[(p(!0),t(d,null,n(de.value.checks,e=>(p(),t("div",{key:e.name,class:"border rounded-lg p-4"},[l("div",q,[l("h4",G,c(e.name),1),l("span",{class:r([pe(e.status),"px-2 py-1 rounded text-xs font-medium"])},c(ge(e.status)),3)]),l("div",M,[l("pre",R,c(JSON.stringify(e.details,null,2)),1)])]))),128))])])])):i("",!0),l("div",V,[l("div",z,[l("div",B,[s[11]||(s[11]=l("h3",{class:"text-lg font-semibold text-gray-900"}," üìã –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã ",-1)),l("div",E,[o(l("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>oe.value=e),class:"border rounded px-3 py-1",onChange:be},[...s[10]||(s[10]=[v('<option value="system"> –°–∏—Å—Ç–µ–º–∞ </option><option value="errors"> –û—à–∏–±–∫–∏ </option><option value="requests"> –ó–∞–ø—Ä–æ—Å—ã </option><option value="auth"> –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è </option><option value="database"> –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö </option><option value="websocket"> WebSocket </option>',6)])],544),[[u,oe.value]]),l("button",{disabled:re.value,class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 disabled:opacity-50",onClick:be}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å ",8,H)])])]),l("div",Q,[ne.value.length>0?(p(),t("div",X,[(p(!0),t(d,null,n(ne.value,(e,s)=>(p(),t("div",{key:s,class:"bg-gray-50 rounded p-3 text-sm font-mono"},[l("div",Y,[l("div",Z,[l("div",ee,c(ye(e.timestamp))+" ["+c(e.level)+"] "+c(e.category),1),l("div",se,c(e.message),1),e.data?(p(),t("div",ae,[l("pre",te,c(JSON.stringify(e.data,null,2)),1)])):i("",!0)])])]))),128))])):(p(),t("div",le," –ù–µ—Ç –ª–æ–≥–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è "))])])])]))}};export{ie as default};
