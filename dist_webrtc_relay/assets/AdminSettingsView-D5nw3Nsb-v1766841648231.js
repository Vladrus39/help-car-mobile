import{r as e,o as l,h as a,l as s,t,I as n,J as o,F as i,i as u,W as d,m,y as r,k as c}from"./vendor-mW7CftnD-v1766841648231.js";const p={class:"min-h-screen bg-gray-100"},b={class:"bg-white shadow-lg"},v={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},x={class:"flex justify-between h-16"},f={class:"flex items-center space-x-4"},y={class:"flex items-center space-x-4"},g=["disabled"],h={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},w={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},k={class:"bg-white rounded-lg shadow p-6"},V={class:"space-y-4"},U={class:"text-xs text-gray-700 mt-1"},A={class:"bg-white rounded-lg shadow p-6"},S={class:"space-y-4"},T={class:"bg-white rounded-lg shadow p-6"},j={class:"space-y-3"},N=["onUpdate:modelValue"],C=["onUpdate:modelValue","disabled"],P=["onClick"],B={class:"bg-white rounded-lg shadow p-6"},R={class:"space-y-3"},q={class:"flex items-center justify-between"},D={class:"flex items-center justify-between"},H={class:"flex items-center justify-between"},I={class:"bg-white rounded-lg shadow p-6"},O={class:"space-y-3"},$={class:"flex items-center justify-between"},M={class:"flex items-center justify-between"},E={class:"bg-white rounded-lg shadow p-6"},J={class:"space-y-3"},_={class:"flex items-center justify-between"},z={class:"flex items-center justify-between"},L={class:"mt-6 bg-white rounded-lg shadow p-6"},F={class:"space-y-2 max-h-64 overflow-y-auto"},W={class:"text-gray-700"},G={class:"flex-1"},K={key:0,class:"text-gray-400 text-center py-4"},Q={__name:"AdminSettingsView",setup(Q){const X=r(),Y=e(!1),Z=e({commission:10,minAmount:100,maxAmount:5e4,maxRequestsPerDay:10,maxActiveRequests:3,autoCancelHours:24,emailNotifications:!0,pushNotifications:!0,smsNotifications:!1,premoderation:!1,autoBanSpam:!0,reportsToBlock:5,maintenanceMode:!1,registrationOpen:!0,apiVersion:"v1.0.0",problemTypes:[{enabled:!0,name:"üîã –†–∞–∑—Ä—è–¥–∏–ª—Å—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä",value:"battery"},{enabled:!0,name:"‚õΩ –ó–∞–∫–æ–Ω—á–∏–ª—Å—è –±–µ–Ω–∑–∏–Ω",value:"fuel"},{enabled:!0,name:"üîß –ü—Ä–æ–∫–æ–ª –∫–æ–ª–µ—Å–∞",value:"tire"},{enabled:!0,name:"üöõ –≠–≤–∞–∫—É–∞—Ü–∏—è",value:"towing"},{enabled:!0,name:"‚ùì –î—Ä—É–≥–æ–µ",value:"other"}]}),ee=e([]),le=()=>localStorage.getItem("adminToken"),ae=async()=>{try{const e=le();if(!e)return void X.push("/admin/login");const l=await fetch("/api/v1/admin/settings",{headers:{Authorization:`Bearer ${e}`}});if(!l.ok){if(401===l.status)return void X.push("/admin/login");if(404===l.status)return void console.log("Settings endpoint not found, using defaults");throw new Error(`HTTP ${l.status}`)}const a=await l.json();a.success&&a.settings&&(Z.value={...Z.value,...a.settings}),a.history&&(ee.value=a.history)}catch(e){console.error("Load settings error:",e)}},se=async()=>{Y.value=!0;try{const e=le();if(!e)return void X.push("/admin/login");const l=await fetch("/api/v1/admin/settings",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(Z.value)});if(!l.ok){if(404===l.status)return alert("‚ö†Ô∏è API –Ω–∞—Å—Ç—Ä–æ–µ–∫ –µ—â—ë –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ backend. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ."),void localStorage.setItem("adminSettings",JSON.stringify(Z.value));throw new Error(`HTTP ${l.status}`)}(await l.json()).success&&(alert("‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!"),await ae())}catch(e){console.error("Save settings error:",e),alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: "+e.message)}finally{Y.value=!1}},te=()=>{Z.value.problemTypes.push({enabled:!0,name:"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è",value:"new_"+Date.now()})};return l(()=>{ae()}),(e,l)=>(c(),a("div",p,[s("nav",b,[s("div",v,[s("div",x,[s("div",f,[s("button",{class:"text-blue-600 hover:text-blue-800 font-medium",onClick:l[0]||(l[0]=l=>e.$router.push("/admin/dashboard"))}," ‚Üê –î–∞—à–±–æ—Ä–¥ "),l[16]||(l[16]=s("h1",{class:"text-xl font-bold text-gray-900"}," ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –°–∏—Å—Ç–µ–º—ã ",-1))]),s("div",y,[s("button",{disabled:Y.value,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50",onClick:se},t(Y.value?"üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë"),9,g)])])])]),s("div",h,[s("div",w,[s("div",k,[l[20]||(l[20]=s("h3",{class:"text-lg font-bold mb-4"}," üí∞ –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ",-1)),s("div",V,[s("div",null,[l[17]||(l[17]=s("label",{class:"block text-sm font-medium mb-2"},"–ö–æ–º–∏—Å—Å–∏—è (%)",-1)),n(s("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>Z.value.commission=e),type:"number",min:"0",max:"100",step:"0.1",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.commission,void 0,{number:!0}]]),s("p",U," –¢–µ–∫—É—â–∞—è: "+t(Z.value.commission)+"% ",1)]),s("div",null,[l[18]||(l[18]=s("label",{class:"block text-sm font-medium mb-2"},"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞—è–≤–∫–∏ (‚ÇΩ)",-1)),n(s("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>Z.value.minAmount=e),type:"number",min:"0",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.minAmount,void 0,{number:!0}]])]),s("div",null,[l[19]||(l[19]=s("label",{class:"block text-sm font-medium mb-2"},"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞—è–≤–∫–∏ (‚ÇΩ)",-1)),n(s("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>Z.value.maxAmount=e),type:"number",min:"0",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.maxAmount,void 0,{number:!0}]])])])]),s("div",A,[l[24]||(l[24]=s("h3",{class:"text-lg font-bold mb-4"}," üî¢ –õ–∏–º–∏—Ç—ã ",-1)),s("div",S,[s("div",null,[l[21]||(l[21]=s("label",{class:"block text-sm font-medium mb-2"},"–ú–∞–∫—Å. –∑–∞—è–≤–æ–∫ –≤ –¥–µ–Ω—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",-1)),n(s("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>Z.value.maxRequestsPerDay=e),type:"number",min:"1",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.maxRequestsPerDay,void 0,{number:!0}]])]),s("div",null,[l[22]||(l[22]=s("label",{class:"block text-sm font-medium mb-2"},"–ú–∞–∫—Å. –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ",-1)),n(s("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>Z.value.maxActiveRequests=e),type:"number",min:"1",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.maxActiveRequests,void 0,{number:!0}]])]),s("div",null,[l[23]||(l[23]=s("label",{class:"block text-sm font-medium mb-2"},"–í—Ä–µ–º—è –∞–≤—Ç–æ–æ—Ç–º–µ–Ω—ã –∑–∞—è–≤–∫–∏ (—á–∞—Å—ã)",-1)),n(s("input",{"onUpdate:modelValue":l[6]||(l[6]=e=>Z.value.autoCancelHours=e),type:"number",min:"1",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.autoCancelHours,void 0,{number:!0}]])])])]),s("div",T,[l[25]||(l[25]=s("h3",{class:"text-lg font-bold mb-4"}," üöó –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–±–ª–µ–º ",-1)),s("div",j,[(c(!0),a(i,null,u(Z.value.problemTypes,(e,l)=>(c(),a("div",{key:l,class:"flex items-center gap-2"},[n(s("input",{"onUpdate:modelValue":l=>e.enabled=l,type:"checkbox",class:"rounded"},null,8,N),[[d,e.enabled]]),n(s("input",{"onUpdate:modelValue":l=>e.name=l,type:"text",class:"flex-1 px-3 py-2 border rounded-md",disabled:!e.enabled},null,8,C),[[o,e.name]]),s("button",{class:"text-red-600 hover:text-red-800",onClick:e=>(e=>{confirm("–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?")&&Z.value.problemTypes.splice(e,1)})(l)}," üóëÔ∏è ",8,P)]))),128)),s("button",{class:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:te}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é ")])]),s("div",B,[l[29]||(l[29]=s("h3",{class:"text-lg font-bold mb-4"}," üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ",-1)),s("div",R,[s("div",q,[l[26]||(l[26]=s("span",{class:"text-sm"},"Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",-1)),n(s("input",{"onUpdate:modelValue":l[7]||(l[7]=e=>Z.value.emailNotifications=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.emailNotifications]])]),s("div",D,[l[27]||(l[27]=s("span",{class:"text-sm"},"Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",-1)),n(s("input",{"onUpdate:modelValue":l[8]||(l[8]=e=>Z.value.pushNotifications=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.pushNotifications]])]),s("div",H,[l[28]||(l[28]=s("span",{class:"text-sm"},"SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",-1)),n(s("input",{"onUpdate:modelValue":l[9]||(l[9]=e=>Z.value.smsNotifications=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.smsNotifications]])])])]),s("div",I,[l[33]||(l[33]=s("h3",{class:"text-lg font-bold mb-4"}," üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ü–∏—è ",-1)),s("div",O,[s("div",$,[l[30]||(l[30]=s("span",{class:"text-sm"},"–ü—Ä–µ–º–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞—è–≤–æ–∫",-1)),n(s("input",{"onUpdate:modelValue":l[10]||(l[10]=e=>Z.value.premoderation=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.premoderation]])]),s("div",M,[l[31]||(l[31]=s("span",{class:"text-sm"},"–ê–≤—Ç–æ–±–∞–Ω –∑–∞ —Å–ø–∞–º",-1)),n(s("input",{"onUpdate:modelValue":l[11]||(l[11]=e=>Z.value.autoBanSpam=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.autoBanSpam]])]),s("div",null,[l[32]||(l[32]=s("label",{class:"block text-sm font-medium mb-2"},"–ñ–∞–ª–æ–± –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏",-1)),n(s("input",{"onUpdate:modelValue":l[12]||(l[12]=e=>Z.value.reportsToBlock=e),type:"number",min:"1",class:"w-full px-3 py-2 border rounded-md"},null,512),[[o,Z.value.reportsToBlock,void 0,{number:!0}]])])])]),s("div",E,[l[37]||(l[37]=s("h3",{class:"text-lg font-bold mb-4"}," ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ ",-1)),s("div",J,[s("div",_,[l[34]||(l[34]=s("span",{class:"text-sm"},"–†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è",-1)),n(s("input",{"onUpdate:modelValue":l[13]||(l[13]=e=>Z.value.maintenanceMode=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.maintenanceMode]])]),s("div",z,[l[35]||(l[35]=s("span",{class:"text-sm"},"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞",-1)),n(s("input",{"onUpdate:modelValue":l[14]||(l[14]=e=>Z.value.registrationOpen=e),type:"checkbox",class:"rounded"},null,512),[[d,Z.value.registrationOpen]])]),s("div",null,[l[36]||(l[36]=s("label",{class:"block text-sm font-medium mb-2"},"–í–µ—Ä—Å–∏—è API",-1)),n(s("input",{"onUpdate:modelValue":l[15]||(l[15]=e=>Z.value.apiVersion=e),type:"text",class:"w-full px-3 py-2 border rounded-md",readonly:""},null,512),[[o,Z.value.apiVersion]])])])])]),s("div",L,[l[38]||(l[38]=s("h3",{class:"text-lg font-bold mb-4"}," üìú –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–∫ ",-1)),s("div",F,[(c(!0),a(i,null,u(ee.value,(e,l)=>(c(),a("div",{key:l,class:"flex items-start gap-3 text-sm border-b pb-2"},[s("span",W,t(new Date(e.timestamp).toLocaleString("ru-RU")),1),s("span",G,t(e.admin)+" –∏–∑–º–µ–Ω–∏–ª "+t(e.setting)+": "+t(e.oldValue)+" ‚Üí "+t(e.newValue),1)]))),128)),ee.value.length?m("",!0):(c(),a("div",K," –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞ "))])])])]))}};export{Q as default};
